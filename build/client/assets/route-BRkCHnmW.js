import{r as Ki,j as ie}from"./jsx-runtime-kF-aRxYe.js";import{C as Gi}from"./contact-section-B-y5Wsm-.js";import{t as Yi}from"./utils-tQ8evKDJ.js";import{C as au}from"./container-2TlAo-hG.js";import{a as Xi,u as Qi}from"./i18n-DH-wL5Eu.js";import"./contact-cta-section-BBuv_ViC.js";import"./resolve-elements-WL2ErOKm.js";function $(n){this.content=n}$.prototype={constructor:$,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var u=t&&t!=n?this.remove(t):this,r=u.find(n),i=u.content.slice();return r==-1?i.push(t||n,e):(i[r+1]=e,t&&(i[r]=t)),new $(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new $(t)},addToStart:function(n,e){return new $([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new $(t)},addBefore:function(n,e,t){var u=this.remove(e),r=u.content.slice(),i=u.find(n);return r.splice(i==-1?r.length:i,0,e,t),new $(r)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=$.from(n),n.size?new $(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=$.from(n),n.size?new $(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=$.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};$.from=function(n){if(n instanceof $)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new $(e)};function lr(n,e,t){for(let u=0;;u++){if(u==n.childCount||u==e.childCount)return n.childCount==e.childCount?null:t;let r=n.child(u),i=e.child(u);if(r==i){t+=r.nodeSize;continue}if(!r.sameMarkup(i))return t;if(r.isText&&r.text!=i.text){for(let s=0;r.text[s]==i.text[s];s++)t++;return t}if(r.content.size||i.content.size){let s=lr(r.content,i.content,t+1);if(s!=null)return s}t+=r.nodeSize}}function cr(n,e,t,u){for(let r=n.childCount,i=e.childCount;;){if(r==0||i==0)return r==i?null:{a:t,b:u};let s=n.child(--r),o=e.child(--i),a=s.nodeSize;if(s==o){t-=a,u-=a;continue}if(!s.sameMarkup(o))return{a:t,b:u};if(s.isText&&s.text!=o.text){let l=0,c=Math.min(s.text.length,o.text.length);for(;l<c&&s.text[s.text.length-l-1]==o.text[o.text.length-l-1];)l++,t--,u--;return{a:t,b:u}}if(s.content.size||o.content.size){let l=cr(s.content,o.content,t-1,u-1);if(l)return l}t-=a,u-=a}}class y{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let u=0;u<e.length;u++)this.size+=e[u].nodeSize}nodesBetween(e,t,u,r=0,i){for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;if(l>e&&u(a,r+o,i||null,s)!==!1&&a.content.size){let c=o+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,t-c),u,r+c)}o=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,u,r){let i="",s=!0;return this.nodesBetween(e,t,(o,a)=>{let l=o.isText?o.text.slice(Math.max(e,a)-a,t-a):o.isLeaf?r?typeof r=="function"?r(o):r:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&l||o.isTextblock)&&u&&(s?s=!1:i+=u),i+=l},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,u=e.firstChild,r=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(u)&&(r[r.length-1]=t.withText(t.text+u.text),i=1);i<e.content.length;i++)r.push(e.content[i]);return new y(r,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let u=[],r=0;if(t>e)for(let i=0,s=0;s<t;i++){let o=this.content[i],a=s+o.nodeSize;a>e&&((s<e||a>t)&&(o.isText?o=o.cut(Math.max(0,e-s),Math.min(o.text.length,t-s)):o=o.cut(Math.max(0,e-s-1),Math.min(o.content.size,t-s-1))),u.push(o),r+=o.nodeSize),s=a}return new y(u,r)}cutByIndex(e,t){return e==t?y.empty:e==0&&t==this.content.length?this:new y(this.content.slice(e,t))}replaceChild(e,t){let u=this.content[e];if(u==t)return this;let r=this.content.slice(),i=this.size+t.nodeSize-u.nodeSize;return r[e]=t,new y(r,i)}addToStart(e){return new y([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new y(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,u=0;t<this.content.length;t++){let r=this.content[t];e(r,u,t),u+=r.nodeSize}}findDiffStart(e,t=0){return lr(this,e,t)}findDiffEnd(e,t=this.size,u=e.size){return cr(this,e,t,u)}findIndex(e,t=-1){if(e==0)return ft(0,e);if(e==this.size)return ft(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let u=0,r=0;;u++){let i=this.child(u),s=r+i.nodeSize;if(s>=e)return s==e||t>0?ft(u+1,s):ft(u,r);r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return y.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new y(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return y.empty;let t,u=0;for(let r=0;r<e.length;r++){let i=e[r];u+=i.nodeSize,r&&i.isText&&e[r-1].sameMarkup(i)?(t||(t=e.slice(0,r)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new y(t||e,u)}static from(e){if(!e)return y.empty;if(e instanceof y)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new y([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}y.empty=new y([],0);const Qt={index:0,offset:0};function ft(n,e){return Qt.index=n,Qt.offset=e,Qt}function At(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let u=0;u<n.length;u++)if(!At(n[u],e[u]))return!1}else{for(let u in n)if(!(u in e)||!At(n[u],e[u]))return!1;for(let u in e)if(!(u in n))return!1}return!0}let v=class yn{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,u=!1;for(let r=0;r<e.length;r++){let i=e[r];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,r));else{if(i.type.excludes(this.type))return e;!u&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),u=!0),t&&t.push(i)}}return t||(t=e.slice()),u||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&At(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let u=e.marks[t.type];if(!u)throw new RangeError(`There is no mark type ${t.type} in this schema`);let r=u.create(t.attrs);return u.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let u=0;u<e.length;u++)if(!e[u].eq(t[u]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return yn.none;if(e instanceof yn)return[e];let t=e.slice();return t.sort((u,r)=>u.type.rank-r.type.rank),t}};v.none=[];class Mt extends Error{}class w{constructor(e,t,u){this.content=e,this.openStart=t,this.openEnd=u}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let u=fr(this.content,e+this.openStart,t);return u&&new w(u,this.openStart,this.openEnd)}removeBetween(e,t){return new w(dr(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return w.empty;let u=t.openStart||0,r=t.openEnd||0;if(typeof u!="number"||typeof r!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new w(y.fromJSON(e,t.content),u,r)}static maxOpen(e,t=!0){let u=0,r=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)u++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new w(e,u,r)}}w.empty=new w(y.empty,0,0);function dr(n,e,t){let{index:u,offset:r}=n.findIndex(e),i=n.maybeChild(u),{index:s,offset:o}=n.findIndex(t);if(r==e||i.isText){if(o!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(u!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(u,i.copy(dr(i.content,e-r-1,t-r-1)))}function fr(n,e,t,u){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r);if(i==e||s.isText)return n.cut(0,e).append(t).append(n.cut(e));let o=fr(s.content,e-i-1,t);return o&&n.replaceChild(r,s.copy(o))}function Zi(n,e,t){if(t.openStart>n.depth)throw new Mt("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Mt("Inconsistent open depths");return hr(n,e,t,0)}function hr(n,e,t,u){let r=n.index(u),i=n.node(u);if(r==e.index(u)&&u<n.depth-t.openStart){let s=hr(n,e,t,u+1);return i.copy(i.content.replaceChild(r,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==u&&e.depth==u){let s=n.parent,o=s.content;return Re(s,o.cut(0,n.parentOffset).append(t.content).append(o.cut(e.parentOffset)))}else{let{start:s,end:o}=es(t,n);return Re(i,mr(n,s,o,e,u))}else return Re(i,Nt(n,e,u))}function pr(n,e){if(!e.type.compatibleContent(n.type))throw new Mt("Cannot join "+e.type.name+" onto "+n.type.name)}function xn(n,e,t){let u=n.node(t);return pr(u,e.node(t)),u}function Ie(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function et(n,e,t,u){let r=(e||n).node(t),i=0,s=e?e.index(t):r.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(Ie(n.nodeAfter,u),i++));for(let o=i;o<s;o++)Ie(r.child(o),u);e&&e.depth==t&&e.textOffset&&Ie(e.nodeBefore,u)}function Re(n,e){return n.type.checkContent(e),n.copy(e)}function mr(n,e,t,u,r){let i=n.depth>r&&xn(n,e,r+1),s=u.depth>r&&xn(t,u,r+1),o=[];return et(null,n,r,o),i&&s&&e.index(r)==t.index(r)?(pr(i,s),Ie(Re(i,mr(n,e,t,u,r+1)),o)):(i&&Ie(Re(i,Nt(n,e,r+1)),o),et(e,t,r,o),s&&Ie(Re(s,Nt(t,u,r+1)),o)),et(u,null,r,o),new y(o)}function Nt(n,e,t){let u=[];if(et(null,n,t,u),n.depth>t){let r=xn(n,e,t+1);Ie(Re(r,Nt(n,e,t+1)),u)}return et(e,null,t,u),new y(u)}function es(n,e){let t=e.depth-n.openStart,r=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)r=e.node(i).copy(y.from(r));return{start:r.resolveNoCache(n.openStart+t),end:r.resolveNoCache(r.content.size-n.openEnd-t)}}class ut{constructor(e,t,u){this.pos=e,this.path=t,this.parentOffset=u,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let u=this.pos-this.path[this.path.length-1],r=e.child(t);return u?e.child(t).cut(u):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let u=this.path[t*3],r=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)r+=u.child(i).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return v.none;if(this.textOffset)return e.child(t).marks;let u=e.maybeChild(t-1),r=e.maybeChild(t);if(!u){let o=u;u=r,r=o}let i=u.marks;for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!r||!i[s].isInSet(r.marks))&&(i=i[s--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let u=t.marks,r=e.parent.maybeChild(e.index());for(var i=0;i<u.length;i++)u[i].type.spec.inclusive===!1&&(!r||!u[i].isInSet(r.marks))&&(u=u[i--].removeFromSet(u));return u}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let u=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);u>=0;u--)if(e.pos<=this.end(u)&&(!t||t(this.node(u))))return new vt(this,e,u);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let u=[],r=0,i=t;for(let s=e;;){let{index:o,offset:a}=s.content.findIndex(i),l=i-a;if(u.push(s,o,r+a),!l||(s=s.child(o),s.isText))break;i=l-1,r+=a+1}return new ut(t,u,i)}static resolveCached(e,t){let u=lu.get(e);if(u)for(let i=0;i<u.elts.length;i++){let s=u.elts[i];if(s.pos==t)return s}else lu.set(e,u=new ts);let r=u.elts[u.i]=ut.resolve(e,t);return u.i=(u.i+1)%ns,r}}class ts{constructor(){this.elts=[],this.i=0}}const ns=12,lu=new WeakMap;class vt{constructor(e,t,u){this.$from=e,this.$to=t,this.depth=u}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const us=Object.create(null);let ge=class kn{constructor(e,t,u,r=v.none){this.type=e,this.attrs=t,this.marks=r,this.content=u||y.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,u,r=0){this.content.nodesBetween(e,t,u,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,u,r){return this.content.textBetween(e,t,u,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,u){return this.type==e&&At(this.attrs,t||e.defaultAttrs||us)&&v.sameSet(this.marks,u||v.none)}copy(e=null){return e==this.content?this:new kn(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new kn(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,u=!1){if(e==t)return w.empty;let r=this.resolve(e),i=this.resolve(t),s=u?0:r.sharedDepth(t),o=r.start(s),l=r.node(s).content.cut(r.pos-o,i.pos-o);return new w(l,r.depth-s,i.depth-s)}replace(e,t,u){return Zi(this.resolve(e),this.resolve(t),u)}nodeAt(e){for(let t=this;;){let{index:u,offset:r}=t.content.findIndex(e);if(t=t.maybeChild(u),!t)return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:u}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:u}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:u}=this.content.findIndex(e);if(u<e)return{node:this.content.child(t),index:t,offset:u};let r=this.content.child(t-1);return{node:r,index:t-1,offset:u-r.nodeSize}}resolve(e){return ut.resolveCached(this,e)}resolveNoCache(e){return ut.resolve(this,e)}rangeHasMark(e,t,u){let r=!1;return t>e&&this.nodesBetween(e,t,i=>(u.isInSet(i.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),br(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,u=y.empty,r=0,i=u.childCount){let s=this.contentMatchAt(e).matchFragment(u,r,i),o=s&&s.matchFragment(this.content,t);if(!o||!o.validEnd)return!1;for(let a=r;a<i;a++)if(!this.type.allowsMarks(u.child(a).marks))return!1;return!0}canReplaceWith(e,t,u,r){if(r&&!this.type.allowsMarks(r))return!1;let i=this.contentMatchAt(e).matchType(u),s=i&&i.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=v.none;for(let t=0;t<this.marks.length;t++){let u=this.marks[t];u.type.checkAttrs(u.attrs),e=u.addToSet(e)}if(!v.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let u;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");u=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,u)}let r=y.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,r,u);return i.type.checkAttrs(i.attrs),i}};ge.prototype.text=void 0;class Ot extends ge{constructor(e,t,u,r){if(super(e,t,null,r),!u)throw new RangeError("Empty text nodes are not allowed");this.text=u}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):br(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Ot(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Ot(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function br(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class ze{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let u=new rs(e,t);if(u.next==null)return ze.empty;let r=gr(u);u.next&&u.err("Unexpected trailing text");let i=fs(ds(r));return hs(i,u),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,u=e.childCount){let r=this;for(let i=t;r&&i<u;i++)r=r.matchType(e.child(i).type);return r}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let u=0;u<e.next.length;u++)if(this.next[t].type==e.next[u].type)return!0;return!1}fillBefore(e,t=!1,u=0){let r=[this];function i(s,o){let a=s.matchFragment(e,u);if(a&&(!t||a.validEnd))return y.from(o.map(l=>l.createAndFill()));for(let l=0;l<s.next.length;l++){let{type:c,next:d}=s.next[l];if(!(c.isText||c.hasRequiredAttrs())&&r.indexOf(d)==-1){r.push(d);let h=i(d,o.concat(c));if(h)return h}}return null}return i(this,[])}findWrapping(e){for(let u=0;u<this.wrapCache.length;u+=2)if(this.wrapCache[u]==e)return this.wrapCache[u+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),u=[{match:this,type:null,via:null}];for(;u.length;){let r=u.shift(),i=r.match;if(i.matchType(e)){let s=[];for(let o=r;o.type;o=o.via)s.push(o.type);return s.reverse()}for(let s=0;s<i.next.length;s++){let{type:o,next:a}=i.next[s];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in t)&&(!r.type||a.validEnd)&&(u.push({match:o.contentMatch,type:o,via:r}),t[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(u){e.push(u);for(let r=0;r<u.next.length;r++)e.indexOf(u.next[r].next)==-1&&t(u.next[r].next)}return t(this),e.map((u,r)=>{let i=r+(u.validEnd?"*":" ")+" ";for(let s=0;s<u.next.length;s++)i+=(s?", ":"")+u.next[s].type.name+"->"+e.indexOf(u.next[s].next);return i}).join(`
`)}}ze.empty=new ze(!0);class rs{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function gr(n){let e=[];do e.push(is(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function is(n){let e=[];do e.push(ss(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function ss(n){let e=cs(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=as(n,e);else break;return e}function cu(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function as(n,e){let t=cu(n),u=t;return n.eat(",")&&(n.next!="}"?u=cu(n):u=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:u,expr:e}}function ls(n,e){let t=n.nodeTypes,u=t[e];if(u)return[u];let r=[];for(let i in t){let s=t[i];s.isInGroup(e)&&r.push(s)}return r.length==0&&n.err("No node type or group '"+e+"' found"),r}function cs(n){if(n.eat("(")){let e=gr(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=ls(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function ds(n){let e=[[]];return r(i(n,0),t()),e;function t(){return e.push([])-1}function u(s,o,a){let l={term:a,to:o};return e[s].push(l),l}function r(s,o){s.forEach(a=>a.to=o)}function i(s,o){if(s.type=="choice")return s.exprs.reduce((a,l)=>a.concat(i(l,o)),[]);if(s.type=="seq")for(let a=0;;a++){let l=i(s.exprs[a],o);if(a==s.exprs.length-1)return l;r(l,o=t())}else if(s.type=="star"){let a=t();return u(o,a),r(i(s.expr,a),a),[u(a)]}else if(s.type=="plus"){let a=t();return r(i(s.expr,o),a),r(i(s.expr,a),a),[u(a)]}else{if(s.type=="opt")return[u(o)].concat(i(s.expr,o));if(s.type=="range"){let a=o;for(let l=0;l<s.min;l++){let c=t();r(i(s.expr,a),c),a=c}if(s.max==-1)r(i(s.expr,a),a);else for(let l=s.min;l<s.max;l++){let c=t();u(a,c),r(i(s.expr,a),c),a=c}return[u(a)]}else{if(s.type=="name")return[u(o,void 0,s.value)];throw new Error("Unknown expr type")}}}}function yr(n,e){return e-n}function du(n,e){let t=[];return u(e),t.sort(yr);function u(r){let i=n[r];if(i.length==1&&!i[0].term)return u(i[0].to);t.push(r);for(let s=0;s<i.length;s++){let{term:o,to:a}=i[s];!o&&t.indexOf(a)==-1&&u(a)}}}function fs(n){let e=Object.create(null);return t(du(n,0));function t(u){let r=[];u.forEach(s=>{n[s].forEach(({term:o,to:a})=>{if(!o)return;let l;for(let c=0;c<r.length;c++)r[c][0]==o&&(l=r[c][1]);du(n,a).forEach(c=>{l||r.push([o,l=[]]),l.indexOf(c)==-1&&l.push(c)})})});let i=e[u.join(",")]=new ze(u.indexOf(n.length-1)>-1);for(let s=0;s<r.length;s++){let o=r[s][1].sort(yr);i.next.push({type:r[s][0],next:e[o.join(",")]||t(o)})}return i}}function hs(n,e){for(let t=0,u=[n];t<u.length;t++){let r=u[t],i=!r.validEnd,s=[];for(let o=0;o<r.next.length;o++){let{type:a,next:l}=r.next[o];s.push(a.name),i&&!(a.isText||a.hasRequiredAttrs())&&(i=!1),u.indexOf(l)==-1&&u.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function xr(n){let e=Object.create(null);for(let t in n){let u=n[t];if(!u.hasDefault)return null;e[t]=u.default}return e}function kr(n,e){let t=Object.create(null);for(let u in n){let r=e&&e[u];if(r===void 0){let i=n[u];if(i.hasDefault)r=i.default;else throw new RangeError("No value supplied for attribute "+u)}t[u]=r}return t}function wr(n,e,t,u){for(let r in e)if(!(r in n))throw new RangeError(`Unsupported attribute ${r} for ${t} of type ${r}`);for(let r in n){let i=n[r];i.validate&&i.validate(e[r])}}function Sr(n,e){let t=Object.create(null);if(e)for(let u in e)t[u]=new ms(n,u,e[u]);return t}let fu=class Er{constructor(e,t,u){this.name=e,this.schema=t,this.spec=u,this.markSet=null,this.groups=u.group?u.group.split(" "):[],this.attrs=Sr(e,u.attrs),this.defaultAttrs=xr(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(u.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ze.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:kr(this.attrs,e)}create(e=null,t,u){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ge(this,this.computeAttrs(e),y.from(t),v.setFrom(u))}createChecked(e=null,t,u){return t=y.from(t),this.checkContent(t),new ge(this,this.computeAttrs(e),t,v.setFrom(u))}createAndFill(e=null,t,u){if(e=this.computeAttrs(e),t=y.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let r=this.contentMatch.matchFragment(t),i=r&&r.fillBefore(y.empty,!0);return i?new ge(this,e,t.append(i),v.setFrom(u)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let u=0;u<e.childCount;u++)if(!this.allowsMarks(e.child(u).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){wr(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let u=0;u<e.length;u++)this.allowsMarkType(e[u].type)?t&&t.push(e[u]):t||(t=e.slice(0,u));return t?t.length?t:v.none:e}static compile(e,t){let u=Object.create(null);e.forEach((i,s)=>u[i]=new Er(i,t,s));let r=t.spec.topNode||"doc";if(!u[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!u.text)throw new RangeError("Every schema needs a 'text' type");for(let i in u.text.attrs)throw new RangeError("The text node type should not have attributes");return u}};function ps(n,e,t){let u=t.split("|");return r=>{let i=r===null?"null":typeof r;if(u.indexOf(i)<0)throw new RangeError(`Expected value of type ${u} for attribute ${e} on type ${n}, got ${i}`)}}class ms{constructor(e,t,u){this.hasDefault=Object.prototype.hasOwnProperty.call(u,"default"),this.default=u.default,this.validate=typeof u.validate=="string"?ps(e,t,u.validate):u.validate}get isRequired(){return!this.hasDefault}}class Pn{constructor(e,t,u,r){this.name=e,this.rank=t,this.schema=u,this.spec=r,this.attrs=Sr(e,r.attrs),this.excluded=null;let i=xr(this.attrs);this.instance=i?new v(this,i):null}create(e=null){return!e&&this.instance?this.instance:new v(this,kr(this.attrs,e))}static compile(e,t){let u=Object.create(null),r=0;return e.forEach((i,s)=>u[i]=new Pn(i,r++,t,s)),u}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){wr(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Cr{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let r in e)t[r]=e[r];t.nodes=$.from(e.nodes),t.marks=$.from(e.marks||{}),this.nodes=fu.compile(this.spec.nodes,this),this.marks=Pn.compile(this.spec.marks,this);let u=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let i=this.nodes[r],s=i.spec.content||"",o=i.spec.marks;if(i.contentMatch=u[s]||(u[s]=ze.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=o=="_"?null:o?hu(this,o.split(" ")):o==""||!i.inlineContent?[]:null}for(let r in this.marks){let i=this.marks[r],s=i.spec.excludes;i.excluded=s==null?[i]:s==""?[]:hu(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,u,r){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof fu){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,u,r)}text(e,t){let u=this.nodes.text;return new Ot(u,u.defaultAttrs,e,v.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return ge.fromJSON(this,e)}markFromJSON(e){return v.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function hu(n,e){let t=[];for(let u=0;u<e.length;u++){let r=e[u],i=n.marks[r],s=i;if(i)t.push(i);else for(let o in n.marks){let a=n.marks[o];(r=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(r)>-1)&&t.push(s=a)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[u]+"'")}return t}function bs(n){return n.tag!=null}function gs(n){return n.style!=null}class De{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let u=this.matchedStyles=[];t.forEach(r=>{if(bs(r))this.tags.push(r);else if(gs(r)){let i=/[^=]*/.exec(r.style)[0];u.indexOf(i)<0&&u.push(i),this.styles.push(r)}}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let u=new mu(this,t,!1);return u.addAll(e,v.none,t.from,t.to),u.finish()}parseSlice(e,t={}){let u=new mu(this,t,!0);return u.addAll(e,v.none,t.from,t.to),w.maxOpen(u.finish())}matchTag(e,t,u){for(let r=u?this.tags.indexOf(u)+1:0;r<this.tags.length;r++){let i=this.tags[r];if(ks(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let s=i.getAttrs(e);if(s===!1)continue;i.attrs=s||void 0}return i}}}matchStyle(e,t,u,r){for(let i=r?this.styles.indexOf(r)+1:0;i<this.styles.length;i++){let s=this.styles[i],o=s.style;if(!(o.indexOf(e)!=0||s.context&&!u.matchesContext(s.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=t))){if(s.getAttrs){let a=s.getAttrs(t);if(a===!1)continue;s.attrs=a||void 0}return s}}}static schemaRules(e){let t=[];function u(r){let i=r.priority==null?50:r.priority,s=0;for(;s<t.length;s++){let o=t[s];if((o.priority==null?50:o.priority)<i)break}t.splice(s,0,r)}for(let r in e.marks){let i=e.marks[r].spec.parseDOM;i&&i.forEach(s=>{u(s=bu(s)),s.mark||s.ignore||s.clearMark||(s.mark=r)})}for(let r in e.nodes){let i=e.nodes[r].spec.parseDOM;i&&i.forEach(s=>{u(s=bu(s)),s.node||s.ignore||s.mark||(s.node=r)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new De(e,De.schemaRules(e)))}}const Tr={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ys={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Ar={ol:!0,ul:!0},rt=1,wn=2,kt=4;function pu(n,e,t){return e!=null?(e?rt:0)|(e==="full"?wn:0):n&&n.whitespace=="pre"?rt|wn:t&-5}class ht{constructor(e,t,u,r,i,s){this.type=e,this.attrs=t,this.marks=u,this.solid=r,this.options=s,this.content=[],this.activeMarks=v.none,this.match=i||(s&kt?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(y.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let u=this.type.contentMatch,r;return(r=u.findWrapping(e.type))?(this.match=u,r):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&rt)){let u=this.content[this.content.length-1],r;if(u&&u.isText&&(r=/[ \t\r\n\u000c]+$/.exec(u.text))){let i=u;u.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-r[0].length))}}let t=y.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(y.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Tr.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class mu{constructor(e,t,u){this.parser=e,this.options=t,this.isOpen=u,this.open=0,this.localPreserveWS=!1;let r=t.topNode,i,s=pu(null,t.preserveWhitespace,0)|(u?kt:0);r?i=new ht(r.type,r.attrs,v.none,!0,t.topMatch||r.type.contentMatch,s):u?i=new ht(null,null,v.none,!0,null,s):i=new ht(e.schema.topNodeType,null,v.none,!0,null,s),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let u=e.nodeValue,r=this.top,i=r.options&wn?"full":this.localPreserveWS||(r.options&rt)>0;if(i==="full"||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(u)){if(i)i!=="full"?u=u.replace(/\r?\n|\r/g," "):u=u.replace(/\r\n?/g,`
`);else if(u=u.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(u)&&this.open==this.nodes.length-1){let s=r.content[r.content.length-1],o=e.previousSibling;(!s||o&&o.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(u=u.slice(1))}u&&this.insertNode(this.parser.schema.text(u),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,u){let r=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),o;Ar.hasOwnProperty(s)&&this.parser.normalizeLists&&xs(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,u));e:if(a?a.ignore:ys.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let l,c=this.needsBlock;if(Tr.hasOwnProperty(s))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),l=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let d=a&&a.skip?t:this.readStyles(e,t);d&&this.addAll(e,d),l&&this.sync(i),this.needsBlock=c}else{let l=this.readStyles(e,t);l&&this.addElementByRule(e,a,l,a.consuming===!1?o:void 0)}this.localPreserveWS=r}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let u=e.style;if(u&&u.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let i=this.parser.matchedStyles[r],s=u.getPropertyValue(i);if(s)for(let o=void 0;;){let a=this.parser.matchStyle(i,s,this,o);if(!a)break;if(a.ignore)return null;if(a.clearMark?t=t.filter(l=>!a.clearMark(l)):t=t.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)o=a;else break}}return t}addElementByRule(e,t,u,r){let i,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),u)||this.leafFallback(e,u);else{let a=this.enter(s,t.attrs||null,u,t.preserveWhitespace);a&&(i=!0,u=a)}else{let a=this.parser.schema.marks[t.mark];u=u.concat(a.create(t.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,u,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,u));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a,u),this.findAround(e,a,!1)}i&&this.sync(o)&&this.open--}addAll(e,t,u,r){let i=u||0;for(let s=u?e.childNodes[u]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s,t);this.findAtPoint(e,i)}findPlace(e,t){let u,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!u||u.length>o.length)&&(u=o,r=s,!o.length)||s.solid)break}if(!u)return null;this.sync(r);for(let i=0;i<u.length;i++)t=this.enterInner(u[i],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let r=this.textblockFromContext();r&&(t=this.enterInner(r,null,t))}let u=this.findPlace(e,t);if(u){this.closeExtra();let r=this.top;r.match&&(r.match=r.match.matchType(e.type));let i=v.none;for(let s of u.concat(e.marks))(r.type?r.type.allowsMarkType(s.type):gu(s.type,e.type))&&(i=s.addToSet(i));return r.content.push(e.mark(i)),!0}return!1}enter(e,t,u,r){let i=this.findPlace(e.create(t),u);return i&&(i=this.enterInner(e,t,u,!0,r)),i}enterInner(e,t,u,r=!1,i){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=pu(e,i,s.options);s.options&kt&&s.content.length==0&&(o|=kt);let a=v.none;return u=u.filter(l=>(s.type?s.type.allowsMarkType(l.type):gu(l.type,e))?(a=l.addToSet(a),!1):!0),this.nodes.push(new ht(e,t,a,r,null,o)),this.open++,u}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=rt)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let u=this.nodes[t].content;for(let r=u.length-1;r>=0;r--)e+=u[r].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let u=0;u<this.find.length;u++)this.find[u].node==e&&this.find[u].offset==t&&(this.find[u].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,u){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(u?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),u=this.options.context,r=!this.isOpen&&(!u||u.parent.type==this.nodes[0].type),i=-(u?u.depth+1:0)+(r?0:1),s=(o,a)=>{for(;o>=0;o--){let l=t[o];if(l==""){if(o==t.length-1||o==0)continue;for(;a>=i;a--)if(s(o-1,a))return!0;return!1}else{let c=a>0||a==0&&r?this.nodes[a].type:u&&a>=i?u.node(a-i).type:null;if(!c||c.name!=l&&!c.isInGroup(l))return!1;a--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let u=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(u&&u.isTextblock&&u.defaultAttrs)return u}for(let t in this.parser.schema.nodes){let u=this.parser.schema.nodes[t];if(u.isTextblock&&u.defaultAttrs)return u}}}function xs(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let u=e.nodeType==1?e.nodeName.toLowerCase():null;u&&Ar.hasOwnProperty(u)&&t?(t.appendChild(e),e=t):u=="li"?t=e:u&&(t=null)}}function ks(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function bu(n){let e={};for(let t in n)e[t]=n[t];return e}function gu(n,e){let t=e.schema.nodes;for(let u in t){let r=t[u];if(!r.allowsMarkType(n))continue;let i=[],s=o=>{i.push(o);for(let a=0;a<o.edgeCount;a++){let{type:l,next:c}=o.edge(a);if(l==e||i.indexOf(c)<0&&s(c))return!0}};if(s(r.contentMatch))return!0}}class Ge{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},u){u||(u=Zt(t).createDocumentFragment());let r=u,i=[];return e.forEach(s=>{if(i.length||s.marks.length){let o=0,a=0;for(;o<i.length&&a<s.marks.length;){let l=s.marks[a];if(!this.marks[l.type.name]){a++;continue}if(!l.eq(i[o][0])||l.type.spec.spanning===!1)break;o++,a++}for(;o<i.length;)r=i.pop()[1];for(;a<s.marks.length;){let l=s.marks[a++],c=this.serializeMark(l,s.isInline,t);c&&(i.push([l,r]),r.appendChild(c.dom),r=c.contentDOM||c.dom)}}r.appendChild(this.serializeNodeInner(s,t))}),u}serializeNodeInner(e,t){let{dom:u,contentDOM:r}=wt(Zt(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return u}serializeNode(e,t={}){let u=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let i=this.serializeMark(e.marks[r],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(u),u=i.dom)}return u}serializeMark(e,t,u={}){let r=this.marks[e.type.name];return r&&wt(Zt(u),r(e,t),null,e.attrs)}static renderSpec(e,t,u=null,r){return wt(e,t,u,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Ge(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=yu(e.nodes);return t.text||(t.text=u=>u.text),t}static marksFromSchema(e){return yu(e.marks)}}function yu(n){let e={};for(let t in n){let u=n[t].spec.toDOM;u&&(e[t]=u)}return e}function Zt(n){return n.document||window.document}const xu=new WeakMap;function ws(n){let e=xu.get(n);return e===void 0&&xu.set(n,e=Ss(n)),e}function Ss(n){let e=null;function t(u){if(u&&typeof u=="object")if(Array.isArray(u))if(typeof u[0]=="string")e||(e=[]),e.push(u);else for(let r=0;r<u.length;r++)t(u[r]);else for(let r in u)t(u[r])}return t(n),e}function wt(n,e,t,u){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let r=e[0],i;if(typeof r!="string")throw new RangeError("Invalid array passed to renderSpec");if(u&&(i=ws(u))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=r.indexOf(" ");s>0&&(t=r.slice(0,s),r=r.slice(s+1));let o,a=t?n.createElementNS(t,r):n.createElement(r),l=e[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let d in l)if(l[d]!=null){let h=d.indexOf(" ");h>0?a.setAttributeNS(d.slice(0,h),d.slice(h+1),l[d]):a.setAttribute(d,l[d])}}for(let d=c;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:p}=wt(n,h,t,u);if(a.appendChild(f),p){if(o)throw new RangeError("Multiple content holes");o=p}}}return{dom:a,contentDOM:o}}const Mr=65535,Nr=Math.pow(2,16);function Es(n,e){return n+e*Nr}function ku(n){return n&Mr}function Cs(n){return(n-(n&Mr))/Nr}const vr=1,Or=2,St=4,Ir=8;class Sn{constructor(e,t,u){this.pos=e,this.delInfo=t,this.recover=u}get deleted(){return(this.delInfo&Ir)>0}get deletedBefore(){return(this.delInfo&(vr|St))>0}get deletedAfter(){return(this.delInfo&(Or|St))>0}get deletedAcross(){return(this.delInfo&St)>0}}class G{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&G.empty)return G.empty}recover(e){let t=0,u=ku(e);if(!this.inverted)for(let r=0;r<u;r++)t+=this.ranges[r*3+2]-this.ranges[r*3+1];return this.ranges[u*3]+t+Cs(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,u){let r=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?r:0);if(a>e)break;let l=this.ranges[o+i],c=this.ranges[o+s],d=a+l;if(e<=d){let h=l?e==a?-1:e==d?1:t:t,f=a+r+(h<0?0:c);if(u)return f;let p=e==(t<0?a:d)?null:Es(o/3,e-a),m=e==a?Or:e==d?vr:St;return(t<0?e!=a:e!=d)&&(m|=Ir),new Sn(f,m,p)}r+=c-l}return u?e+r:new Sn(e+r,0,null)}touches(e,t){let u=0,r=ku(t),i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?u:0);if(a>e)break;let l=this.ranges[o+i],c=a+l;if(e<=c&&o==r*3)return!0;u+=this.ranges[o+s]-l}return!1}forEach(e){let t=this.inverted?2:1,u=this.inverted?1:2;for(let r=0,i=0;r<this.ranges.length;r+=3){let s=this.ranges[r],o=s-(this.inverted?i:0),a=s+(this.inverted?0:i),l=this.ranges[r+t],c=this.ranges[r+u];e(o,o+l,a,a+c),i+=c-l}}invert(){return new G(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?G.empty:new G(e<0?[0,-e,0]:[0,0,e])}}G.empty=new G([]);class It{constructor(e,t,u=0,r=e?e.length:0){this.mirror=t,this.from=u,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new It(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,u=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],r!=null&&r<t?u+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,u=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),r!=null&&r>t?u-r-1:void 0)}}invert(){let e=new It;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let u=this.from;u<this.to;u++)e=this._maps[u].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,u){let r=0;for(let i=this.from;i<this.to;i++){let s=this._maps[i],o=s.mapResult(e,t);if(o.recover!=null){let a=this.getMirror(i);if(a!=null&&a>i&&a<this.to){i=a,e=this._maps[a].recover(o.recover);continue}}r|=o.delInfo,e=o.pos}return u?e:new Sn(e,r,null)}}const en=Object.create(null);class V{getMap(){return G.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let u=en[t.stepType];if(!u)throw new RangeError(`No step type ${t.stepType} defined`);return u.fromJSON(e,t)}static jsonID(e,t){if(e in en)throw new RangeError("Duplicate use of step JSON ID "+e);return en[e]=t,t.prototype.jsonID=e,t}}class D{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new D(e,null)}static fail(e){return new D(null,e)}static fromReplace(e,t,u,r){try{return D.ok(e.replace(t,u,r))}catch(i){if(i instanceof Mt)return D.fail(i.message);throw i}}}function Bn(n,e,t){let u=[];for(let r=0;r<n.childCount;r++){let i=n.child(r);i.content.size&&(i=i.copy(Bn(i.content,e,i))),i.isInline&&(i=e(i,t,r)),u.push(i)}return y.fromArray(u)}class Me extends V{constructor(e,t,u){super(),this.from=e,this.to=t,this.mark=u}apply(e){let t=e.slice(this.from,this.to),u=e.resolve(this.from),r=u.node(u.sharedDepth(this.to)),i=new w(Bn(t.content,(s,o)=>!s.isAtom||!o.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),r),t.openStart,t.openEnd);return D.fromReplace(e,this.from,this.to,i)}invert(){return new Ne(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),u=e.mapResult(this.to,-1);return t.deleted&&u.deleted||t.pos>=u.pos?null:new Me(t.pos,u.pos,this.mark)}merge(e){return e instanceof Me&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Me(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Me(t.from,t.to,e.markFromJSON(t.mark))}}V.jsonID("addMark",Me);class Ne extends V{constructor(e,t,u){super(),this.from=e,this.to=t,this.mark=u}apply(e){let t=e.slice(this.from,this.to),u=new w(Bn(t.content,r=>r.mark(this.mark.removeFromSet(r.marks)),e),t.openStart,t.openEnd);return D.fromReplace(e,this.from,this.to,u)}invert(){return new Me(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),u=e.mapResult(this.to,-1);return t.deleted&&u.deleted||t.pos>=u.pos?null:new Ne(t.pos,u.pos,this.mark)}merge(e){return e instanceof Ne&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ne(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ne(t.from,t.to,e.markFromJSON(t.mark))}}V.jsonID("removeMark",Ne);class ve extends V{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return D.fail("No node at mark step's position");let u=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return D.fromReplace(e,this.pos,this.pos+1,new w(y.from(u),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let u=this.mark.addToSet(t.marks);if(u.length==t.marks.length){for(let r=0;r<t.marks.length;r++)if(!t.marks[r].isInSet(u))return new ve(this.pos,t.marks[r]);return new ve(this.pos,this.mark)}}return new it(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ve(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ve(t.pos,e.markFromJSON(t.mark))}}V.jsonID("addNodeMark",ve);class it extends V{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return D.fail("No node at mark step's position");let u=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return D.fromReplace(e,this.pos,this.pos+1,new w(y.from(u),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new ve(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new it(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new it(t.pos,e.markFromJSON(t.mark))}}V.jsonID("removeNodeMark",it);class K extends V{constructor(e,t,u,r=!1){super(),this.from=e,this.to=t,this.slice=u,this.structure=r}apply(e){return this.structure&&En(e,this.from,this.to)?D.fail("Structure replace would overwrite content"):D.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new G([this.from,this.to-this.from,this.slice.size])}invert(e){return new K(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),u=e.mapResult(this.to,-1);return t.deletedAcross&&u.deletedAcross?null:new K(t.pos,Math.max(t.pos,u.pos),this.slice)}merge(e){if(!(e instanceof K)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?w.empty:new w(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new K(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?w.empty:new w(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new K(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new K(t.from,t.to,w.fromJSON(e,t.slice),!!t.structure)}}V.jsonID("replace",K);class J extends V{constructor(e,t,u,r,i,s,o=!1){super(),this.from=e,this.to=t,this.gapFrom=u,this.gapTo=r,this.slice=i,this.insert=s,this.structure=o}apply(e){if(this.structure&&(En(e,this.from,this.gapFrom)||En(e,this.gapTo,this.to)))return D.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return D.fail("Gap is not a flat range");let u=this.slice.insertAt(this.insert,t.content);return u?D.fromReplace(e,this.from,this.to,u):D.fail("Content does not fit in gap")}getMap(){return new G([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new J(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),u=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?u.pos:e.map(this.gapTo,1);return t.deletedAcross&&u.deletedAcross||r<t.pos||i>u.pos?null:new J(t.pos,u.pos,r,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new J(t.from,t.to,t.gapFrom,t.gapTo,w.fromJSON(e,t.slice),t.insert,!!t.structure)}}V.jsonID("replaceAround",J);function En(n,e,t){let u=n.resolve(e),r=t-e,i=u.depth;for(;r>0&&i>0&&u.indexAfter(i)==u.node(i).childCount;)i--,r--;if(r>0){let s=u.node(i).maybeChild(u.indexAfter(i));for(;r>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,r--}}return!1}function Ts(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Ye(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let u=n.depth;;--u){let r=n.$from.node(u),i=n.$from.index(u),s=n.$to.indexAfter(u);if(u<n.depth&&r.canReplace(i,s,t))return u;if(u==0||r.type.spec.isolating||!Ts(r,i,s))break}return null}function zn(n,e,t=null,u=n){let r=As(n,e),i=r&&Ms(u,e);return i?r.map(wu).concat({type:e,attrs:t}).concat(i.map(wu)):null}function wu(n){return{type:n,attrs:null}}function As(n,e){let{parent:t,startIndex:u,endIndex:r}=n,i=t.contentMatchAt(u).findWrapping(e);if(!i)return null;let s=i.length?i[0]:e;return t.canReplaceWith(u,r,s)?i:null}function Ms(n,e){let{parent:t,startIndex:u,endIndex:r}=n,i=t.child(u),s=e.contentMatch.findWrapping(i.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let l=u;a&&l<r;l++)a=a.matchType(t.child(l).type);return!a||!a.validEnd?null:s}function ce(n,e,t=1,u){let r=n.resolve(e),i=r.depth-t,s=u&&u[u.length-1]||r.parent;if(i<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!s.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let l=r.depth-1,c=t-2;l>i;l--,c--){let d=r.node(l),h=r.index(l);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(h,d.childCount),p=u&&u[c+1];p&&(f=f.replaceChild(0,p.type.create(p.attrs)));let m=u&&u[c]||d;if(!d.canReplace(h+1,d.childCount)||!m.type.validContent(f))return!1}let o=r.indexAfter(i),a=u&&u[0];return r.node(i).canReplaceWith(o,o,a?a.type:r.node(i+1).type)}function Se(n,e){let t=n.resolve(e),u=t.index();return Rr(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(u,u+1)}function Ns(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:u}=n.type.schema;for(let r=0;r<e.childCount;r++){let i=e.child(r),s=i.type==u?n.type.schema.nodes.text:i.type;if(t=t.matchType(s),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function Rr(n,e){return!!(n&&e&&!n.isLeaf&&Ns(n,e))}function Vt(n,e,t=-1){let u=n.resolve(e);for(let r=u.depth;;r--){let i,s,o=u.index(r);if(r==u.depth?(i=u.nodeBefore,s=u.nodeAfter):t>0?(i=u.node(r+1),o++,s=u.node(r).maybeChild(o)):(i=u.node(r).maybeChild(o-1),s=u.node(r+1)),i&&!i.isTextblock&&Rr(i,s)&&u.node(r).canReplace(o,o+1))return e;if(r==0)break;e=t<0?u.before(r):u.after(r)}}function Dr(n,e,t){let u=n.resolve(e);if(!t.content.size)return e;let r=t.content;for(let i=0;i<t.openStart;i++)r=r.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let s=u.depth;s>=0;s--){let o=s==u.depth?0:u.pos<=(u.start(s+1)+u.end(s+1))/2?-1:1,a=u.index(s)+(o>0?1:0),l=u.node(s),c=!1;if(i==1)c=l.canReplace(a,a,r);else{let d=l.contentMatchAt(a).findWrapping(r.firstChild.type);c=d&&l.canReplaceWith(a,a,d[0])}if(c)return o==0?u.pos:o<0?u.before(s+1):u.after(s+1)}return null}function $n(n,e,t=e,u=w.empty){if(e==t&&!u.size)return null;let r=n.resolve(e),i=n.resolve(t);return vs(r,i,u)?new K(e,t,u):new Os(r,i,u).fit()}function vs(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class Os{constructor(e,t,u){this.$from=e,this.$to=t,this.unplaced=u,this.frontier=[],this.placed=y.empty;for(let r=0;r<=e.depth;r++){let i=e.node(r);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=y.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let l=this.findFittable();l?this.placeNodes(l):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,u=this.$from,r=this.close(e<0?this.$to:u.doc.resolve(e));if(!r)return null;let i=this.placed,s=u.depth,o=r.depth;for(;s&&o&&i.childCount==1;)i=i.firstChild.content,s--,o--;let a=new w(i,s,o);return e>-1?new J(u.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||u.pos!=this.$to.pos?new K(u.pos,r.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,u=0,r=this.unplaced.openEnd;u<e;u++){let i=t.firstChild;if(t.childCount>1&&(r=0),i.type.spec.isolating&&r<=u){e=u;break}t=i.content}for(let t=1;t<=2;t++)for(let u=t==1?e:this.unplaced.openStart;u>=0;u--){let r,i=null;u?(i=tn(this.unplaced.content,u-1).firstChild,r=i.content):r=this.unplaced.content;let s=r.firstChild;for(let o=this.depth;o>=0;o--){let{type:a,match:l}=this.frontier[o],c,d=null;if(t==1&&(s?l.matchType(s.type)||(d=l.fillBefore(y.from(s),!1)):i&&a.compatibleContent(i.type)))return{sliceDepth:u,frontierDepth:o,parent:i,inject:d};if(t==2&&s&&(c=l.findWrapping(s.type)))return{sliceDepth:u,frontierDepth:o,parent:i,wrap:c};if(i&&l.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:u}=this.unplaced,r=tn(e,t);return!r.childCount||r.firstChild.isLeaf?!1:(this.unplaced=new w(e,t+1,Math.max(u,r.size+t>=e.size-u?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:u}=this.unplaced,r=tn(e,t);if(r.childCount<=1&&t>0){let i=e.size-t<=t+r.size;this.unplaced=new w(Qe(e,t-1,1),t-1,i?t-1:u)}else this.unplaced=new w(Qe(e,t,1),t,u)}placeNodes({sliceDepth:e,frontierDepth:t,parent:u,inject:r,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let s=this.unplaced,o=u?u.content:s.content,a=s.openStart-e,l=0,c=[],{match:d,type:h}=this.frontier[t];if(r){for(let m=0;m<r.childCount;m++)c.push(r.child(m));d=d.matchFragment(r)}let f=o.size+e-(s.content.size-s.openEnd);for(;l<o.childCount;){let m=o.child(l),b=d.matchType(m.type);if(!b)break;l++,(l>1||a==0||m.content.size)&&(d=b,c.push(Lr(m.mark(h.allowedMarks(m.marks)),l==1?a:0,l==o.childCount?f:-1)))}let p=l==o.childCount;p||(f=-1),this.placed=Ze(this.placed,t,y.from(c)),this.frontier[t].match=d,p&&f<0&&u&&u.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,b=o;m<f;m++){let g=b.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),b=g.content}this.unplaced=p?e==0?w.empty:new w(Qe(s.content,e-1,1),e-1,f<0?s.openEnd:e-1):new w(Qe(s.content,e,l),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!nn(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:u}=this.$to,r=this.$to.after(u);for(;u>1&&r==this.$to.end(--u);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:u,type:r}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=nn(e,t,r,u,i);if(s){for(let o=t-1;o>=0;o--){let{match:a,type:l}=this.frontier[o],c=nn(e,o,l,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Ze(this.placed,t.depth,t.fit)),e=t.move;for(let u=t.depth+1;u<=e.depth;u++){let r=e.node(u),i=r.type.contentMatch.fillBefore(r.content,!0,e.index(u));this.openFrontierNode(r.type,r.attrs,i)}return e}openFrontierNode(e,t=null,u){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Ze(this.placed,this.depth,y.from(e.create(t,u))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(y.empty,!0);t.childCount&&(this.placed=Ze(this.placed,this.frontier.length,t))}}function Qe(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Qe(n.firstChild.content,e-1,t)))}function Ze(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Ze(n.lastChild.content,e-1,t)))}function tn(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Lr(n,e,t){if(e<=0)return n;let u=n.content;return e>1&&(u=u.replaceChild(0,Lr(u.firstChild,e-1,u.childCount==1?t-1:0))),e>0&&(u=n.type.contentMatch.fillBefore(u).append(u),t<=0&&(u=u.append(n.type.contentMatch.matchFragment(u).fillBefore(y.empty,!0)))),n.copy(u)}function nn(n,e,t,u,r){let i=n.node(e),s=r?n.indexAfter(e):n.index(e);if(s==i.childCount&&!t.compatibleContent(i.type))return null;let o=u.fillBefore(i.content,!0,s);return o&&!Is(t,i.content,s)?o:null}function Is(n,e,t){for(let u=t;u<e.childCount;u++)if(!n.allowsMarks(e.child(u).marks))return!0;return!1}class tt extends V{constructor(e,t,u){super(),this.pos=e,this.attr=t,this.value=u}apply(e){let t=e.nodeAt(this.pos);if(!t)return D.fail("No node at attribute step's position");let u=Object.create(null);for(let i in t.attrs)u[i]=t.attrs[i];u[this.attr]=this.value;let r=t.type.create(u,null,t.marks);return D.fromReplace(e,this.pos,this.pos+1,new w(y.from(r),0,t.isLeaf?0:1))}getMap(){return G.empty}invert(e){return new tt(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new tt(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new tt(t.pos,t.attr,t.value)}}V.jsonID("attr",tt);class Rt extends V{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let u=e.type.create(t,e.content,e.marks);return D.ok(u)}getMap(){return G.empty}invert(e){return new Rt(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Rt(t.attr,t.value)}}V.jsonID("docAttr",Rt);let st=class extends Error{};st=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};st.prototype=Object.create(Error.prototype);st.prototype.constructor=st;st.prototype.name="TransformError";const un=Object.create(null);class T{constructor(e,t,u){this.$anchor=e,this.$head=t,this.ranges=u||[new Rs(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=w.empty){let u=t.content.lastChild,r=null;for(let o=0;o<t.openEnd;o++)r=u,u=u.lastChild;let i=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:a,$to:l}=s[o],c=e.mapping.slice(i);e.replaceRange(c.map(a.pos),c.map(l.pos),o?w.empty:t),o==0&&Cu(e,i,(u?u.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let u=e.steps.length,r=this.ranges;for(let i=0;i<r.length;i++){let{$from:s,$to:o}=r[i],a=e.mapping.slice(u),l=a.map(s.pos),c=a.map(o.pos);i?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),Cu(e,u,t.isInline?-1:1))}}static findFrom(e,t,u=!1){let r=e.parent.inlineContent?new E(e):qe(e.node(0),e.parent,e.pos,e.index(),t,u);if(r)return r;for(let i=e.depth-1;i>=0;i--){let s=t<0?qe(e.node(0),e.node(i),e.before(i+1),e.index(i),t,u):qe(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,u);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Y(e.node(0))}static atStart(e){return qe(e,e,0,0,1)||new Y(e)}static atEnd(e){return qe(e,e,e.content.size,e.childCount,-1)||new Y(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let u=un[t.type];if(!u)throw new RangeError(`No selection type ${t.type} defined`);return u.fromJSON(e,t)}static jsonID(e,t){if(e in un)throw new RangeError("Duplicate use of selection JSON ID "+e);return un[e]=t,t.prototype.jsonID=e,t}getBookmark(){return E.between(this.$anchor,this.$head).getBookmark()}}T.prototype.visible=!0;class Rs{constructor(e,t){this.$from=e,this.$to=t}}let Su=!1;function Eu(n){!Su&&!n.parent.inlineContent&&(Su=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class E extends T{constructor(e,t=e){Eu(e),Eu(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let u=e.resolve(t.map(this.head));if(!u.parent.inlineContent)return T.near(u);let r=e.resolve(t.map(this.anchor));return new E(r.parent.inlineContent?r:u,u)}replace(e,t=w.empty){if(super.replace(e,t),t==w.empty){let u=this.$from.marksAcross(this.$to);u&&e.ensureMarks(u)}}eq(e){return e instanceof E&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new jt(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new E(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,u=t){let r=e.resolve(t);return new this(r,u==t?r:e.resolve(u))}static between(e,t,u){let r=e.pos-t.pos;if((!u||r)&&(u=r>=0?1:-1),!t.parent.inlineContent){let i=T.findFrom(t,u,!0)||T.findFrom(t,-u,!0);if(i)t=i.$head;else return T.near(t,u)}return e.parent.inlineContent||(r==0?e=t:(e=(T.findFrom(e,-u,!0)||T.findFrom(e,u,!0)).$anchor,e.pos<t.pos!=r<0&&(e=t))),new E(e,t)}}T.jsonID("text",E);class jt{constructor(e,t){this.anchor=e,this.head=t}map(e){return new jt(e.map(this.anchor),e.map(this.head))}resolve(e){return E.between(e.resolve(this.anchor),e.resolve(this.head))}}class S extends T{constructor(e){let t=e.nodeAfter,u=e.node(0).resolve(e.pos+t.nodeSize);super(e,u),this.node=t}map(e,t){let{deleted:u,pos:r}=t.mapResult(this.anchor),i=e.resolve(r);return u?T.near(i):new S(i)}content(){return new w(y.from(this.node),0,0)}eq(e){return e instanceof S&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new _n(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new S(e.resolve(t.anchor))}static create(e,t){return new S(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}S.prototype.visible=!1;T.jsonID("node",S);class _n{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:u}=e.mapResult(this.anchor);return t?new jt(u,u):new _n(u)}resolve(e){let t=e.resolve(this.anchor),u=t.nodeAfter;return u&&S.isSelectable(u)?new S(t):T.near(t)}}class Y extends T{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=w.empty){if(t==w.empty){e.delete(0,e.doc.content.size);let u=T.atStart(e.doc);u.eq(e.selection)||e.setSelection(u)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Y(e)}map(e){return new Y(e)}eq(e){return e instanceof Y}getBookmark(){return Ds}}T.jsonID("all",Y);const Ds={map(){return this},resolve(n){return new Y(n)}};function qe(n,e,t,u,r,i=!1){if(e.inlineContent)return E.create(n,t);for(let s=u-(r>0?0:1);r>0?s<e.childCount:s>=0;s+=r){let o=e.child(s);if(o.isAtom){if(!i&&S.isSelectable(o))return S.create(n,t-(r<0?o.nodeSize:0))}else{let a=qe(n,o,t+r,r<0?o.childCount:0,r,i);if(a)return a}t+=o.nodeSize*r}return null}function Cu(n,e,t){let u=n.steps.length-1;if(u<e)return;let r=n.steps[u];if(!(r instanceof K||r instanceof J))return;let i=n.mapping.maps[u],s;i.forEach((o,a,l,c)=>{s==null&&(s=c)}),n.setSelection(T.near(n.doc.resolve(s),t))}function Tu(n,e){return!e||!n?n:n.bind(e)}class pt{constructor(e,t,u){this.name=e,this.init=Tu(t.init,u),this.apply=Tu(t.apply,u)}}new pt("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new pt("selection",{init(n,e){return n.selection||T.atStart(e.doc)},apply(n){return n.selection}}),new pt("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,u){return u.selection.$cursor?n.storedMarks:null}}),new pt("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}});function Pr(n,e,t){for(let u in n){let r=n[u];r instanceof Function?r=r.bind(e):u=="handleDOMEvents"&&(r=Pr(r,e,{})),t[u]=r}return t}class U{constructor(e){this.spec=e,this.props={},e.props&&Pr(e.props,this,this.props),this.key=e.key?e.key.key:Br("plugin")}getState(e){return e[this.key]}}const rn=Object.create(null);function Br(n){return n in rn?n+"$"+ ++rn[n]:(rn[n]=0,n+"$")}class le{constructor(e="key"){this.key=Br(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const $e=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},zr=function(n,e,t,u){return t&&(Au(n,e,t,u,-1)||Au(n,e,t,u,1))},Ls=/^(img|br|input|textarea|hr)$/i;function Au(n,e,t,u,r){for(;;){if(n==t&&e==u)return!0;if(e==(r<0?0:Dt(n))){let i=n.parentNode;if(!i||i.nodeType!=1||Fn(n)||Ls.test(n.nodeName)||n.contentEditable=="false")return!1;e=$e(n)+(r<0?0:1),n=i}else if(n.nodeType==1){if(n=n.childNodes[e+(r<0?-1:0)],n.contentEditable=="false")return!1;e=r<0?Dt(n):0}else return!1}}function Dt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Ps(n,e,t){for(let u=e==0,r=e==Dt(n);u||r;){if(n==t)return!0;let i=$e(n);if(n=n.parentNode,!n)return!1;u=u&&i==0,r=r&&i==Dt(n)}}function Fn(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const $r=function(n){return n.focusNode&&zr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function _r(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}const ae=typeof navigator<"u"?navigator:null,Mu=typeof document<"u"?document:null,Ee=ae&&ae.userAgent||"",Cn=/Edge\/(\d+)/.exec(Ee),Fr=/MSIE \d/.exec(Ee),Tn=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ee),ct=!!(Fr||Tn||Cn),qr=Fr?document.documentMode:Tn?+Tn[1]:Cn?+Cn[1]:0,Wt=!ct&&/gecko\/(\d+)/i.test(Ee);Wt&&+(/Firefox\/(\d+)/.exec(Ee)||[0,0])[1];const An=!ct&&/Chrome\/(\d+)/.exec(Ee),Ce=!!An,Hr=An?+An[1]:0,_e=!ct&&!!ae&&/Apple Computer/.test(ae.vendor),qn=_e&&(/Mobile\/\w+/.test(Ee)||!!ae&&ae.maxTouchPoints>2),Q=qn||(ae?/Mac/.test(ae.platform):!1),Bs=ae?/Win/.test(ae.platform):!1,dt=/Android \d/.test(Ee),Hn=!!Mu&&"webkitFontSmoothing"in Mu.documentElement.style,zs=Hn?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function $s(n,e=null){let t=n.domSelectionRange(),u=n.state.doc;if(!t.focusNode)return null;let r=n.docView.nearestDesc(t.focusNode),i=r&&r.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let o=u.resolve(s),a,l;if($r(t)){for(a=s;r&&!r.node;)r=r.parent;let d=r.node;if(r&&d.isAtom&&S.isSelectable(d)&&r.parent&&!(d.isInline&&Ps(t.focusNode,t.focusOffset,r.dom))){let h=r.posBefore;l=new S(s==h?o:u.resolve(h))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let d=s,h=s;for(let f=0;f<t.rangeCount;f++){let p=t.getRangeAt(f);d=Math.min(d,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),h=Math.max(h,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[a,s]=h==n.state.selection.anchor?[h,d]:[d,h],o=u.resolve(s)}else a=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(a<0)return null}let c=u.resolve(a);if(!l){let d=e=="pointer"||n.state.selection.head<o.pos&&!i?1:-1;l=jr(n,c,o,d)}return l}function Vr(n){return n.editable?n.hasFocus():Hs(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Vn(n,e=!1){let t=n.state.selection;if(qs(n,t),!!Vr(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Ce){let u=n.domSelectionRange(),r=n.domObserver.currentSelection;if(u.anchorNode&&r.anchorNode&&zr(u.anchorNode,u.anchorOffset,r.anchorNode,r.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Fs(n);else{let{anchor:u,head:r}=t,i,s;Nu&&!(t instanceof E)&&(t.$from.parent.inlineContent||(i=vu(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=vu(n,t.to))),n.docView.setSelection(u,r,n,e),Nu&&(i&&Ou(i),s&&Ou(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&_s(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Nu=_e||Ce&&Hr<63;function vu(n,e){let{node:t,offset:u}=n.docView.domFromPos(e,0),r=u<t.childNodes.length?t.childNodes[u]:null,i=u?t.childNodes[u-1]:null;if(_e&&r&&r.contentEditable=="false")return sn(r);if((!r||r.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(r)return sn(r);if(i)return sn(i)}}function sn(n){return n.contentEditable="true",_e&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Ou(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function _s(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),u=t.anchorNode,r=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=u||t.anchorOffset!=r)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Vr(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Fs(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let u=n.cursorWrapper.dom,r=u.nodeName=="IMG";r?t.setStart(u.parentNode,$e(u)+1):t.setStart(u,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!r&&!n.state.selection.visible&&ct&&qr<=11&&(u.disabled=!0,u.disabled=!1)}function qs(n,e){if(e instanceof S){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Iu(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Iu(n)}function Iu(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function jr(n,e,t,u){return n.someProp("createSelectionBetween",r=>r(n,e,t))||E.between(e,t,u)}function Hs(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Mn(n,e){let{$anchor:t,$head:u}=n.selection,r=e>0?t.max(u):t.min(u),i=r.parent.inlineContent?r.depth?n.doc.resolve(e>0?r.after():r.before()):null:r;return i&&T.findFrom(i,e)}function fe(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Ru(n,e,t){let u=n.state.selection;if(u instanceof E)if(t.indexOf("s")>-1){let{$head:r}=u,i=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=n.state.doc.resolve(r.pos+i.nodeSize*(e<0?-1:1));return fe(n,new E(u.$anchor,s))}else if(u.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let r=Mn(n.state,e);return r&&r instanceof S?fe(n,r):!1}else if(!(Q&&t.indexOf("m")>-1)){let r=u.$head,i=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter,s;if(!i||i.isText)return!1;let o=e<0?r.pos-i.nodeSize:r.pos;return i.isAtom||(s=n.docView.descAt(o))&&!s.contentDOM?S.isSelectable(i)?fe(n,new S(e<0?n.state.doc.resolve(r.pos-i.nodeSize):r)):Hn?fe(n,new E(n.state.doc.resolve(e<0?o:o+i.nodeSize))):!1:!1}}else return!1;else{if(u instanceof S&&u.node.isInline)return fe(n,new E(e>0?u.$to:u.$from));{let r=Mn(n.state,e);return r?fe(n,r):!1}}}function Lt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function nt(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Fe(n,e){return e<0?Vs(n):js(n)}function Vs(n){let e=n.domSelectionRange(),t=e.focusNode,u=e.focusOffset;if(!t)return;let r,i,s=!1;for(Wt&&t.nodeType==1&&u<Lt(t)&&nt(t.childNodes[u],-1)&&(s=!0);;)if(u>0){if(t.nodeType!=1)break;{let o=t.childNodes[u-1];if(nt(o,-1))r=t,i=--u;else if(o.nodeType==3)t=o,u=t.nodeValue.length;else break}}else{if(Wr(t))break;{let o=t.previousSibling;for(;o&&nt(o,-1);)r=t.parentNode,i=$e(o),o=o.previousSibling;if(o)t=o,u=Lt(t);else{if(t=t.parentNode,t==n.dom)break;u=0}}}s?Nn(n,t,u):r&&Nn(n,r,i)}function js(n){let e=n.domSelectionRange(),t=e.focusNode,u=e.focusOffset;if(!t)return;let r=Lt(t),i,s;for(;;)if(u<r){if(t.nodeType!=1)break;let o=t.childNodes[u];if(nt(o,1))i=t,s=++u;else break}else{if(Wr(t))break;{let o=t.nextSibling;for(;o&&nt(o,1);)i=o.parentNode,s=$e(o)+1,o=o.nextSibling;if(o)t=o,u=0,r=Lt(t);else{if(t=t.parentNode,t==n.dom)break;u=r=0}}}i&&Nn(n,i,s)}function Wr(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Ws(n,e){for(;n&&e==n.childNodes.length&&!Fn(n);)e=$e(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function Js(n,e){for(;n&&!e&&!Fn(n);)e=$e(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Nn(n,e,t){if(e.nodeType!=3){let i,s;(s=Ws(e,t))?(e=s,t=0):(i=Js(e,t))&&(e=i,t=i.nodeValue.length)}let u=n.domSelection();if(!u)return;if($r(u)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),u.removeAllRanges(),u.addRange(i)}else u.extend&&u.extend(e,t);n.domObserver.setCurSelection();let{state:r}=n;setTimeout(()=>{n.state==r&&Vn(n)},50)}function Du(n,e){let t=n.state.doc.resolve(e);if(!(Ce||Bs)&&t.parent.inlineContent){let r=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),s=(i.top+i.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(i.left-r.left)>1)return i.left<r.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),s=(i.top+i.bottom)/2;if(s>r.top&&s<r.bottom&&Math.abs(i.left-r.left)>1)return i.left>r.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function Lu(n,e,t){let u=n.state.selection;if(u instanceof E&&!u.empty||t.indexOf("s")>-1||Q&&t.indexOf("m")>-1)return!1;let{$from:r,$to:i}=u;if(!r.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=Mn(n.state,e);if(s&&s instanceof S)return fe(n,s)}if(!r.parent.inlineContent){let s=e<0?r:i,o=u instanceof Y?T.near(s,e):T.findFrom(s,e);return o?fe(n,o):!1}return!1}function Pu(n,e){if(!(n.state.selection instanceof E))return!0;let{$head:t,$anchor:u,empty:r}=n.state.selection;if(!t.sameParent(u))return!0;if(!r)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let s=n.state.tr;return e<0?s.delete(t.pos-i.nodeSize,t.pos):s.delete(t.pos,t.pos+i.nodeSize),n.dispatch(s),!0}return!1}function Bu(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Us(n){if(!_e||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let u=e.firstChild;Bu(n,u,"true"),setTimeout(()=>Bu(n,u,"false"),20)}return!1}function Ks(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function Gs(n,e){let t=e.keyCode,u=Ks(e);if(t==8||Q&&t==72&&u=="c")return Pu(n,-1)||Fe(n,-1);if(t==46&&!e.shiftKey||Q&&t==68&&u=="c")return Pu(n,1)||Fe(n,1);if(t==13||t==27)return!0;if(t==37||Q&&t==66&&u=="c"){let r=t==37?Du(n,n.state.selection.from)=="ltr"?-1:1:-1;return Ru(n,r,u)||Fe(n,r)}else if(t==39||Q&&t==70&&u=="c"){let r=t==39?Du(n,n.state.selection.from)=="ltr"?1:-1:1;return Ru(n,r,u)||Fe(n,r)}else{if(t==38||Q&&t==80&&u=="c")return Lu(n,-1,u)||Fe(n,-1);if(t==40||Q&&t==78&&u=="c")return Us(n)||Lu(n,1,u)||Fe(n,1);if(u==(Q?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Jr(n,e){n.someProp("transformCopied",f=>{e=f(e,n)});let t=[],{content:u,openStart:r,openEnd:i}=e;for(;r>1&&i>1&&u.childCount==1&&u.firstChild.childCount==1;){r--,i--;let f=u.firstChild;t.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),u=f.content}let s=n.someProp("clipboardSerializer")||Ge.fromSchema(n.state.schema),o=Qr(),a=o.createElement("div");a.appendChild(s.serializeFragment(u,{document:o}));let l=a.firstChild,c,d=0;for(;l&&l.nodeType==1&&(c=Xr[l.nodeName.toLowerCase()]);){for(let f=c.length-1;f>=0;f--){let p=o.createElement(c[f]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),d++}l=a.firstChild}l&&l.nodeType==1&&l.setAttribute("data-pm-slice",`${r} ${i}${d?` -${d}`:""} ${JSON.stringify(t)}`);let h=n.someProp("clipboardTextSerializer",f=>f(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:h,slice:e}}function Ur(n,e,t,u,r){let i=r.parent.type.spec.code,s,o;if(!t&&!e)return null;let a=e&&(u||i||!t);if(a){if(n.someProp("transformPastedText",h=>{e=h(e,i||u,n)}),i)return e?new w(y.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):w.empty;let d=n.someProp("clipboardTextParser",h=>h(e,r,u,n));if(d)o=d;else{let h=r.marks(),{schema:f}=n.state,p=Ge.fromSchema(f);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let b=s.appendChild(document.createElement("p"));m&&b.appendChild(p.serializeNode(f.text(m,h)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),s=Zs(t),Hn&&eo(s);let l=s&&s.querySelector("[data-pm-slice]"),c=l&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(l.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let d=+c[3];d>0;d--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(o||(o=(n.someProp("clipboardParser")||n.someProp("domParser")||De.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||c),context:r,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!Ys.test(h.parentNode.nodeName)?{ignore:!0}:null}})),c)o=to(zu(o,+c[1],+c[2]),c[4]);else if(o=w.maxOpen(Xs(o.content,r),!0),o.openStart||o.openEnd){let d=0,h=0;for(let f=o.content.firstChild;d<o.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=o.content.lastChild;h<o.openEnd&&!f.type.spec.isolating;h++,f=f.lastChild);o=zu(o,d,h)}return n.someProp("transformPasted",d=>{o=d(o,n)}),o}const Ys=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Xs(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.index(t)),i,s=[];if(n.forEach(o=>{if(!s)return;let a=r.findWrapping(o.type),l;if(!a)return s=null;if(l=s.length&&i.length&&Gr(a,i,o,s[s.length-1],0))s[s.length-1]=l;else{s.length&&(s[s.length-1]=Yr(s[s.length-1],i.length));let c=Kr(o,a);s.push(c),r=r.matchType(c.type),i=a}}),s)return y.from(s)}return n}function Kr(n,e,t=0){for(let u=e.length-1;u>=t;u--)n=e[u].create(null,y.from(n));return n}function Gr(n,e,t,u,r){if(r<n.length&&r<e.length&&n[r]==e[r]){let i=Gr(n,e,t,u.lastChild,r+1);if(i)return u.copy(u.content.replaceChild(u.childCount-1,i));if(u.contentMatchAt(u.childCount).matchType(r==n.length-1?t.type:n[r+1]))return u.copy(u.content.append(y.from(Kr(t,n,r+1))))}}function Yr(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,Yr(n.lastChild,e-1)),u=n.contentMatchAt(n.childCount).fillBefore(y.empty,!0);return n.copy(t.append(u))}function vn(n,e,t,u,r,i){let s=e<0?n.firstChild:n.lastChild,o=s.content;return n.childCount>1&&(i=0),r<u-1&&(o=vn(o,e,t,u,r+1,i)),r>=t&&(o=e<0?s.contentMatchAt(0).fillBefore(o,i<=r).append(o):o.append(s.contentMatchAt(s.childCount).fillBefore(y.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(o))}function zu(n,e,t){return e<n.openStart&&(n=new w(vn(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new w(vn(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Xr={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let $u=null;function Qr(){return $u||($u=document.implementation.createHTMLDocument("title"))}let on=null;function Qs(n){let e=window.trustedTypes;return e?(on||(on=e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),on.createHTML(n)):n}function Zs(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Qr().createElement("div"),u=/<([a-z][^>\s]+)/i.exec(n),r;if((r=u&&Xr[u[1].toLowerCase()])&&(n=r.map(i=>"<"+i+">").join("")+n+r.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=Qs(n),r)for(let i=0;i<r.length;i++)t=t.querySelector(r[i])||t;return t}function eo(n){let e=n.querySelectorAll(Ce?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let u=e[t];u.childNodes.length==1&&u.textContent==""&&u.parentNode&&u.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),u)}}function to(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,u;try{u=JSON.parse(e)}catch{return n}let{content:r,openStart:i,openEnd:s}=n;for(let o=u.length-2;o>=0;o-=2){let a=t.nodes[u[o]];if(!a||a.hasRequiredAttrs())break;r=y.from(a.create(u[o+1],r)),i++,s++}return new w(r,i,s)}const ne={},X={};function me(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}X.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!ei(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(dt&&Ce&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),qn&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let u=Date.now();n.input.lastIOSEnter=u,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==u&&(n.someProp("handleKeyDown",r=>r(n,_r(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",u=>u(n,t))||Gs(n,t)?t.preventDefault():me(n,"key")};X.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};X.keypress=(n,e)=>{let t=e;if(ei(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Q&&t.metaKey)return;if(n.someProp("handleKeyPress",r=>r(n,t))){t.preventDefault();return}let u=n.state.selection;if(!(u instanceof E)||!u.$from.sameParent(u.$to)){let r=String.fromCharCode(t.charCode);!/[\r\n]/.test(r)&&!n.someProp("handleTextInput",i=>i(n,u.$from.pos,u.$to.pos,r))&&n.dispatch(n.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}};function Jt(n){return{left:n.clientX,top:n.clientY}}function no(n,e){let t=e.x-n.clientX,u=e.y-n.clientY;return t*t+u*u<100}function jn(n,e,t,u,r){if(u==-1)return!1;let i=n.state.doc.resolve(u);for(let s=i.depth+1;s>0;s--)if(n.someProp(e,o=>s>i.depth?o(n,t,i.nodeAfter,i.before(s),r,!0):o(n,t,i.node(s),i.before(s),r,!1)))return!0;return!1}function We(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let u=n.state.tr.setSelection(e);u.setMeta("pointer",!0),n.dispatch(u)}function uo(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),u=t.nodeAfter;return u&&u.isAtom&&S.isSelectable(u)?(We(n,new S(t)),!0):!1}function ro(n,e){if(e==-1)return!1;let t=n.state.selection,u,r;t instanceof S&&(u=t.node);let i=n.state.doc.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s);if(S.isSelectable(o)){u&&t.$from.depth>0&&s>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?r=i.before(t.$from.depth):r=i.before(s);break}}return r!=null?(We(n,S.create(n.state.doc,r)),!0):!1}function io(n,e,t,u,r){return jn(n,"handleClickOn",e,t,u)||n.someProp("handleClick",i=>i(n,e,u))||(r?ro(n,t):uo(n,t))}function so(n,e,t,u){return jn(n,"handleDoubleClickOn",e,t,u)||n.someProp("handleDoubleClick",r=>r(n,e,u))}function oo(n,e,t,u){return jn(n,"handleTripleClickOn",e,t,u)||n.someProp("handleTripleClick",r=>r(n,e,u))||ao(n,t,u)}function ao(n,e,t){if(t.button!=0)return!1;let u=n.state.doc;if(e==-1)return u.inlineContent?(We(n,E.create(u,0,u.content.size)),!0):!1;let r=u.resolve(e);for(let i=r.depth+1;i>0;i--){let s=i>r.depth?r.nodeAfter:r.node(i),o=r.before(i);if(s.inlineContent)We(n,E.create(u,o+1,o+1+s.content.size));else if(S.isSelectable(s))We(n,S.create(u,o));else continue;return!0}}function Wn(n){return Pt(n)}const Zr=Q?"metaKey":"ctrlKey";ne.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let u=Wn(n),r=Date.now(),i="singleClick";r-n.input.lastClick.time<500&&no(t,n.input.lastClick)&&!t[Zr]&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:r,x:t.clientX,y:t.clientY,type:i};let s=n.posAtCoords(Jt(t));s&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new lo(n,s,t,!!u)):(i=="doubleClick"?so:oo)(n,s.pos,s.inside,t)?t.preventDefault():me(n,"pointer"))};class lo{constructor(e,t,u,r){this.view=e,this.pos=t,this.event=u,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!u[Zr],this.allowDefault=u.shiftKey;let i,s;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),s=t.inside;else{let c=e.state.doc.resolve(t.pos);i=c.parent,s=c.depth?c.before():0}const o=r?null:u.target,a=o?e.docView.nearestDesc(o,!0):null;this.target=a&&a.dom.nodeType==1?a.dom:null;let{selection:l}=e.state;(u.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||l instanceof S&&l.from<=s&&l.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Wt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),me(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Vn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Jt(e))),this.updateAllowDefault(e),this.allowDefault||!t?me(this.view,"pointer"):io(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||_e&&this.mightDrag&&!this.mightDrag.node.isAtom||Ce&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(We(this.view,T.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):me(this.view,"pointer")}move(e){this.updateAllowDefault(e),me(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ne.touchstart=n=>{n.input.lastTouch=Date.now(),Wn(n),me(n,"pointer")};ne.touchmove=n=>{n.input.lastTouch=Date.now(),me(n,"pointer")};ne.contextmenu=n=>Wn(n);function ei(n,e){return n.composing?!0:_e&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const co=dt?5e3:-1;X.compositionstart=X.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof E&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(u=>u.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Pt(n,!0),n.markCursor=null;else if(Pt(n,!e.selection.empty),Wt&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let u=n.domSelectionRange();for(let r=u.focusNode,i=u.focusOffset;r&&r.nodeType==1&&i!=0;){let s=i<0?r.lastChild:r.childNodes[i-1];if(!s)break;if(s.nodeType==3){let o=n.domSelection();o&&o.collapse(s,s.nodeValue.length);break}else r=s,i=-1}}n.input.composing=!0}ti(n,co)};X.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,ti(n,20))};function ti(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Pt(n),e))}function fo(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=ho());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function ho(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Pt(n,e=!1){if(!(dt&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),fo(n),e||n.docView&&n.docView.dirty){let t=$s(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function po(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let u=getSelection(),r=document.createRange();r.selectNodeContents(e),n.dom.blur(),u.removeAllRanges(),u.addRange(r),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const ot=ct&&qr<15||qn&&zs<604;ne.copy=X.cut=(n,e)=>{let t=e,u=n.state.selection,r=t.type=="cut";if(u.empty)return;let i=ot?null:t.clipboardData,s=u.content(),{dom:o,text:a}=Jr(n,s);i?(t.preventDefault(),i.clearData(),i.setData("text/html",o.innerHTML),i.setData("text/plain",a)):po(n,o),r&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function mo(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function bo(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,u=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(u.contentEditable="true"),u.style.cssText="position: fixed; left: -10000px; top: 10px",u.focus();let r=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),u.parentNode&&u.parentNode.removeChild(u),t?On(n,u.value,null,r,e):On(n,u.textContent,u.innerHTML,r,e)},50)}function On(n,e,t,u,r){let i=Ur(n,e,t,u,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,r,i||w.empty)))return!0;if(!i)return!1;let s=mo(i),o=s?n.state.tr.replaceSelectionWith(s,u):n.state.tr.replaceSelection(i);return n.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function ni(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}X.paste=(n,e)=>{let t=e;if(n.composing&&!dt)return;let u=ot?null:t.clipboardData,r=n.input.shiftKey&&n.input.lastKeyCode!=45;u&&On(n,ni(u),u.getData("text/html"),r,t)?t.preventDefault():bo(n,t)};class go{constructor(e,t,u){this.slice=e,this.move=t,this.node=u}}const ui=Q?"altKey":"ctrlKey";ne.dragstart=(n,e)=>{let t=e,u=n.input.mouseDown;if(u&&u.done(),!t.dataTransfer)return;let r=n.state.selection,i=r.empty?null:n.posAtCoords(Jt(t)),s;if(!(i&&i.pos>=r.from&&i.pos<=(r instanceof S?r.to-1:r.to))){if(u&&u.mightDrag)s=S.create(n.state.doc,u.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let d=n.docView.nearestDesc(t.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&(s=S.create(n.state.doc,d.posBefore))}}let o=(s||n.state.selection).content(),{dom:a,text:l,slice:c}=Jr(n,o);(!t.dataTransfer.files.length||!Ce||Hr>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(ot?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",ot||t.dataTransfer.setData("text/plain",l),n.dragging=new go(c,!t[ui],s)};ne.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};X.dragover=X.dragenter=(n,e)=>e.preventDefault();X.drop=(n,e)=>{let t=e,u=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let r=n.posAtCoords(Jt(t));if(!r)return;let i=n.state.doc.resolve(r.pos),s=u&&u.slice;s?n.someProp("transformPasted",p=>{s=p(s,n)}):s=Ur(n,ni(t.dataTransfer),ot?null:t.dataTransfer.getData("text/html"),!1,i);let o=!!(u&&!t[ui]);if(n.someProp("handleDrop",p=>p(n,t,s||w.empty,o))){t.preventDefault();return}if(!s)return;t.preventDefault();let a=s?Dr(n.state.doc,i.pos,s):i.pos;a==null&&(a=i.pos);let l=n.state.tr;if(o){let{node:p}=u;p?p.replace(l):l.deleteSelection()}let c=l.mapping.map(a),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=l.doc;if(d?l.replaceRangeWith(c,c,s.content.firstChild):l.replaceRange(c,c,s),l.doc.eq(h))return;let f=l.doc.resolve(c);if(d&&S.isSelectable(s.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(s.content.firstChild))l.setSelection(new S(f));else{let p=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((m,b,g,k)=>p=k),l.setSelection(jr(n,f,l.doc.resolve(p)))}n.focus(),n.dispatch(l.setMeta("uiEvent","drop"))};ne.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Vn(n)},20))};ne.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};ne.beforeinput=(n,e)=>{if(Ce&&dt&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:u}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=u||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,_r(8,"Backspace")))))return;let{$cursor:r}=n.state.selection;r&&r.pos>0&&n.dispatch(n.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let n in X)ne[n]=X[n];function at(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Bt{constructor(e,t){this.toDOM=e,this.spec=t||Le,this.side=this.spec.side||0}map(e,t,u,r){let{pos:i,deleted:s}=e.mapResult(t.from+r,this.side<0?-1:1);return s?null:new oe(i-u,i-u,this)}valid(){return!0}eq(e){return this==e||e instanceof Bt&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&at(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class ye{constructor(e,t){this.attrs=e,this.spec=t||Le}map(e,t,u,r){let i=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-u,s=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-u;return i>=s?null:new oe(i,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof ye&&at(this.attrs,e.attrs)&&at(this.spec,e.spec)}static is(e){return e.type instanceof ye}destroy(){}}class Jn{constructor(e,t){this.attrs=e,this.spec=t||Le}map(e,t,u,r){let i=e.mapResult(t.from+r,1);if(i.deleted)return null;let s=e.mapResult(t.to+r,-1);return s.deleted||s.pos<=i.pos?null:new oe(i.pos-u,s.pos-u,this)}valid(e,t){let{index:u,offset:r}=e.content.findIndex(t.from),i;return r==t.from&&!(i=e.child(u)).isText&&r+i.nodeSize==t.to}eq(e){return this==e||e instanceof Jn&&at(this.attrs,e.attrs)&&at(this.spec,e.spec)}destroy(){}}class oe{constructor(e,t,u){this.from=e,this.to=t,this.type=u}copy(e,t){return new oe(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,u){return this.type.map(e,this,t,u)}static widget(e,t,u){return new oe(e,e,new Bt(t,u))}static inline(e,t,u,r){return new oe(e,t,new ye(u,r))}static node(e,t,u,r){return new oe(e,t,new Jn(u,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof ye}get widget(){return this.type instanceof Bt}}const He=[],Le={};class P{constructor(e,t){this.local=e.length?e:He,this.children=t.length?t:He}static create(e,t){return t.length?zt(t,e,0,Le):j}find(e,t,u){let r=[];return this.findInner(e??0,t??1e9,r,0,u),r}findInner(e,t,u,r,i){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=t&&o.to>=e&&(!i||i(o.spec))&&u.push(o.copy(o.from+r,o.to+r))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,t-o,u,r+o,i)}}map(e,t,u){return this==j||e.maps.length==0?this:this.mapInner(e,t,0,0,u||Le)}mapInner(e,t,u,r,i){let s;for(let o=0;o<this.local.length;o++){let a=this.local[o].map(e,u,r);a&&a.type.valid(t,a)?(s||(s=[])).push(a):i.onRemove&&i.onRemove(this.local[o].spec)}return this.children.length?yo(this.children,s||[],e,t,u,r,i):s?new P(s.sort(Pe),He):j}add(e,t){return t.length?this==j?P.create(e,t):this.addInner(e,t,0):this}addInner(e,t,u){let r,i=0;e.forEach((o,a)=>{let l=a+u,c;if(c=ii(t,o,l)){for(r||(r=this.children.slice());i<r.length&&r[i]<a;)i+=3;r[i]==a?r[i+2]=r[i+2].addInner(o,c,l+1):r.splice(i,0,a,a+o.nodeSize,zt(c,o,l+1,Le)),i+=3}});let s=ri(i?si(t):t,-u);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new P(s.length?this.local.concat(s).sort(Pe):this.local,r||this.children)}remove(e){return e.length==0||this==j?this:this.removeInner(e,0)}removeInner(e,t){let u=this.children,r=this.local;for(let i=0;i<u.length;i+=3){let s,o=u[i]+t,a=u[i+1]+t;for(let c=0,d;c<e.length;c++)(d=e[c])&&d.from>o&&d.to<a&&(e[c]=null,(s||(s=[])).push(d));if(!s)continue;u==this.children&&(u=this.children.slice());let l=u[i+2].removeInner(s,o+1);l!=j?u[i+2]=l:(u.splice(i,3),i-=3)}if(r.length){for(let i=0,s;i<e.length;i++)if(s=e[i])for(let o=0;o<r.length;o++)r[o].eq(s,t)&&(r==this.local&&(r=this.local.slice()),r.splice(o--,1))}return u==this.children&&r==this.local?this:r.length||u.length?new P(r,u):j}forChild(e,t){if(this==j)return this;if(t.isLeaf)return P.empty;let u,r;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(u=this.children[o+2]);break}let i=e+1,s=i+t.content.size;for(let o=0;o<this.local.length;o++){let a=this.local[o];if(a.from<s&&a.to>i&&a.type instanceof ye){let l=Math.max(i,a.from)-i,c=Math.min(s,a.to)-i;l<c&&(r||(r=[])).push(a.copy(l,c))}}if(r){let o=new P(r.sort(Pe),He);return u?new Ae([o,u]):o}return u||j}eq(e){if(this==e)return!0;if(!(e instanceof P)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Un(this.localsInner(e))}localsInner(e){if(this==j)return He;if(e.inlineContent||!this.local.some(ye.is))return this.local;let t=[];for(let u=0;u<this.local.length;u++)this.local[u].type instanceof ye||t.push(this.local[u]);return t}forEachSet(e){e(this)}}P.empty=new P([],[]);P.removeOverlap=Un;const j=P.empty;class Ae{constructor(e){this.members=e}map(e,t){const u=this.members.map(r=>r.map(e,t,Le));return Ae.from(u)}forChild(e,t){if(t.isLeaf)return P.empty;let u=[];for(let r=0;r<this.members.length;r++){let i=this.members[r].forChild(e,t);i!=j&&(i instanceof Ae?u=u.concat(i.members):u.push(i))}return Ae.from(u)}eq(e){if(!(e instanceof Ae)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,u=!0;for(let r=0;r<this.members.length;r++){let i=this.members[r].localsInner(e);if(i.length)if(!t)t=i;else{u&&(t=t.slice(),u=!1);for(let s=0;s<i.length;s++)t.push(i[s])}}return t?Un(u?t:t.sort(Pe)):He}static from(e){switch(e.length){case 0:return j;case 1:return e[0];default:return new Ae(e.every(t=>t instanceof P)?e:e.reduce((t,u)=>t.concat(u instanceof P?u:u.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function yo(n,e,t,u,r,i,s){let o=n.slice();for(let l=0,c=i;l<t.maps.length;l++){let d=0;t.maps[l].forEach((h,f,p,m)=>{let b=m-p-(f-h);for(let g=0;g<o.length;g+=3){let k=o[g+1];if(k<0||h>k+c-d)continue;let A=o[g]+c-d;f>=A?o[g+1]=h<=A?-2:-1:h>=c&&b&&(o[g]+=b,o[g+1]+=b)}d+=b}),c=t.maps[l].map(c,-1)}let a=!1;for(let l=0;l<o.length;l+=3)if(o[l+1]<0){if(o[l+1]==-2){a=!0,o[l+1]=-1;continue}let c=t.map(n[l]+i),d=c-r;if(d<0||d>=u.content.size){a=!0;continue}let h=t.map(n[l+1]+i,-1),f=h-r,{index:p,offset:m}=u.content.findIndex(d),b=u.maybeChild(p);if(b&&m==d&&m+b.nodeSize==f){let g=o[l+2].mapInner(t,b,c+1,n[l]+i+1,s);g!=j?(o[l]=d,o[l+1]=f,o[l+2]=g):(o[l+1]=-2,a=!0)}else a=!0}if(a){let l=xo(o,n,e,t,r,i,s),c=zt(l,u,0,s);e=c.local;for(let d=0;d<o.length;d+=3)o[d+1]<0&&(o.splice(d,3),d-=3);for(let d=0,h=0;d<c.children.length;d+=3){let f=c.children[d];for(;h<o.length&&o[h]<f;)h+=3;o.splice(h,0,c.children[d],c.children[d+1],c.children[d+2])}}return new P(e.sort(Pe),o)}function ri(n,e){if(!e||!n.length)return n;let t=[];for(let u=0;u<n.length;u++){let r=n[u];t.push(new oe(r.from+e,r.to+e,r.type))}return t}function xo(n,e,t,u,r,i,s){function o(a,l){for(let c=0;c<a.local.length;c++){let d=a.local[c].map(u,r,l);d?t.push(d):s.onRemove&&s.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)o(a.children[c+2],a.children[c]+l+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&o(n[a+2],e[a]+i+1);return t}function ii(n,e,t){if(e.isLeaf)return null;let u=t+e.nodeSize,r=null;for(let i=0,s;i<n.length;i++)(s=n[i])&&s.from>t&&s.to<u&&((r||(r=[])).push(s),n[i]=null);return r}function si(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function zt(n,e,t,u){let r=[],i=!1;e.forEach((o,a)=>{let l=ii(n,o,a+t);if(l){i=!0;let c=zt(l,o,t+a+1,u);c!=j&&r.push(a,a+o.nodeSize,c)}});let s=ri(i?si(n):n,-t).sort(Pe);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||(u.onRemove&&u.onRemove(s[o].spec),s.splice(o--,1));return s.length||r.length?new P(s,r):j}function Pe(n,e){return n.from-e.from||n.to-e.to}function Un(n){let e=n;for(let t=0;t<e.length-1;t++){let u=e[t];if(u.from!=u.to)for(let r=t+1;r<e.length;r++){let i=e[r];if(i.from==u.from){i.to!=u.to&&(e==n&&(e=n.slice()),e[r]=i.copy(i.from,u.to),_u(e,r+1,i.copy(u.to,i.to)));continue}else{i.from<u.to&&(e==n&&(e=n.slice()),e[t]=u.copy(u.from,i.from),_u(e,r,u.copy(i.from,u.to)));break}}}return e}function _u(n,e,t){for(;e<n.length&&Pe(t,n[e])>0;)e++;n.splice(e,0,t)}var xe={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},$t={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},ko=typeof navigator<"u"&&/Mac/.test(navigator.platform),wo=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var _=0;_<10;_++)xe[48+_]=xe[96+_]=String(_);for(var _=1;_<=24;_++)xe[_+111]="F"+_;for(var _=65;_<=90;_++)xe[_]=String.fromCharCode(_+32),$t[_]=String.fromCharCode(_);for(var an in xe)$t.hasOwnProperty(an)||($t[an]=xe[an]);function So(n){var e=ko&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||wo&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?$t:xe)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Eo=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Co(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let u,r,i,s;for(let o=0;o<e.length-1;o++){let a=e[o];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))u=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))i=!0;else if(/^mod$/i.test(a))Eo?s=!0:r=!0;else throw new Error("Unrecognized modifier name: "+a)}return u&&(t="Alt-"+t),r&&(t="Ctrl-"+t),s&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function To(n){let e=Object.create(null);for(let t in n)e[Co(t)]=n[t];return e}function ln(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function Ao(n){return new U({props:{handleKeyDown:oi(n)}})}function oi(n){let e=To(n);return function(t,u){let r=So(u),i,s=e[ln(r,u)];if(s&&s(t.state,t.dispatch,t))return!0;if(r.length==1&&r!=" "){if(u.shiftKey){let o=e[ln(r,u,!1)];if(o&&o(t.state,t.dispatch,t))return!0}if((u.shiftKey||u.altKey||u.metaKey||r.charCodeAt(0)>127)&&(i=xe[u.keyCode])&&i!=r){let o=e[ln(i,u)];if(o&&o(t.state,t.dispatch,t))return!0}}return!1}}const Kn=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function ai(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const li=(n,e,t)=>{let u=ai(n,t);if(!u)return!1;let r=Gn(u);if(!r){let s=u.blockRange(),o=s&&Ye(s);return o==null?!1:(e&&e(n.tr.lift(s,o).scrollIntoView()),!0)}let i=r.nodeBefore;if(yi(n,r,e,-1))return!0;if(u.parent.content.size==0&&(Je(i,"end")||S.isSelectable(i)))for(let s=u.depth;;s--){let o=$n(n.doc,u.before(s),u.after(s),w.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Je(i,"end")?T.findFrom(a.doc.resolve(a.mapping.map(r.pos,-1)),-1):S.create(a.doc,r.pos-i.nodeSize)),e(a.scrollIntoView())}return!0}if(s==1||u.node(s-1).childCount>1)break}return i.isAtom&&r.depth==u.depth-1?(e&&e(n.tr.delete(r.pos-i.nodeSize,r.pos).scrollIntoView()),!0):!1},Mo=(n,e,t)=>{let u=ai(n,t);if(!u)return!1;let r=Gn(u);return r?ci(n,r,e):!1},No=(n,e,t)=>{let u=fi(n,t);if(!u)return!1;let r=Yn(u);return r?ci(n,r,e):!1};function ci(n,e,t){let u=e.nodeBefore,r=u,i=e.pos-1;for(;!r.isTextblock;i--){if(r.type.spec.isolating)return!1;let c=r.lastChild;if(!c)return!1;r=c}let s=e.nodeAfter,o=s,a=e.pos+1;for(;!o.isTextblock;a++){if(o.type.spec.isolating)return!1;let c=o.firstChild;if(!c)return!1;o=c}let l=$n(n.doc,i,a,w.empty);if(!l||l.from!=i||l instanceof K&&l.slice.size>=a-i)return!1;if(t){let c=n.tr.step(l);c.setSelection(E.create(c.doc,i)),t(c.scrollIntoView())}return!0}function Je(n,e,t=!1){for(let u=n;u;u=e=="start"?u.firstChild:u.lastChild){if(u.isTextblock)return!0;if(t&&u.childCount!=1)return!1}return!1}const di=(n,e,t)=>{let{$head:u,empty:r}=n.selection,i=u;if(!r)return!1;if(u.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):u.parentOffset>0)return!1;i=Gn(u)}let s=i&&i.nodeBefore;return!s||!S.isSelectable(s)?!1:(e&&e(n.tr.setSelection(S.create(n.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function Gn(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function fi(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const hi=(n,e,t)=>{let u=fi(n,t);if(!u)return!1;let r=Yn(u);if(!r)return!1;let i=r.nodeAfter;if(yi(n,r,e,1))return!0;if(u.parent.content.size==0&&(Je(i,"start")||S.isSelectable(i))){let s=$n(n.doc,u.before(),u.after(),w.empty);if(s&&s.slice.size<s.to-s.from){if(e){let o=n.tr.step(s);o.setSelection(Je(i,"start")?T.findFrom(o.doc.resolve(o.mapping.map(r.pos)),1):S.create(o.doc,o.mapping.map(r.pos))),e(o.scrollIntoView())}return!0}}return i.isAtom&&r.depth==u.depth-1?(e&&e(n.tr.delete(r.pos,r.pos+i.nodeSize).scrollIntoView()),!0):!1},pi=(n,e,t)=>{let{$head:u,empty:r}=n.selection,i=u;if(!r)return!1;if(u.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):u.parentOffset<u.parent.content.size)return!1;i=Yn(u)}let s=i&&i.nodeAfter;return!s||!S.isSelectable(s)?!1:(e&&e(n.tr.setSelection(S.create(n.doc,i.pos)).scrollIntoView()),!0)};function Yn(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const vo=(n,e)=>{let t=n.selection,u=t instanceof S,r;if(u){if(t.node.isTextblock||!Se(n.doc,t.from))return!1;r=t.from}else if(r=Vt(n.doc,t.from,-1),r==null)return!1;if(e){let i=n.tr.join(r);u&&i.setSelection(S.create(i.doc,r-n.doc.resolve(r).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},Oo=(n,e)=>{let t=n.selection,u;if(t instanceof S){if(t.node.isTextblock||!Se(n.doc,t.to))return!1;u=t.to}else if(u=Vt(n.doc,t.to,1),u==null)return!1;return e&&e(n.tr.join(u).scrollIntoView()),!0},Io=(n,e)=>{let{$from:t,$to:u}=n.selection,r=t.blockRange(u),i=r&&Ye(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)},mi=(n,e)=>{let{$head:t,$anchor:u}=n.selection;return!t.parent.type.spec.code||!t.sameParent(u)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Xn(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const Ro=(n,e)=>{let{$head:t,$anchor:u}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(u))return!1;let r=t.node(-1),i=t.indexAfter(-1),s=Xn(r.contentMatchAt(i));if(!s||!r.canReplaceWith(i,i,s))return!1;if(e){let o=t.after(),a=n.tr.replaceWith(o,o,s.createAndFill());a.setSelection(T.near(a.doc.resolve(o),1)),e(a.scrollIntoView())}return!0},bi=(n,e)=>{let t=n.selection,{$from:u,$to:r}=t;if(t instanceof Y||u.parent.inlineContent||r.parent.inlineContent)return!1;let i=Xn(r.parent.contentMatchAt(r.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let s=(!u.parentOffset&&r.index()<r.parent.childCount?u:r).pos,o=n.tr.insert(s,i.createAndFill());o.setSelection(E.create(o.doc,s+1)),e(o.scrollIntoView())}return!0},gi=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(ce(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let u=t.blockRange(),r=u&&Ye(u);return r==null?!1:(e&&e(n.tr.lift(u,r).scrollIntoView()),!0)};function Do(n){return(e,t)=>{let{$from:u,$to:r}=e.selection;if(e.selection instanceof S&&e.selection.node.isBlock)return!u.parentOffset||!ce(e.doc,u.pos)?!1:(t&&t(e.tr.split(u.pos).scrollIntoView()),!0);if(!u.depth)return!1;let i=[],s,o,a=!1,l=!1;for(let f=u.depth;;f--)if(u.node(f).isBlock){a=u.end(f)==u.pos+(u.depth-f),l=u.start(f)==u.pos-(u.depth-f),o=Xn(u.node(f-1).contentMatchAt(u.indexAfter(f-1))),i.unshift(a&&o?{type:o}:null),s=f;break}else{if(f==1)return!1;i.unshift(null)}let c=e.tr;(e.selection instanceof E||e.selection instanceof Y)&&c.deleteSelection();let d=c.mapping.map(u.pos),h=ce(c.doc,d,i.length,i);if(h||(i[0]=o?{type:o}:null,h=ce(c.doc,d,i.length,i)),c.split(d,i.length,i),!a&&l&&u.node(s).type!=o){let f=c.mapping.map(u.before(s)),p=c.doc.resolve(f);o&&u.node(s-1).canReplaceWith(p.index(),p.index()+1,o)&&c.setNodeMarkup(c.mapping.map(u.before(s)),o)}return t&&t(c.scrollIntoView()),!0}}const Lo=Do(),Po=(n,e)=>{let{$from:t,to:u}=n.selection,r,i=t.sharedDepth(u);return i==0?!1:(r=t.before(i),e&&e(n.tr.setSelection(S.create(n.doc,r))),!0)};function Bo(n,e,t){let u=e.nodeBefore,r=e.nodeAfter,i=e.index();return!u||!r||!u.type.compatibleContent(r.type)?!1:!u.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-u.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(r.isTextblock||Se(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function yi(n,e,t,u){let r=e.nodeBefore,i=e.nodeAfter,s,o,a=r.type.spec.isolating||i.type.spec.isolating;if(!a&&Bo(n,e,t))return!0;let l=!a&&e.parent.canReplace(e.index(),e.index()+1);if(l&&(s=(o=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(t){let f=e.pos+i.nodeSize,p=y.empty;for(let g=s.length-1;g>=0;g--)p=y.from(s[g].create(null,p));p=y.from(r.copy(p));let m=n.tr.step(new J(e.pos-1,f,e.pos,f,new w(p,1,0),s.length,!0)),b=m.doc.resolve(f+2*s.length);b.nodeAfter&&b.nodeAfter.type==r.type&&Se(m.doc,b.pos)&&m.join(b.pos),t(m.scrollIntoView())}return!0}let c=i.type.spec.isolating||u>0&&a?null:T.findFrom(e,1),d=c&&c.$from.blockRange(c.$to),h=d&&Ye(d);if(h!=null&&h>=e.depth)return t&&t(n.tr.lift(d,h).scrollIntoView()),!0;if(l&&Je(i,"start",!0)&&Je(r,"end")){let f=r,p=[];for(;p.push(f),!f.isTextblock;)f=f.lastChild;let m=i,b=1;for(;!m.isTextblock;m=m.firstChild)b++;if(f.canReplace(f.childCount,f.childCount,m.content)){if(t){let g=y.empty;for(let A=p.length-1;A>=0;A--)g=y.from(p[A].copy(g));let k=n.tr.step(new J(e.pos-p.length,e.pos+i.nodeSize,e.pos+b,e.pos+i.nodeSize-b,new w(g,p.length,0),0,!0));t(k.scrollIntoView())}return!0}}return!1}function xi(n){return function(e,t){let u=e.selection,r=n<0?u.$from:u.$to,i=r.depth;for(;r.node(i).isInline;){if(!i)return!1;i--}return r.node(i).isTextblock?(t&&t(e.tr.setSelection(E.create(e.doc,n<0?r.start(i):r.end(i)))),!0):!1}}const zo=xi(-1),$o=xi(1);function _o(n,e=null){return function(t,u){let{$from:r,$to:i}=t.selection,s=r.blockRange(i),o=s&&zn(s,n,e);return o?(u&&u(t.tr.wrap(s,o).scrollIntoView()),!0):!1}}function Fu(n,e=null){return function(t,u){let r=!1;for(let i=0;i<t.selection.ranges.length&&!r;i++){let{$from:{pos:s},$to:{pos:o}}=t.selection.ranges[i];t.doc.nodesBetween(s,o,(a,l)=>{if(r)return!1;if(!(!a.isTextblock||a.hasMarkup(n,e)))if(a.type==n)r=!0;else{let c=t.doc.resolve(l),d=c.index();r=c.parent.canReplaceWith(d,d+1,n)}})}if(!r)return!1;if(u){let i=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[s];i.setBlockType(o,a,n,e)}u(i.scrollIntoView())}return!0}}function Qn(...n){return function(e,t,u){for(let r=0;r<n.length;r++)if(n[r](e,t,u))return!0;return!1}}Qn(Kn,li,di);Qn(Kn,hi,pi);Qn(mi,bi,gi,Lo);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Fo(n,e=null){return function(t,u){let{$from:r,$to:i}=t.selection,s=r.blockRange(i);if(!s)return!1;let o=u?t.tr:null;return qo(o,s,n,e)?(u&&u(o.scrollIntoView()),!0):!1}}function qo(n,e,t,u=null){let r=!1,i=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let a=s.resolve(e.start-2);i=new vt(a,a,e.depth),e.endIndex<e.parent.childCount&&(e=new vt(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),r=!0}let o=zn(i,t,u,e);return o?(n&&Ho(n,e,o,r,t),!0):!1}function Ho(n,e,t,u,r){let i=y.empty;for(let c=t.length-1;c>=0;c--)i=y.from(t[c].type.create(t[c].attrs,i));n.step(new J(e.start-(u?2:0),e.end,e.start,e.end,new w(i,0,0),t.length,!0));let s=0;for(let c=0;c<t.length;c++)t[c].type==r&&(s=c+1);let o=t.length-s,a=e.start+t.length-(u?2:0),l=e.parent;for(let c=e.startIndex,d=e.endIndex,h=!0;c<d;c++,h=!1)!h&&ce(n.doc,a,o)&&(n.split(a,o),a+=2*o),a+=l.child(c).nodeSize;return n}function Vo(n){return function(e,t){let{$from:u,$to:r}=e.selection,i=u.blockRange(r,s=>s.childCount>0&&s.firstChild.type==n);return i?t?u.node(i.depth-1).type==n?jo(e,t,n,i):Wo(e,t,i):!0:!1}}function jo(n,e,t,u){let r=n.tr,i=u.end,s=u.$to.end(u.depth);i<s&&(r.step(new J(i-1,s,i,s,new w(y.from(t.create(null,u.parent.copy())),1,0),1,!0)),u=new vt(r.doc.resolve(u.$from.pos),r.doc.resolve(s),u.depth));const o=Ye(u);if(o==null)return!1;r.lift(u,o);let a=r.doc.resolve(r.mapping.map(i,-1)-1);return Se(r.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&r.join(a.pos),e(r.scrollIntoView()),!0}function Wo(n,e,t){let u=n.tr,r=t.parent;for(let f=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)f-=r.child(p).nodeSize,u.delete(f-1,f+1);let i=u.doc.resolve(t.start),s=i.nodeAfter;if(u.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let o=t.startIndex==0,a=t.endIndex==r.childCount,l=i.node(-1),c=i.index(-1);if(!l.canReplace(c+(o?0:1),c+1,s.content.append(a?y.empty:y.from(r))))return!1;let d=i.pos,h=d+s.nodeSize;return u.step(new J(d-(o?1:0),h+(a?1:0),d+1,h-1,new w((o?y.empty:y.from(r.copy(y.empty))).append(a?y.empty:y.from(r.copy(y.empty))),o?0:1,a?0:1),o?0:1)),e(u.scrollIntoView()),!0}function Jo(n){return function(e,t){let{$from:u,$to:r}=e.selection,i=u.blockRange(r,l=>l.childCount>0&&l.firstChild.type==n);if(!i)return!1;let s=i.startIndex;if(s==0)return!1;let o=i.parent,a=o.child(s-1);if(a.type!=n)return!1;if(t){let l=a.lastChild&&a.lastChild.type==o.type,c=y.from(l?n.create():null),d=new w(y.from(n.create(null,y.from(o.type.create(null,c)))),l?3:1,0),h=i.start,f=i.end;t(e.tr.step(new J(h-(l?3:1),f,h,f,d,1,!0)).scrollIntoView())}return!0}}function Ut(n){const{state:e,transaction:t}=n;let{selection:u}=t,{doc:r}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return u},get doc(){return r},get tr(){return u=t.selection,r=t.doc,i=t.storedMarks,t}}}class Zn{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:u}=this,{view:r}=t,{tr:i}=u,s=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([o,a])=>[o,(...c)=>{const d=a(...c)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:u,editor:r,state:i}=this,{view:s}=r,o=[],a=!!e,l=e||i.tr,c=()=>(!a&&t&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(l),o.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(u).map(([h,f])=>[h,(...m)=>{const b=this.buildProps(l,t),g=f(...m)(b);return o.push(g),d}])),run:c};return d}createCan(e){const{rawCommands:t,state:u}=this,r=!1,i=e||u.tr,s=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...c)=>l(...c)({...s,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(e,t=!0){const{rawCommands:u,editor:r,state:i}=this,{view:s}=r,o={tr:e,editor:r,view:s,state:Ut({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(u).map(([a,l])=>[a,(...c)=>l(...c)(o)]))}};return o}}function x(n,e,t){return n.config[e]===void 0&&n.parent?x(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?x(n.parent,e,t):null}):n.config[e]}function Kt(n){const e=n.filter(r=>r.type==="extension"),t=n.filter(r=>r.type==="node"),u=n.filter(r=>r.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:u}}function ki(n){const e=[],{nodeExtensions:t,markExtensions:u}=Kt(n),r=[...t,...u],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage,extensions:r},a=x(s,"addGlobalAttributes",o);if(!a)return;a().forEach(c=>{c.types.forEach(d=>{Object.entries(c.attributes).forEach(([h,f])=>{e.push({type:d,name:h,attribute:{...i,...f}})})})})}),r.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage},a=x(s,"addAttributes",o);if(!a)return;const l=a();Object.entries(l).forEach(([c,d])=>{const h={...i,...d};typeof h?.default=="function"&&(h.default=h.default()),h?.isRequired&&h?.default===void 0&&delete h.default,e.push({type:s.name,name:c,attribute:h})})}),e}function F(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function q(...n){return n.filter(e=>!!e).reduce((e,t)=>{const u={...e};return Object.entries(t).forEach(([r,i])=>{if(!u[r]){u[r]=i;return}if(r==="class"){const o=i?String(i).split(" "):[],a=u[r]?u[r].split(" "):[],l=o.filter(c=>!a.includes(c));u[r]=[...a,...l].join(" ")}else if(r==="style"){const o=i?i.split(";").map(c=>c.trim()).filter(Boolean):[],a=u[r]?u[r].split(";").map(c=>c.trim()).filter(Boolean):[],l=new Map;a.forEach(c=>{const[d,h]=c.split(":").map(f=>f.trim());l.set(d,h)}),o.forEach(c=>{const[d,h]=c.split(":").map(f=>f.trim());l.set(d,h)}),u[r]=Array.from(l.entries()).map(([c,d])=>`${c}: ${d}`).join("; ")}else u[r]=i}),u},{})}function In(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,u)=>q(t,u),{})}function Uo(n){return typeof n=="function"}function C(n,e=void 0,...t){return Uo(n)?e?n.bind(e)(...t):n(...t):n}function Ko(n={}){return Object.keys(n).length===0&&n.constructor===Object}function Go(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function qu(n,e){return"style"in n?n:{...n,getAttrs:t=>{const u=n.getAttrs?n.getAttrs(t):n.attrs;if(u===!1)return!1;const r=e.reduce((i,s)=>{const o=s.attribute.parseHTML?s.attribute.parseHTML(t):Go(t.getAttribute(s.name));return o==null?i:{...i,[s.name]:o}},{});return{...u,...r}}}}function Hu(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&Ko(t)?!1:t!=null))}function wi(n,e){var t;const u=ki(n),{nodeExtensions:r,markExtensions:i}=Kt(n),s=(t=r.find(l=>x(l,"topNode")))===null||t===void 0?void 0:t.name,o=Object.fromEntries(r.map(l=>{const c=u.filter(g=>g.type===l.name),d={name:l.name,options:l.options,storage:l.storage,editor:e},h=n.reduce((g,k)=>{const A=x(k,"extendNodeSchema",d);return{...g,...A?A(l):{}}},{}),f=Hu({...h,content:C(x(l,"content",d)),marks:C(x(l,"marks",d)),group:C(x(l,"group",d)),inline:C(x(l,"inline",d)),atom:C(x(l,"atom",d)),selectable:C(x(l,"selectable",d)),draggable:C(x(l,"draggable",d)),code:C(x(l,"code",d)),whitespace:C(x(l,"whitespace",d)),linebreakReplacement:C(x(l,"linebreakReplacement",d)),defining:C(x(l,"defining",d)),isolating:C(x(l,"isolating",d)),attrs:Object.fromEntries(c.map(g=>{var k;return[g.name,{default:(k=g?.attribute)===null||k===void 0?void 0:k.default}]}))}),p=C(x(l,"parseHTML",d));p&&(f.parseDOM=p.map(g=>qu(g,c)));const m=x(l,"renderHTML",d);m&&(f.toDOM=g=>m({node:g,HTMLAttributes:In(g,c)}));const b=x(l,"renderText",d);return b&&(f.toText=b),[l.name,f]})),a=Object.fromEntries(i.map(l=>{const c=u.filter(b=>b.type===l.name),d={name:l.name,options:l.options,storage:l.storage,editor:e},h=n.reduce((b,g)=>{const k=x(g,"extendMarkSchema",d);return{...b,...k?k(l):{}}},{}),f=Hu({...h,inclusive:C(x(l,"inclusive",d)),excludes:C(x(l,"excludes",d)),group:C(x(l,"group",d)),spanning:C(x(l,"spanning",d)),code:C(x(l,"code",d)),attrs:Object.fromEntries(c.map(b=>{var g;return[b.name,{default:(g=b?.attribute)===null||g===void 0?void 0:g.default}]}))}),p=C(x(l,"parseHTML",d));p&&(f.parseDOM=p.map(b=>qu(b,c)));const m=x(l,"renderHTML",d);return m&&(f.toDOM=b=>m({mark:b,HTMLAttributes:In(b,c)})),[l.name,f]}));return new Cr({topNode:s,nodes:o,marks:a})}function cn(n,e){return e.nodes[n]||e.marks[n]||null}function Vu(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function Si(n,e){const t=Ge.fromSchema(e).serializeFragment(n),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(t),r.innerHTML}const Yo=(n,e=500)=>{let t="";const u=n.parentOffset;return n.parent.nodesBetween(Math.max(0,u-e),u,(r,i,s,o)=>{var a,l;const c=((l=(a=r.type.spec).toText)===null||l===void 0?void 0:l.call(a,{node:r,pos:i,parent:s,index:o}))||r.textContent||"%leaf%";t+=r.isAtom&&!r.isText?c:c.slice(0,Math.max(0,u-i))}),t};function eu(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Gt{constructor(e){this.find=e.find,this.handler=e.handler}}const Xo=(n,e)=>{if(eu(e))return e.exec(n);const t=e(n);if(!t)return null;const u=[t.text];return u.index=t.index,u.input=n,u.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),u.push(t.replaceWith)),u};function mt(n){var e;const{editor:t,from:u,to:r,text:i,rules:s,plugin:o}=n,{view:a}=t;if(a.composing)return!1;const l=a.state.doc.resolve(u);if(l.parent.type.spec.code||!((e=l.nodeBefore||l.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let c=!1;const d=Yo(l)+i;return s.forEach(h=>{if(c)return;const f=Xo(d,h.find);if(!f)return;const p=a.state.tr,m=Ut({state:a.state,transaction:p}),b={from:u-(f[0].length-i.length),to:r},{commands:g,chain:k,can:A}=new Zn({editor:t,state:m});h.handler({state:m,range:b,match:f,commands:g,chain:k,can:A})===null||!p.steps.length||(p.setMeta(o,{transform:p,from:u,to:r,text:i}),a.dispatch(p),c=!0)}),c}function Qo(n){const{editor:e,rules:t}=n,u=new U({state:{init(){return null},apply(r,i,s){const o=r.getMeta(u);if(o)return o;const a=r.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:c}=a;typeof c=="string"?c=c:c=Si(y.from(c),s.schema);const{from:d}=a,h=d+c.length;mt({editor:e,from:d,to:h,text:c,rules:t,plugin:u})}),r.selectionSet||r.docChanged?null:i}},props:{handleTextInput(r,i,s,o){return mt({editor:e,from:i,to:s,text:o,rules:t,plugin:u})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:i}=r.state.selection;i&&mt({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:u})}),!1)},handleKeyDown(r,i){if(i.key!=="Enter")return!1;const{$cursor:s}=r.state.selection;return s?mt({editor:e,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:u}):!1}},isInputRules:!0});return u}function Zo(n){return Object.prototype.toString.call(n).slice(8,-1)}function bt(n){return Zo(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Yt(n,e){const t={...n};return bt(n)&&bt(e)&&Object.keys(e).forEach(u=>{bt(e[u])&&bt(n[u])?t[u]=Yt(n[u],e[u]):t[u]=e[u]}),t}class ke{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=C(x(this,"addOptions",{name:this.name}))),this.storage=C(x(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new ke(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Yt(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new ke(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=C(x(t,"addOptions",{name:t.name})),t.storage=C(x(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:u}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){const s=r.marks();if(!!!s.find(l=>l?.type.name===t.name))return!1;const a=s.find(l=>l?.type.name===t.name);return a&&u.removeStoredMark(a),u.insertText(" ",r.pos),e.view.dispatch(u),!0}return!1}}function ea(n){return typeof n=="number"}class ta{constructor(e){this.find=e.find,this.handler=e.handler}}const na=(n,e,t)=>{if(eu(e))return[...n.matchAll(e)];const u=e(n,t);return u?u.map(r=>{const i=[r.text];return i.index=r.index,i.input=n,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]};function ua(n){const{editor:e,state:t,from:u,to:r,rule:i,pasteEvent:s,dropEvent:o}=n,{commands:a,chain:l,can:c}=new Zn({editor:e,state:t}),d=[];return t.doc.nodesBetween(u,r,(f,p)=>{if(!f.isTextblock||f.type.spec.code)return;const m=Math.max(u,p),b=Math.min(r,p+f.content.size),g=f.textBetween(m-p,b-p,void 0,"");na(g,i.find,s).forEach(A=>{if(A.index===void 0)return;const R=m+A.index+1,M=R+A[0].length,O={from:t.tr.mapping.map(R),to:t.tr.mapping.map(M)},ue=i.handler({state:t,range:O,match:A,commands:a,chain:l,can:c,pasteEvent:s,dropEvent:o});d.push(ue)})}),d.every(f=>f!==null)}let gt=null;const ra=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function ia(n){const{editor:e,rules:t}=n;let u=null,r=!1,i=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const a=({state:c,from:d,to:h,rule:f,pasteEvt:p})=>{const m=c.tr,b=Ut({state:c,transaction:m});if(!(!ua({editor:e,state:b,from:Math.max(d-1,0),to:h.b-1,rule:f,pasteEvent:p,dropEvent:o})||!m.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return t.map(c=>new U({view(d){const h=p=>{var m;u=!((m=d.dom.parentElement)===null||m===void 0)&&m.contains(p.target)?d.dom.parentElement:null,u&&(gt=e)},f=()=>{gt&&(gt=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",f),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",f)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(i=u===d.dom.parentElement,o=h,!i){const f=gt;f&&setTimeout(()=>{const p=f.state.selection;p&&f.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(d,h)=>{var f;const p=(f=h.clipboardData)===null||f===void 0?void 0:f.getData("text/html");return s=h,r=!!p?.includes("data-pm-slice"),!1}}},appendTransaction:(d,h,f)=>{const p=d[0],m=p.getMeta("uiEvent")==="paste"&&!r,b=p.getMeta("uiEvent")==="drop"&&!i,g=p.getMeta("applyPasteRules"),k=!!g;if(!m&&!b&&!k)return;if(k){let{text:M}=g;typeof M=="string"?M=M:M=Si(y.from(M),f.schema);const{from:O}=g,ue=O+M.length,re=ra(M);return a({rule:c,state:f,from:O,to:{b:ue},pasteEvt:re})}const A=h.doc.content.findDiffStart(f.doc.content),R=h.doc.content.findDiffEnd(f.doc.content);if(!(!ea(A)||!R||A===R.b))return a({rule:c,state:f,from:A,to:R,pasteEvt:s})}}))}function sa(n){const e=n.filter((t,u)=>n.indexOf(t)!==u);return Array.from(new Set(e))}class Ve{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Ve.resolve(e),this.schema=wi(this.extensions,t),this.setupExtensions()}static resolve(e){const t=Ve.sort(Ve.flatten(e)),u=sa(t.map(r=>r.name));return u.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${u.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const u={name:t.name,options:t.options,storage:t.storage},r=x(t,"addExtensions",u);return r?[t,...this.flatten(r())]:t}).flat(10)}static sort(e){return e.sort((u,r)=>{const i=x(u,"priority")||100,s=x(r,"priority")||100;return i>s?-1:i<s?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const u={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:cn(t.name,this.schema)},r=x(t,"addCommands",u);return r?{...e,...r()}:e},{})}get plugins(){const{editor:e}=this,t=Ve.sort([...this.extensions].reverse()),u=[],r=[],i=t.map(s=>{const o={name:s.name,options:s.options,storage:s.storage,editor:e,type:cn(s.name,this.schema)},a=[],l=x(s,"addKeyboardShortcuts",o);let c={};if(s.type==="mark"&&x(s,"exitable",o)&&(c.ArrowRight=()=>ke.handleExit({editor:e,mark:s})),l){const m=Object.fromEntries(Object.entries(l()).map(([b,g])=>[b,()=>g({editor:e})]));c={...c,...m}}const d=Ao(c);a.push(d);const h=x(s,"addInputRules",o);Vu(s,e.options.enableInputRules)&&h&&u.push(...h());const f=x(s,"addPasteRules",o);Vu(s,e.options.enablePasteRules)&&f&&r.push(...f());const p=x(s,"addProseMirrorPlugins",o);if(p){const m=p();a.push(...m)}return a}).flat();return[Qo({editor:e,rules:u}),...ia({editor:e,rules:r}),...i]}get attributes(){return ki(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Kt(this.extensions);return Object.fromEntries(t.filter(u=>!!x(u,"addNodeView")).map(u=>{const r=this.attributes.filter(a=>a.type===u.name),i={name:u.name,options:u.options,storage:u.storage,editor:e,type:F(u.name,this.schema)},s=x(u,"addNodeView",i);if(!s)return[];const o=(a,l,c,d,h)=>{const f=In(a,r);return s()({node:a,view:l,getPos:c,decorations:d,innerDecorations:h,editor:e,extension:u,HTMLAttributes:f})};return[u.name,o]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const u={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:cn(e.name,this.schema)};e.type==="mark"&&(!((t=C(x(e,"keepOnSplit",u)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const r=x(e,"onBeforeCreate",u),i=x(e,"onCreate",u),s=x(e,"onUpdate",u),o=x(e,"onSelectionUpdate",u),a=x(e,"onTransaction",u),l=x(e,"onFocus",u),c=x(e,"onBlur",u),d=x(e,"onDestroy",u);r&&this.editor.on("beforeCreate",r),i&&this.editor.on("create",i),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}}class W{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=C(x(this,"addOptions",{name:this.name}))),this.storage=C(x(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new W(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Yt(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new W({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=C(x(t,"addOptions",{name:t.name})),t.storage=C(x(t,"addStorage",{name:t.name,options:t.options})),t}}function oa(n,e,t){const{from:u,to:r}=e,{blockSeparator:i=`

`,textSerializers:s={}}=t||{};let o="";return n.nodesBetween(u,r,(a,l,c,d)=>{var h;a.isBlock&&l>u&&(o+=i);const f=s?.[a.type.name];if(f)return c&&(o+=f({node:a,pos:l,parent:c,index:d,range:e})),!1;a.isText&&(o+=(h=a?.text)===null||h===void 0?void 0:h.slice(Math.max(u,l)-l,r-l))}),o}function aa(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}W.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new U({key:new le("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:u,selection:r}=e,{ranges:i}=r,s=Math.min(...i.map(c=>c.$from.pos)),o=Math.max(...i.map(c=>c.$to.pos)),a=aa(t);return oa(u,{from:s,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}});const la=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),ca=(n=!1)=>({commands:e})=>e.setContent("",n),da=()=>({state:n,tr:e,dispatch:t})=>{const{selection:u}=e,{ranges:r}=u;return t&&r.forEach(({$from:i,$to:s})=>{n.doc.nodesBetween(i.pos,s.pos,(o,a)=>{if(o.type.isText)return;const{doc:l,mapping:c}=e,d=l.resolve(c.map(a)),h=l.resolve(c.map(a+o.nodeSize)),f=d.blockRange(h);if(!f)return;const p=Ye(f);if(o.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(f.start,m)}(p||p===0)&&e.lift(f,p)})}),!0},fa=n=>e=>n(e),ha=()=>({state:n,dispatch:e})=>bi(n,e),pa=(n,e)=>({editor:t,tr:u})=>{const{state:r}=t,i=r.doc.slice(n.from,n.to);u.deleteRange(n.from,n.to);const s=u.mapping.map(e);return u.insert(s,i.content),u.setSelection(new E(u.doc.resolve(s-1))),!0},ma=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,u=t.$anchor.node();if(u.content.size>0)return!1;const r=n.selection.$anchor;for(let i=r.depth;i>0;i-=1)if(r.node(i).type===u.type){if(e){const o=r.before(i),a=r.after(i);n.delete(o,a).scrollIntoView()}return!0}return!1},ba=n=>({tr:e,state:t,dispatch:u})=>{const r=F(n,t.schema),i=e.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r){if(u){const a=i.before(s),l=i.after(s);e.delete(a,l).scrollIntoView()}return!0}return!1},ga=n=>({tr:e,dispatch:t})=>{const{from:u,to:r}=n;return t&&e.delete(u,r),!0},ya=()=>({state:n,dispatch:e})=>Kn(n,e),xa=()=>({commands:n})=>n.keyboardShortcut("Enter"),ka=()=>({state:n,dispatch:e})=>Ro(n,e);function _t(n,e,t={strict:!0}){const u=Object.keys(e);return u.length?u.every(r=>t.strict?e[r]===n[r]:eu(e[r])?e[r].test(n[r]):e[r]===n[r]):!0}function Ei(n,e,t={}){return n.find(u=>u.type===e&&_t(Object.fromEntries(Object.keys(t).map(r=>[r,u.attrs[r]])),t))}function ju(n,e,t={}){return!!Ei(n,e,t)}function tu(n,e,t){var u;if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if((!r.node||!r.node.marks.some(c=>c.type===e))&&(r=n.parent.childBefore(n.parentOffset)),!r.node||!r.node.marks.some(c=>c.type===e)||(t=t||((u=r.node.marks[0])===null||u===void 0?void 0:u.attrs),!Ei([...r.node.marks],e,t)))return;let s=r.index,o=n.start()+r.offset,a=s+1,l=o+r.node.nodeSize;for(;s>0&&ju([...n.parent.child(s-1).marks],e,t);)s-=1,o-=n.parent.child(s).nodeSize;for(;a<n.parent.childCount&&ju([...n.parent.child(a).marks],e,t);)l+=n.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function Te(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const wa=(n,e={})=>({tr:t,state:u,dispatch:r})=>{const i=Te(n,u.schema),{doc:s,selection:o}=t,{$from:a,from:l,to:c}=o;if(r){const d=tu(a,i,e);if(d&&d.from<=l&&d.to>=c){const h=E.create(s,d.from,d.to);t.setSelection(h)}}return!0},Sa=n=>e=>{const t=typeof n=="function"?n(e):n;for(let u=0;u<t.length;u+=1)if(t[u](e))return!0;return!1};function Ci(n){return n instanceof E}function Oe(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function Ea(n,e=null){if(!e)return null;const t=T.atStart(n),u=T.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return u;const r=t.from,i=u.to;return e==="all"?E.create(n,Oe(0,r,i),Oe(n.content.size,r,i)):E.create(n,Oe(e,r,i),Oe(e,r,i))}function Ca(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function nu(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Ta=(n=null,e={})=>({editor:t,view:u,tr:r,dispatch:i})=>{e={scrollIntoView:!0,...e};const s=()=>{(nu()||Ca())&&u.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(u.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};if(u.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!Ci(t.state.selection))return s(),!0;const o=Ea(r.doc,n)||t.state.selection,a=t.state.selection.eq(o);return i&&(a||r.setSelection(o),a&&r.storedMarks&&r.setStoredMarks(r.storedMarks),s()),!0},Aa=(n,e)=>t=>n.every((u,r)=>e(u,{...t,index:r})),Ma=(n,e)=>({tr:t,commands:u})=>u.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),Ti=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const u=e[t];u.nodeType===3&&u.nodeValue&&/^(\n\s\s|\n)$/.test(u.nodeValue)?n.removeChild(u):u.nodeType===1&&Ti(u)}return n};function yt(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return Ti(t)}function Ft(n,e,t){if(n instanceof ge||n instanceof y)return n;t={slice:!0,parseOptions:{},...t};const u=typeof n=="object"&&n!==null,r=typeof n=="string";if(u)try{if(Array.isArray(n)&&n.length>0)return y.fromArray(n.map(o=>e.nodeFromJSON(o)));const s=e.nodeFromJSON(n);return t.errorOnInvalidContent&&s.check(),s}catch(i){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),Ft("",e,t)}if(r){if(t.errorOnInvalidContent){let s=!1,o="";const a=new Cr({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:l=>(s=!0,o=typeof l=="string"?l:l.outerHTML,null)}]}})});if(t.slice?De.fromSchema(a).parseSlice(yt(n),t.parseOptions):De.fromSchema(a).parse(yt(n),t.parseOptions),t.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const i=De.fromSchema(e);return t.slice?i.parseSlice(yt(n),t.parseOptions).content:i.parse(yt(n),t.parseOptions)}return Ft("",e,t)}function Na(n,e,t){const u=n.steps.length-1;if(u<e)return;const r=n.steps[u];if(!(r instanceof K||r instanceof J))return;const i=n.mapping.maps[u];let s=0;i.forEach((o,a,l,c)=>{s===0&&(s=c)}),n.setSelection(T.near(n.doc.resolve(s),t))}const va=n=>!("type"in n),Oa=(n,e,t)=>({tr:u,dispatch:r,editor:i})=>{var s;if(r){t={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let o;try{o=Ft(e,i.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(s=t.errorOnInvalidContent)!==null&&s!==void 0?s:i.options.enableContentCheck})}catch(p){return i.emit("contentError",{editor:i,error:p,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}}),!1}let{from:a,to:l}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},c=!0,d=!0;if((va(o)?o:[o]).forEach(p=>{p.check(),c=c?p.isText&&p.marks.length===0:!1,d=d?p.isBlock:!1}),a===l&&d){const{parent:p}=u.doc.resolve(a);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(a-=1,l+=1)}let f;if(c){if(Array.isArray(e))f=e.map(p=>p.text||"").join("");else if(e instanceof y){let p="";e.forEach(m=>{m.text&&(p+=m.text)}),f=p}else typeof e=="object"&&e&&e.text?f=e.text:f=e;u.insertText(f,a,l)}else f=o,u.replaceWith(a,l,f);t.updateSelection&&Na(u,u.steps.length-1,-1),t.applyInputRules&&u.setMeta("applyInputRules",{from:a,text:f}),t.applyPasteRules&&u.setMeta("applyPasteRules",{from:a,text:f})}return!0},Ia=()=>({state:n,dispatch:e})=>vo(n,e),Ra=()=>({state:n,dispatch:e})=>Oo(n,e),Da=()=>({state:n,dispatch:e})=>li(n,e),La=()=>({state:n,dispatch:e})=>hi(n,e),Pa=()=>({state:n,dispatch:e,tr:t})=>{try{const u=Vt(n.doc,n.selection.$from.pos,-1);return u==null?!1:(t.join(u,2),e&&e(t),!0)}catch{return!1}},Ba=()=>({state:n,dispatch:e,tr:t})=>{try{const u=Vt(n.doc,n.selection.$from.pos,1);return u==null?!1:(t.join(u,2),e&&e(t),!0)}catch{return!1}},za=()=>({state:n,dispatch:e})=>Mo(n,e),$a=()=>({state:n,dispatch:e})=>No(n,e);function Ai(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function _a(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let u,r,i,s;for(let o=0;o<e.length-1;o+=1){const a=e[o];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))u=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))i=!0;else if(/^mod$/i.test(a))nu()||Ai()?s=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return u&&(t=`Alt-${t}`),r&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const Fa=n=>({editor:e,view:t,tr:u,dispatch:r})=>{const i=_a(n).split(/-(?!$)/),s=i.find(l=>!["Alt","Ctrl","Meta","Shift"].includes(l)),o=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{t.someProp("handleKeyDown",l=>l(t,o))});return a?.steps.forEach(l=>{const c=l.map(u.mapping);c&&r&&u.maybeStep(c)}),!0};function uu(n,e,t={}){const{from:u,to:r,empty:i}=n.selection,s=e?F(e,n.schema):null,o=[];n.doc.nodesBetween(u,r,(d,h)=>{if(d.isText)return;const f=Math.max(u,h),p=Math.min(r,h+d.nodeSize);o.push({node:d,from:f,to:p})});const a=r-u,l=o.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>_t(d.node.attrs,t,{strict:!1}));return i?!!l.length:l.reduce((d,h)=>d+h.to-h.from,0)>=a}const qa=(n,e={})=>({state:t,dispatch:u})=>{const r=F(n,t.schema);return uu(t,r,e)?Io(t,u):!1},Ha=()=>({state:n,dispatch:e})=>gi(n,e),Va=n=>({state:e,dispatch:t})=>{const u=F(n,e.schema);return Vo(u)(e,t)},ja=()=>({state:n,dispatch:e})=>mi(n,e);function Mi(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function Wu(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((u,r)=>(t.includes(r)||(u[r]=n[r]),u),{})}const Wa=(n,e)=>({tr:t,state:u,dispatch:r})=>{let i=null,s=null;const o=Mi(typeof n=="string"?n:n.name,u.schema);return o?(o==="node"&&(i=F(n,u.schema)),o==="mark"&&(s=Te(n,u.schema)),r&&t.selection.ranges.forEach(a=>{u.doc.nodesBetween(a.$from.pos,a.$to.pos,(l,c)=>{i&&i===l.type&&t.setNodeMarkup(c,void 0,Wu(l.attrs,e)),s&&l.marks.length&&l.marks.forEach(d=>{s===d.type&&t.addMark(c,c+l.nodeSize,s.create(Wu(d.attrs,e)))})})}),!0):!1},Ja=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),Ua=()=>({tr:n,dispatch:e})=>{if(e){const t=new Y(n.doc);n.setSelection(t)}return!0},Ka=()=>({state:n,dispatch:e})=>di(n,e),Ga=()=>({state:n,dispatch:e})=>pi(n,e),Ya=()=>({state:n,dispatch:e})=>Po(n,e),Xa=()=>({state:n,dispatch:e})=>$o(n,e),Qa=()=>({state:n,dispatch:e})=>zo(n,e);function Za(n,e,t={},u={}){return Ft(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:u.errorOnInvalidContent})}const el=(n,e=!1,t={},u={})=>({editor:r,tr:i,dispatch:s,commands:o})=>{var a,l;const{doc:c}=i;if(t.preserveWhitespace!=="full"){const d=Za(n,r.schema,t,{errorOnInvalidContent:(a=u.errorOnInvalidContent)!==null&&a!==void 0?a:r.options.enableContentCheck});return s&&i.replaceWith(0,c.content.size,d).setMeta("preventUpdate",!e),!0}return s&&i.setMeta("preventUpdate",!e),o.insertContentAt({from:0,to:c.content.size},n,{parseOptions:t,errorOnInvalidContent:(l=u.errorOnInvalidContent)!==null&&l!==void 0?l:r.options.enableContentCheck})};function tl(n,e){const t=Te(e,n.schema),{from:u,to:r,empty:i}=n.selection,s=[];i?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(u,r,a=>{s.push(...a.marks)});const o=s.find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function nl(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function ul(n,e){for(let t=n.depth;t>0;t-=1){const u=n.node(t);if(e(u))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:u}}}function ru(n){return e=>ul(e.$from,n)}function rl(n,e){const t=Ve.resolve(n);return wi(t,e)}function Ni(n,e,t){const u=[];return n===e?t.resolve(n).marks().forEach(r=>{const i=t.resolve(n),s=tu(i,r.type);s&&u.push({mark:r,...s})}):t.nodesBetween(n,e,(r,i)=>{!r||r?.nodeSize===void 0||u.push(...r.marks.map(s=>({from:i,to:i+r.nodeSize,mark:s})))}),u}function Et(n,e,t){return Object.fromEntries(Object.entries(t).filter(([u])=>{const r=n.find(i=>i.type===e&&i.name===u);return r?r.attribute.keepOnSplit:!1}))}function il(n,e,t={}){const{empty:u,ranges:r}=n.selection,i=e?Te(e,n.schema):null;if(u)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>i?i.name===d.type.name:!0).find(d=>_t(d.attrs,t,{strict:!1}));let s=0;const o=[];if(r.forEach(({$from:d,$to:h})=>{const f=d.pos,p=h.pos;n.doc.nodesBetween(f,p,(m,b)=>{if(!m.isText&&!m.marks.length)return;const g=Math.max(f,b),k=Math.min(p,b+m.nodeSize),A=k-g;s+=A,o.push(...m.marks.map(R=>({mark:R,from:g,to:k})))})}),s===0)return!1;const a=o.filter(d=>i?i.name===d.mark.type.name:!0).filter(d=>_t(d.mark.attrs,t,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),l=o.filter(d=>i?d.mark.type!==i&&d.mark.type.excludes(i):!0).reduce((d,h)=>d+h.to-h.from,0);return(a>0?a+l:a)>=s}function Ju(n,e){const{nodeExtensions:t}=Kt(e),u=t.find(s=>s.name===n);if(!u)return!1;const r={name:u.name,options:u.options,storage:u.storage},i=C(x(u,"group",r));return typeof i!="string"?!1:i.split(" ").includes("list")}function vi(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var u;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((u=n.text)!==null&&u!==void 0?u:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let r=!0;return n.content.forEach(i=>{r!==!1&&(vi(i,{ignoreWhitespace:t,checkChildren:e})||(r=!1))}),r}return!1}function sl(n){return n instanceof S}function ol(n,e,t){var u;const{selection:r}=e;let i=null;if(Ci(r)&&(i=r.$cursor),i){const o=(u=n.storedMarks)!==null&&u!==void 0?u:i.marks();return!!t.isInSet(o)||!o.some(a=>a.type.excludes(t))}const{ranges:s}=r;return s.some(({$from:o,$to:a})=>{let l=o.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(o.pos,a.pos,(c,d,h)=>{if(l)return!1;if(c.isInline){const f=!h||h.type.allowsMarkType(t),p=!!t.isInSet(c.marks)||!c.marks.some(m=>m.type.excludes(t));l=f&&p}return!l}),l})}const al=(n,e={})=>({tr:t,state:u,dispatch:r})=>{const{selection:i}=t,{empty:s,ranges:o}=i,a=Te(n,u.schema);if(r)if(s){const l=tl(u,a);t.addStoredMark(a.create({...l,...e}))}else o.forEach(l=>{const c=l.$from.pos,d=l.$to.pos;u.doc.nodesBetween(c,d,(h,f)=>{const p=Math.max(f,c),m=Math.min(f+h.nodeSize,d);h.marks.find(g=>g.type===a)?h.marks.forEach(g=>{a===g.type&&t.addMark(p,m,a.create({...g.attrs,...e}))}):t.addMark(p,m,a.create(e))})});return ol(u,t,a)},ll=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),cl=(n,e={})=>({state:t,dispatch:u,chain:r})=>{const i=F(n,t.schema);let s;return t.selection.$anchor.sameParent(t.selection.$head)&&(s=t.selection.$anchor.parent.attrs),i.isTextblock?r().command(({commands:o})=>Fu(i,{...s,...e})(t)?!0:o.clearNodes()).command(({state:o})=>Fu(i,{...s,...e})(o,u)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},dl=n=>({tr:e,dispatch:t})=>{if(t){const{doc:u}=e,r=Oe(n,0,u.content.size),i=S.create(u,r);e.setSelection(i)}return!0},fl=n=>({tr:e,dispatch:t})=>{if(t){const{doc:u}=e,{from:r,to:i}=typeof n=="number"?{from:n,to:n}:n,s=E.atStart(u).from,o=E.atEnd(u).to,a=Oe(r,s,o),l=Oe(i,s,o),c=E.create(u,a,l);e.setSelection(c)}return!0},hl=n=>({state:e,dispatch:t})=>{const u=F(n,e.schema);return Jo(u)(e,t)};function Uu(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const u=t.filter(r=>e?.includes(r.type.name));n.tr.ensureMarks(u)}}const pl=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:u,editor:r})=>{const{selection:i,doc:s}=e,{$from:o,$to:a}=i,l=r.extensionManager.attributes,c=Et(l,o.node().type.name,o.node().attrs);if(i instanceof S&&i.node.isBlock)return!o.parentOffset||!ce(s,o.pos)?!1:(u&&(n&&Uu(t,r.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const d=a.parentOffset===a.parent.content.size,h=o.depth===0?void 0:nl(o.node(-1).contentMatchAt(o.indexAfter(-1)));let f=d&&h?[{type:h,attrs:c}]:void 0,p=ce(e.doc,e.mapping.map(o.pos),1,f);if(!f&&!p&&ce(e.doc,e.mapping.map(o.pos),1,h?[{type:h}]:void 0)&&(p=!0,f=h?[{type:h,attrs:c}]:void 0),u){if(p&&(i instanceof E&&e.deleteSelection(),e.split(e.mapping.map(o.pos),1,f),h&&!d&&!o.parentOffset&&o.parent.type!==h)){const m=e.mapping.map(o.before()),b=e.doc.resolve(m);o.node(-1).canReplaceWith(b.index(),b.index()+1,h)&&e.setNodeMarkup(e.mapping.map(o.before()),h)}n&&Uu(t,r.extensionManager.splittableMarks),e.scrollIntoView()}return p},ml=(n,e={})=>({tr:t,state:u,dispatch:r,editor:i})=>{var s;const o=F(n,u.schema),{$from:a,$to:l}=u.selection,c=u.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const d=a.node(-1);if(d.type!==o)return!1;const h=i.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let g=y.empty;const k=a.index(-1)?1:a.index(-2)?2:3;for(let re=a.depth-k;re>=a.depth-3;re-=1)g=y.from(a.node(re).copy(g));const A=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,R={...Et(h,a.node().type.name,a.node().attrs),...e},M=((s=o.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(R))||void 0;g=g.append(y.from(o.createAndFill(null,M)||void 0));const O=a.before(a.depth-(k-1));t.replace(O,a.after(-A),new w(g,4-k,0));let ue=-1;t.doc.nodesBetween(O,t.doc.content.size,(re,Ui)=>{if(ue>-1)return!1;re.isTextblock&&re.content.size===0&&(ue=Ui+1)}),ue>-1&&t.setSelection(E.near(t.doc.resolve(ue))),t.scrollIntoView()}return!0}const f=l.pos===a.end()?d.contentMatchAt(0).defaultType:null,p={...Et(h,d.type.name,d.attrs),...e},m={...Et(h,a.node().type.name,a.node().attrs),...e};t.delete(a.pos,l.pos);const b=f?[{type:o,attrs:p},{type:f,attrs:m}]:[{type:o,attrs:p}];if(!ce(t.doc,a.pos,2))return!1;if(r){const{selection:g,storedMarks:k}=u,{splittableMarks:A}=i.extensionManager,R=k||g.$to.parentOffset&&g.$from.marks();if(t.split(a.pos,2,b).scrollIntoView(),!R||!r)return!0;const M=R.filter(O=>A.includes(O.type.name));t.ensureMarks(M)}return!0},dn=(n,e)=>{const t=ru(s=>s.type===e)(n.selection);if(!t)return!0;const u=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(u===void 0)return!0;const r=n.doc.nodeAt(u);return t.node.type===r?.type&&Se(n.doc,t.pos)&&n.join(t.pos),!0},fn=(n,e)=>{const t=ru(s=>s.type===e)(n.selection);if(!t)return!0;const u=n.doc.resolve(t.start).after(t.depth);if(u===void 0)return!0;const r=n.doc.nodeAt(u);return t.node.type===r?.type&&Se(n.doc,u)&&n.join(u),!0},bl=(n,e,t,u={})=>({editor:r,tr:i,state:s,dispatch:o,chain:a,commands:l,can:c})=>{const{extensions:d,splittableMarks:h}=r.extensionManager,f=F(n,s.schema),p=F(e,s.schema),{selection:m,storedMarks:b}=s,{$from:g,$to:k}=m,A=g.blockRange(k),R=b||m.$to.parentOffset&&m.$from.marks();if(!A)return!1;const M=ru(O=>Ju(O.type.name,d))(m);if(A.depth>=1&&M&&A.depth-M.depth<=1){if(M.node.type===f)return l.liftListItem(p);if(Ju(M.node.type.name,d)&&f.validContent(M.node.content)&&o)return a().command(()=>(i.setNodeMarkup(M.pos,f),!0)).command(()=>dn(i,f)).command(()=>fn(i,f)).run()}return!t||!R||!o?a().command(()=>c().wrapInList(f,u)?!0:l.clearNodes()).wrapInList(f,u).command(()=>dn(i,f)).command(()=>fn(i,f)).run():a().command(()=>{const O=c().wrapInList(f,u),ue=R.filter(re=>h.includes(re.type.name));return i.ensureMarks(ue),O?!0:l.clearNodes()}).wrapInList(f,u).command(()=>dn(i,f)).command(()=>fn(i,f)).run()},gl=(n,e={},t={})=>({state:u,commands:r})=>{const{extendEmptyMarkRange:i=!1}=t,s=Te(n,u.schema);return il(u,s,e)?r.unsetMark(s,{extendEmptyMarkRange:i}):r.setMark(s,e)},yl=(n,e,t={})=>({state:u,commands:r})=>{const i=F(n,u.schema),s=F(e,u.schema),o=uu(u,i,t);let a;return u.selection.$anchor.sameParent(u.selection.$head)&&(a=u.selection.$anchor.parent.attrs),o?r.setNode(s,a):r.setNode(i,{...a,...t})},xl=(n,e={})=>({state:t,commands:u})=>{const r=F(n,t.schema);return uu(t,r,e)?u.lift(r):u.wrapIn(r,e)},kl=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let u=0;u<t.length;u+=1){const r=t[u];let i;if(r.spec.isInputRules&&(i=r.getState(n))){if(e){const s=n.tr,o=i.transform;for(let a=o.steps.length-1;a>=0;a-=1)s.step(o.steps[a].invert(o.docs[a]));if(i.text){const a=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,n.schema.text(i.text,a))}else s.delete(i.from,i.to)}return!0}}return!1},wl=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:u,ranges:r}=t;return u||e&&r.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},Sl=(n,e={})=>({tr:t,state:u,dispatch:r})=>{var i;const{extendEmptyMarkRange:s=!1}=e,{selection:o}=t,a=Te(n,u.schema),{$from:l,empty:c,ranges:d}=o;if(!r)return!0;if(c&&s){let{from:h,to:f}=o;const p=(i=l.marks().find(b=>b.type===a))===null||i===void 0?void 0:i.attrs,m=tu(l,a,p);m&&(h=m.from,f=m.to),t.removeMark(h,f,a)}else d.forEach(h=>{t.removeMark(h.$from.pos,h.$to.pos,a)});return t.removeStoredMark(a),!0},El=(n,e={})=>({tr:t,state:u,dispatch:r})=>{let i=null,s=null;const o=Mi(typeof n=="string"?n:n.name,u.schema);return o?(o==="node"&&(i=F(n,u.schema)),o==="mark"&&(s=Te(n,u.schema)),r&&t.selection.ranges.forEach(a=>{const l=a.$from.pos,c=a.$to.pos;let d,h,f,p;t.selection.empty?u.doc.nodesBetween(l,c,(m,b)=>{i&&i===m.type&&(f=Math.max(b,l),p=Math.min(b+m.nodeSize,c),d=b,h=m)}):u.doc.nodesBetween(l,c,(m,b)=>{b<l&&i&&i===m.type&&(f=Math.max(b,l),p=Math.min(b+m.nodeSize,c),d=b,h=m),b>=l&&b<=c&&(i&&i===m.type&&t.setNodeMarkup(b,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(g=>{if(s===g.type){const k=Math.max(b,l),A=Math.min(b+m.nodeSize,c);t.addMark(k,A,s.create({...g.attrs,...e}))}}))}),h&&(d!==void 0&&t.setNodeMarkup(d,void 0,{...h.attrs,...e}),s&&h.marks.length&&h.marks.forEach(m=>{s===m.type&&t.addMark(f,p,s.create({...m.attrs,...e}))}))}),!0):!1},Cl=(n,e={})=>({state:t,dispatch:u})=>{const r=F(n,t.schema);return _o(r,e)(t,u)},Tl=(n,e={})=>({state:t,dispatch:u})=>{const r=F(n,t.schema);return Fo(r,e)(t,u)};var Al=Object.freeze({__proto__:null,blur:la,clearContent:ca,clearNodes:da,command:fa,createParagraphNear:ha,cut:pa,deleteCurrentNode:ma,deleteNode:ba,deleteRange:ga,deleteSelection:ya,enter:xa,exitCode:ka,extendMarkRange:wa,first:Sa,focus:Ta,forEach:Aa,insertContent:Ma,insertContentAt:Oa,joinBackward:Da,joinDown:Ra,joinForward:La,joinItemBackward:Pa,joinItemForward:Ba,joinTextblockBackward:za,joinTextblockForward:$a,joinUp:Ia,keyboardShortcut:Fa,lift:qa,liftEmptyBlock:Ha,liftListItem:Va,newlineInCode:ja,resetAttributes:Wa,scrollIntoView:Ja,selectAll:Ua,selectNodeBackward:Ka,selectNodeForward:Ga,selectParentNode:Ya,selectTextblockEnd:Xa,selectTextblockStart:Qa,setContent:el,setMark:al,setMeta:ll,setNode:cl,setNodeSelection:dl,setTextSelection:fl,sinkListItem:hl,splitBlock:pl,splitListItem:ml,toggleList:bl,toggleMark:gl,toggleNode:yl,toggleWrap:xl,undoInputRule:kl,unsetAllMarks:wl,unsetMark:Sl,updateAttributes:El,wrapIn:Cl,wrapInList:Tl});W.create({name:"commands",addCommands(){return{...Al}}});W.create({name:"drop",addProseMirrorPlugins(){return[new U({key:new le("tiptapDrop"),props:{handleDrop:(n,e,t,u)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:u})}}})]}});W.create({name:"editable",addProseMirrorPlugins(){return[new U({key:new le("editable"),props:{editable:()=>this.editor.options.editable}})]}});W.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new U({key:new le("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const u=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(u),!1},blur:(e,t)=>{n.isFocused=!1;const u=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(u),!1}}}})]}});W.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:o})=>{const{selection:a,doc:l}=o,{empty:c,$anchor:d}=a,{pos:h,parent:f}=d,p=d.parent.isTextblock&&h>0?o.doc.resolve(h-1):d,m=p.parent.type.spec.isolating,b=d.pos-d.parentOffset,g=m&&p.parent.childCount===1?b===d.pos:T.atStart(l).from===h;return!c||!f.type.isTextblock||f.textContent.length||!g||g&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),u={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...u},i={...u,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return nu()||Ai()?i:r},addProseMirrorPlugins(){return[new U({key:new le("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(m=>m.getMeta("composition")))return;const u=n.some(m=>m.docChanged)&&!e.doc.eq(t.doc),r=n.some(m=>m.getMeta("preventClearDocument"));if(!u||r)return;const{empty:i,from:s,to:o}=e.selection,a=T.atStart(e.doc).from,l=T.atEnd(e.doc).to;if(i||!(s===a&&o===l)||!vi(t.doc))return;const h=t.tr,f=Ut({state:t,transaction:h}),{commands:p}=new Zn({editor:this.editor,state:f});if(p.clearNodes(),!!h.steps.length)return h}})]}});W.create({name:"paste",addProseMirrorPlugins(){return[new U({key:new le("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}});W.create({name:"tabindex",addProseMirrorPlugins(){return[new U({key:new le("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});function Ue(n){return new Gt({find:n.find,handler:({state:e,range:t,match:u})=>{const r=C(n.getAttributes,void 0,u);if(r===!1||r===null)return null;const{tr:i}=e,s=u[u.length-1],o=u[0];if(s){const a=o.search(/\S/),l=t.from+o.indexOf(s),c=l+s.length;if(Ni(t.from,t.to,e.doc).filter(f=>f.mark.type.excluded.find(m=>m===n.type&&m!==f.mark.type)).filter(f=>f.to>l).length)return null;c<t.to&&i.delete(c,t.to),l>t.from&&i.delete(t.from+a,l);const h=t.from+a+s.length;i.addMark(t.from+a,h,n.type.create(r||{})),i.removeStoredMark(n.type)}}})}function Oi(n){return new Gt({find:n.find,handler:({state:e,range:t,match:u})=>{const r=C(n.getAttributes,void 0,u)||{},{tr:i}=e,s=t.from;let o=t.to;const a=n.type.create(r);if(u[1]){const l=u[0].lastIndexOf(u[1]);let c=s+l;c>o?c=o:o=c+u[1].length;const d=u[0][u[0].length-1];i.insertText(d,s+u[0].length-1),i.replaceWith(c,o,a)}else if(u[0]){const l=n.type.isInline?s:s-1;i.insert(l,n.type.create(r)).delete(i.mapping.map(s),i.mapping.map(o))}i.scrollIntoView()}})}function Rn(n){return new Gt({find:n.find,handler:({state:e,range:t,match:u})=>{const r=e.doc.resolve(t.from),i=C(n.getAttributes,void 0,u)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function lt(n){return new Gt({find:n.find,handler:({state:e,range:t,match:u,chain:r})=>{const i=C(n.getAttributes,void 0,u)||{},s=e.tr.delete(t.from,t.to),a=s.doc.resolve(t.from).blockRange(),l=a&&zn(a,n.type,i);if(!l)return null;if(s.wrap(a,l),n.keepMarks&&n.editor){const{selection:d,storedMarks:h}=e,{splittableMarks:f}=n.editor.extensionManager,p=h||d.$to.parentOffset&&d.$from.marks();if(p){const m=p.filter(b=>f.includes(b.type.name));s.ensureMarks(m)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(d,i).run()}const c=s.doc.resolve(t.from-1).nodeBefore;c&&c.type===n.type&&Se(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(u,c))&&s.join(t.from-1)}})}class H{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=C(x(this,"addOptions",{name:this.name}))),this.storage=C(x(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new H(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Yt(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new H(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=C(x(t,"addOptions",{name:t.name})),t.storage=C(x(t,"addStorage",{name:t.name,options:t.options})),t}}function Ke(n){return new ta({find:n.find,handler:({state:e,range:t,match:u,pasteEvent:r})=>{const i=C(n.getAttributes,void 0,u,r);if(i===!1||i===null)return null;const{tr:s}=e,o=u[u.length-1],a=u[0];let l=t.to;if(o){const c=a.search(/\S/),d=t.from+a.indexOf(o),h=d+o.length;if(Ni(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(b=>b===n.type&&b!==p.mark.type)).filter(p=>p.to>d).length)return null;h<t.to&&s.delete(h,t.to),d>t.from&&s.delete(t.from+c,d),l=t.from+c+o.length,s.addMark(t.from+c,l,n.type.create(i||{})),s.removeStoredMark(n.type)}}})}const Ml=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(n=>n.charCodeAt(0))),Nl=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(n=>n.charCodeAt(0)));var hn;const vl=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Ol=(hn=String.fromCodePoint)!==null&&hn!==void 0?hn:function(n){let e="";return n>65535&&(n-=65536,e+=String.fromCharCode(n>>>10&1023|55296),n=56320|n&1023),e+=String.fromCharCode(n),e};function Il(n){var e;return n>=55296&&n<=57343||n>1114111?65533:(e=vl.get(n))!==null&&e!==void 0?e:n}var B;(function(n){n[n.NUM=35]="NUM",n[n.SEMI=59]="SEMI",n[n.EQUALS=61]="EQUALS",n[n.ZERO=48]="ZERO",n[n.NINE=57]="NINE",n[n.LOWER_A=97]="LOWER_A",n[n.LOWER_F=102]="LOWER_F",n[n.LOWER_X=120]="LOWER_X",n[n.LOWER_Z=122]="LOWER_Z",n[n.UPPER_A=65]="UPPER_A",n[n.UPPER_F=70]="UPPER_F",n[n.UPPER_Z=90]="UPPER_Z"})(B||(B={}));const Rl=32;var be;(function(n){n[n.VALUE_LENGTH=49152]="VALUE_LENGTH",n[n.BRANCH_LENGTH=16256]="BRANCH_LENGTH",n[n.JUMP_TABLE=127]="JUMP_TABLE"})(be||(be={}));function Dn(n){return n>=B.ZERO&&n<=B.NINE}function Dl(n){return n>=B.UPPER_A&&n<=B.UPPER_F||n>=B.LOWER_A&&n<=B.LOWER_F}function Ll(n){return n>=B.UPPER_A&&n<=B.UPPER_Z||n>=B.LOWER_A&&n<=B.LOWER_Z||Dn(n)}function Pl(n){return n===B.EQUALS||Ll(n)}var L;(function(n){n[n.EntityStart=0]="EntityStart",n[n.NumericStart=1]="NumericStart",n[n.NumericDecimal=2]="NumericDecimal",n[n.NumericHex=3]="NumericHex",n[n.NamedEntity=4]="NamedEntity"})(L||(L={}));var pe;(function(n){n[n.Legacy=0]="Legacy",n[n.Strict=1]="Strict",n[n.Attribute=2]="Attribute"})(pe||(pe={}));class Bl{constructor(e,t,u){this.decodeTree=e,this.emitCodePoint=t,this.errors=u,this.state=L.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=pe.Strict}startEntity(e){this.decodeMode=e,this.state=L.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case L.EntityStart:return e.charCodeAt(t)===B.NUM?(this.state=L.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=L.NamedEntity,this.stateNamedEntity(e,t));case L.NumericStart:return this.stateNumericStart(e,t);case L.NumericDecimal:return this.stateNumericDecimal(e,t);case L.NumericHex:return this.stateNumericHex(e,t);case L.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(e.charCodeAt(t)|Rl)===B.LOWER_X?(this.state=L.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=L.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,u,r){if(t!==u){const i=u-t;this.result=this.result*Math.pow(r,i)+Number.parseInt(e.substr(t,i),r),this.consumed+=i}}stateNumericHex(e,t){const u=t;for(;t<e.length;){const r=e.charCodeAt(t);if(Dn(r)||Dl(r))t+=1;else return this.addToNumericResult(e,u,t,16),this.emitNumericEntity(r,3)}return this.addToNumericResult(e,u,t,16),-1}stateNumericDecimal(e,t){const u=t;for(;t<e.length;){const r=e.charCodeAt(t);if(Dn(r))t+=1;else return this.addToNumericResult(e,u,t,10),this.emitNumericEntity(r,2)}return this.addToNumericResult(e,u,t,10),-1}emitNumericEntity(e,t){var u;if(this.consumed<=t)return(u=this.errors)===null||u===void 0||u.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===B.SEMI)this.consumed+=1;else if(this.decodeMode===pe.Strict)return 0;return this.emitCodePoint(Il(this.result),this.consumed),this.errors&&(e!==B.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:u}=this;let r=u[this.treeIndex],i=(r&be.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const s=e.charCodeAt(t);if(this.treeIndex=zl(u,r,this.treeIndex+Math.max(1,i),s),this.treeIndex<0)return this.result===0||this.decodeMode===pe.Attribute&&(i===0||Pl(s))?0:this.emitNotTerminatedNamedEntity();if(r=u[this.treeIndex],i=(r&be.VALUE_LENGTH)>>14,i!==0){if(s===B.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==pe.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:u}=this,r=(u[t]&be.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,r,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,u){const{decodeTree:r}=this;return this.emitCodePoint(t===1?r[e]&~be.VALUE_LENGTH:r[e+1],u),t===3&&this.emitCodePoint(r[e+2],u),u}end(){var e;switch(this.state){case L.NamedEntity:return this.result!==0&&(this.decodeMode!==pe.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case L.NumericDecimal:return this.emitNumericEntity(0,2);case L.NumericHex:return this.emitNumericEntity(0,3);case L.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case L.EntityStart:return 0}}}function Ii(n){let e="";const t=new Bl(n,u=>e+=Ol(u));return function(r,i){let s=0,o=0;for(;(o=r.indexOf("&",o))>=0;){e+=r.slice(s,o),t.startEntity(i);const l=t.write(r,o+1);if(l<0){s=o+t.end();break}s=o+l,o=l===0?s+1:s}const a=e+r.slice(s);return e="",a}}function zl(n,e,t,u){const r=(e&be.BRANCH_LENGTH)>>7,i=e&be.JUMP_TABLE;if(r===0)return i!==0&&u===i?t:-1;if(i){const a=u-i;return a<0||a>=r?-1:n[t+a]-1}let s=t,o=s+r-1;for(;s<=o;){const a=s+o>>>1,l=n[a];if(l<u)s=a+1;else if(l>u)o=a-1;else return n[a+r]}return-1}const $l=Ii(Ml);Ii(Nl);function _l(n,e=pe.Legacy){return $l(n,e)}var N;(function(n){n.Attribute="attribute",n.Pseudo="pseudo",n.PseudoElement="pseudo-element",n.Tag="tag",n.Universal="universal",n.Adjacent="adjacent",n.Child="child",n.Descendant="descendant",n.Parent="parent",n.Sibling="sibling",n.ColumnCombinator="column-combinator"})(N||(N={}));var Z;(function(n){n.Any="any",n.Element="element",n.End="end",n.Equals="equals",n.Exists="exists",n.Hyphen="hyphen",n.Not="not",n.Start="start"})(Z||(Z={}));const Ku=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,Fl=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,ql=new Map([[126,Z.Element],[94,Z.Start],[36,Z.End],[42,Z.Any],[33,Z.Not],[124,Z.Hyphen]]),Hl=new Set(["has","not","matches","is","where","host","host-context"]);function Vl(n){switch(n.type){case N.Adjacent:case N.Child:case N.Descendant:case N.Parent:case N.Sibling:case N.ColumnCombinator:return!0;default:return!1}}const jl=new Set(["contains","icontains"]);function Wl(n,e,t){const u=parseInt(e,16)-65536;return u!==u||t?e:u<0?String.fromCharCode(u+65536):String.fromCharCode(u>>10|55296,u&1023|56320)}function Xe(n){return n.replace(Fl,Wl)}function pn(n){return n===39||n===34}function Gu(n){return n===32||n===9||n===10||n===12||n===13}function Jl(n){const e=[],t=Ri(e,`${n}`,0);if(t<n.length)throw new Error(`Unmatched selector: ${n.slice(t)}`);return e}function Ri(n,e,t){let u=[];function r(h){const f=e.slice(t+h).match(Ku);if(!f)throw new Error(`Expected name, found ${e.slice(t)}`);const[p]=f;return t+=h+p.length,Xe(p)}function i(h){for(t+=h;t<e.length&&Gu(e.charCodeAt(t));)t++}function s(){t+=1;const h=t;let f=1;for(;f>0&&t<e.length;t++)e.charCodeAt(t)===40&&!o(t)?f++:e.charCodeAt(t)===41&&!o(t)&&f--;if(f)throw new Error("Parenthesis not matched");return Xe(e.slice(h,t-1))}function o(h){let f=0;for(;e.charCodeAt(--h)===92;)f++;return(f&1)===1}function a(){if(u.length>0&&Vl(u[u.length-1]))throw new Error("Did not expect successive traversals.")}function l(h){if(u.length>0&&u[u.length-1].type===N.Descendant){u[u.length-1].type=h;return}a(),u.push({type:h})}function c(h,f){u.push({type:N.Attribute,name:h,action:f,value:r(1),namespace:null,ignoreCase:"quirks"})}function d(){if(u.length&&u[u.length-1].type===N.Descendant&&u.pop(),u.length===0)throw new Error("Empty sub-selector");n.push(u)}if(i(0),e.length===t)return t;e:for(;t<e.length;){const h=e.charCodeAt(t);switch(h){case 32:case 9:case 10:case 12:case 13:{(u.length===0||u[0].type!==N.Descendant)&&(a(),u.push({type:N.Descendant})),i(1);break}case 62:{l(N.Child),i(1);break}case 60:{l(N.Parent),i(1);break}case 126:{l(N.Sibling),i(1);break}case 43:{l(N.Adjacent),i(1);break}case 46:{c("class",Z.Element);break}case 35:{c("id",Z.Equals);break}case 91:{i(1);let f,p=null;e.charCodeAt(t)===124?f=r(1):e.startsWith("*|",t)?(p="*",f=r(2)):(f=r(0),e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==61&&(p=f,f=r(1))),i(0);let m=Z.Exists;const b=ql.get(e.charCodeAt(t));if(b){if(m=b,e.charCodeAt(t+1)!==61)throw new Error("Expected `=`");i(2)}else e.charCodeAt(t)===61&&(m=Z.Equals,i(1));let g="",k=null;if(m!=="exists"){if(pn(e.charCodeAt(t))){const M=e.charCodeAt(t);let O=t+1;for(;O<e.length&&(e.charCodeAt(O)!==M||o(O));)O+=1;if(e.charCodeAt(O)!==M)throw new Error("Attribute value didn't end");g=Xe(e.slice(t+1,O)),t=O+1}else{const M=t;for(;t<e.length&&(!Gu(e.charCodeAt(t))&&e.charCodeAt(t)!==93||o(t));)t+=1;g=Xe(e.slice(M,t))}i(0);const R=e.charCodeAt(t)|32;R===115?(k=!1,i(1)):R===105&&(k=!0,i(1))}if(e.charCodeAt(t)!==93)throw new Error("Attribute selector didn't terminate");t+=1;const A={type:N.Attribute,name:f,action:m,value:g,namespace:p,ignoreCase:k};u.push(A);break}case 58:{if(e.charCodeAt(t+1)===58){u.push({type:N.PseudoElement,name:r(2).toLowerCase(),data:e.charCodeAt(t)===40?s():null});continue}const f=r(1).toLowerCase();let p=null;if(e.charCodeAt(t)===40)if(Hl.has(f)){if(pn(e.charCodeAt(t+1)))throw new Error(`Pseudo-selector ${f} cannot be quoted`);if(p=[],t=Ri(p,e,t+1),e.charCodeAt(t)!==41)throw new Error(`Missing closing parenthesis in :${f} (${e})`);t+=1}else{if(p=s(),jl.has(f)){const m=p.charCodeAt(0);m===p.charCodeAt(p.length-1)&&pn(m)&&(p=p.slice(1,-1))}p=Xe(p)}u.push({type:N.Pseudo,name:f,data:p});break}case 44:{d(),u=[],i(1);break}default:{if(e.startsWith("/*",t)){const m=e.indexOf("*/",t+2);if(m<0)throw new Error("Comment was not terminated");t=m+2,u.length===0&&i(0);break}let f=null,p;if(h===42)t+=1,p="*";else if(h===124){if(p="",e.charCodeAt(t+1)===124){l(N.ColumnCombinator),i(2);break}}else if(Ku.test(e.slice(t)))p=r(0);else break e;e.charCodeAt(t)===124&&e.charCodeAt(t+1)!==124&&(f=p,e.charCodeAt(t+1)===42?(p="*",t+=2):p=r(1)),u.push(p==="*"?{type:N.Universal,namespace:f}:{type:N.Tag,name:p,namespace:f})}}}return d(),t}function Ln(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/\xA0/g,"&nbsp;").replace(/\xAD/g,"&shy;")}var Yu=n=>_l(n);function Ul(n,e,t,u){if(typeof e=="function")return e({props:{...t,children:u},attrs:t,children:u,h:n.h,context:n});{let r=!0,i;if(e?e.toLowerCase()==="fragment"?(i=n.document.createDocumentFragment(),r=!1):i=n.document.createElement(e):i=n.document.createElement("div"),t&&r){const s=i;for(let[o,a]of Object.entries(t)){o=o.toString();const l=o.toLowerCase();l==="classname"?s.className=a:l==="on"?Object.entries(a).forEach(([c,d])=>{s.setAttribute(`on${c}`,String(d))}):a!==!1&&a!=null&&(a===!0?s.setAttribute(o,o):s.setAttribute(o,a.toString()))}}if(u)for(const s of u){const o=Array.isArray(s)?[...s]:[s];for(const a of o)a&&a!==!1&&a!=null&&(typeof a!="object"?i.appendChild(n.document.createTextNode(a.toString())):i.appendChild(a))}return i}}function Di(n,e,...t){return typeof n=="object"&&(n="fragment",t=n.children,e=n.attrs),Array.isArray(e)?(t=[e],e={}):e?e.attrs&&(e={...e.attrs,...e},delete e.attrs):e={},{tag:n,attrs:e,children:typeof t[0]=="string"?t:t.flat(Number.POSITIVE_INFINITY)}}function Kl(n){return n.h=function(t,u,...r){const{tag:i,attrs:s,children:o}=Di(t,u,r);return Ul(n,i,s,o)},n.h}var Xu={};function Gl(n){let e=Xu[n];return e==null&&(e=Jl(n),Xu[n]=e),e}function Yl(n,e,{debug:t=!1}={}){for(const u of Gl(n)){const r=(i,s)=>{let o=!1;for(const a of s){const{type:l,name:c,action:d,value:h,_ignoreCase:f=!0,data:p}=a;if(l==="attribute")d==="equals"?o=i.getAttribute(c)===h:d==="start"?o=!!i.getAttribute(c)?.startsWith(h):d==="end"?o=!!i.getAttribute(c)?.endsWith(h):d==="element"?c==="class"?o=i.classList.contains(h):o=!!i.getAttribute(c)?.includes(h):d==="exists"?o=i.hasAttribute(c):d==="any"?o=!!i.getAttribute(c)?.includes(h):console.warn("Unknown CSS selector action",d);else if(l==="tag")o=i.tagName===c.toUpperCase();else if(l==="universal")o=!0;else if(l==="pseudo"){if(c==="not"){let m=!0;p.forEach(b=>{r(i,b)||(m=!1)}),o=!m}}else console.warn("Unknown CSS selector type",l,n,s);if(!o)break}return o};if(r(e,u))return!0}return!1}var Xl=Symbol.for("nodejs.util.inspect.custom"),Qu={fontWeight:"bold"},Zu={fontStyle:"italic"},er={backgroundColor:"rgb(255, 250, 165)"},tr={textDecorations:"underline"},mn={textDecorations:"line-through"},Ql={b:Qu,strong:Qu,em:Zu,i:Zu,mark:er,u:tr,a:tr,s:mn,del:mn,ins:er,strike:mn};function nr(n){return n.toLowerCase().replace(/[^a-z0-9]+(.)/gi,(e,t)=>t.toUpperCase())}var de=class Ct{constructor(){this.append=this.appendChild,this._parentNode=null,this._childNodes=[]}get nodeType(){return console.error("Subclasses should define nodeType!"),0}get nodeName(){return console.error("Subclasses should define nodeName!"),""}get nodeValue(){return null}cloneNode(e=!1){const t=new this.constructor;return e&&(t._childNodes=this._childNodes.map(u=>u.cloneNode(!0)),t._fixChildNodesParent()),t}_fixChildNodesParent(){this._childNodes.forEach(e=>e._parentNode=this)}insertBefore(e,t){if(e!==t){let u=t?this._childNodes.indexOf(t):0;u<0&&(u=0),this._childNodes.splice(u,0,e),this._fixChildNodesParent()}}appendChild(e){if(e!=null){if(e===this){console.warn("Cannot appendChild to self");return}if(e instanceof su&&console.warn("No defined how to append a document to a node!",e),e instanceof iu)for(const t of[...e._childNodes])this.appendChild(t);else if(Array.isArray(e))for(const t of[...e])this.appendChild(t);else if(e instanceof Ct)e.remove(),this._childNodes.push(e);else try{const t=typeof e=="string"?e:JSON.stringify(e,null,2);this._childNodes.push(new je(t))}catch(t){console.error(`The data ${e} to be added to ${this.render()} is problematic: ${t}`)}this._fixChildNodesParent()}}removeChild(e){const t=this._childNodes.indexOf(e);t>=0&&(e._parentNode=null,this._childNodes.splice(t,1),this._fixChildNodesParent())}remove(){return this?.parentNode?.removeChild(this),this}replaceChildren(...e){this._childNodes=e.map(t=>typeof t=="string"?new je(t):t.remove()),this._fixChildNodesParent()}replaceWith(...e){const t=this._parentNode;if(t){const u=this._indexInParent();u>=0&&(e=e.map(r=>typeof r=="string"?new je(r):r.remove()),t._childNodes.splice(u,1,...e),this._parentNode=null,t._fixChildNodesParent())}}_indexInParent(){return this._parentNode?this._parentNode.childNodes.indexOf(this):-1}get parentNode(){return this._parentNode}get childNodes(){return this._childNodes||[]}get children(){return this._childNodes||[]}get firstChild(){return this._childNodes[0]}get lastChild(){return this._childNodes[this._childNodes.length-1]}get nextSibling(){const e=this._indexInParent();return e!=null&&this.parentNode.childNodes[e+1]||null}get previousSibling(){const e=this._indexInParent();return e>0&&this.parentNode.childNodes[e-1]||null}flatten(){const e=[];this instanceof ee&&e.push(this);for(const t of this._childNodes)e.push(...t.flatten());return e}flattenNodes(){const e=[];e.push(this);for(const t of this._childNodes)e.push(...t.flattenNodes());return e}render(){return""}get textContent(){return this._childNodes.map(e=>e.textContent).join("")}set textContent(e){this._childNodes=[],e&&this.appendChild(new je(e.toString()))}contains(e){return e===this?!0:this._childNodes.some(t=>t.contains(e))}get ownerDocument(){return this.nodeType===Ct.DOCUMENT_NODE||this.nodeType===Ct.DOCUMENT_FRAGMENT_NODE?this:this?._parentNode?.ownerDocument}toString(){return`${this.nodeName}`}[Xl](){return`${this.constructor.name} "${this.render()}"`}};de.ELEMENT_NODE=1;de.TEXT_NODE=3;de.CDATA_SECTION_NODE=4;de.PROCESSING_INSTRUCTION_NODE=7;de.COMMENT_NODE=8;de.DOCUMENT_NODE=9;de.DOCUMENT_TYPE_NODE=10;de.DOCUMENT_FRAGMENT_NODE=11;var we=de,je=class extends we{get nodeType(){return we.TEXT_NODE}get nodeName(){return"#text"}get nodeValue(){return this._text||""}get textContent(){return this.nodeValue}constructor(n=""){super(),this._text=n}render(){const n=this.parentNode?.tagName;return n==="SCRIPT"||n==="STYLE"?this._text:Ln(this._text)}cloneNode(n=!1){const e=super.cloneNode(n);return e._text=this._text,e}},Li=class extends we{getElementById(n){return this.flatten().find(e=>e._attributes.id===n)}getElementsByClassName(n){return this.flatten().filter(e=>e.classList.contains(n))}matches(n){return Yl(n,this)}querySelectorAll(n){return this.flatten().filter(e=>e.matches(n))}querySelector(n){return this.flatten().find(e=>e.matches(n))}parent(n){return this.matches(n)?this:this.parentNode==null?null:this.parentNode?.parent(n)}handle(n,e){let t=0;for(const u of this.querySelectorAll(n))e(u,t++)}},ee=class extends Li{get nodeType(){return we.ELEMENT_NODE}get nodeName(){return this._nodeName}constructor(n="div",e={}){super(),this._originalTagName=n,this._nodeName=(n||"").toUpperCase(),this._attributes=e||{}}cloneNode(n=!1){const e=super.cloneNode(n);return e._originalTagName=this._originalTagName,e._nodeName=this._nodeName,e._attributes=Object.assign({},this._attributes),e}get attributes(){return Object.entries(this._attributes).map(([n,e])=>({name:n,value:e}))}get attributesObject(){return{...this._attributes}}_findAttributeName(n){const e=n.toLowerCase();return Object.keys(this._attributes).find(t=>e===t.toLowerCase())||null}setAttribute(n,e){this.removeAttribute(n),this._attributes[n]=e,this._styles=void 0,this._dataset=void 0}getAttribute(n){const e=this._findAttributeName(n),t=e?this._attributes[e]:null;return t==null?null:typeof t=="string"?t:""}removeAttribute(n){this._findAttributeName(String(n))&&delete this._attributes[n]}hasAttribute(n){const e=this._findAttributeName(n);return e?this._attributes[e]!=null:!1}get style(){if(this._styles==null){const n={};let e=0;const t=this.getAttribute("style");if(t){let u;const r=/\s*([\w-]+)\s*:\s*((url\(.*?\)[^;]*|[^;]+))/gi;for(;u=r.exec(t);){++e;const i=u[1],s=u[2].trim();n[i]=s,n[nr(i)]=s}}this._styles={get length(){return e},getPropertyValue(u){return n[u]},...Ql[this.tagName.toLowerCase()],...n}}return this._styles}get dataset(){if(this._dataset==null){const n={};for(const[e,t]of Object.entries(this._attributes))e.startsWith("data-")&&(n[e.slice(5)]=t,n[nr(e.slice(5))]=t);this._dataset=n}return this._dataset}get tagName(){return this._nodeName}setTagName(n){this._nodeName=n.toUpperCase()}get id(){return this._attributes.id||null}set id(n){n==null?delete this._attributes.id:this._attributes.id=n}get src(){return this._attributes.src}set src(n){n==null?delete this._attributes.src:this._attributes.src=n}getElementsByTagName(n){n=n.toUpperCase();const e=this.flatten();return n!=="*"?e.filter(t=>t.tagName===n):e}setInnerHTML(n){}get innerHTML(){return this._childNodes.map(n=>n.render(Xt)).join("")}set innerHTML(n){this.setInnerHTML(n)}get outerHTML(){return this.render(qt)}get className(){return this._attributes.class||""}set className(n){Array.isArray(n)?n=n.filter(e=>!!e).join(" "):typeof n=="object"&&(n=Object.entries(n).filter(([e,t])=>!!t).map(([e,t])=>e).join(" ")),this._attributes.class=n}get classList(){const n=String(this.className??"").trim().split(/\s+/g)||[];return{contains(e){return n.includes(e)},add:e=>{n.includes(e)||(n.push(e),this.className=n)},remove:e=>{const t=n.indexOf(e);t>=0&&(n.splice(t,1),this.className=n)}}}render(n=qt){return n(this._originalTagName||this.tagName,this._attributes,this._childNodes.map(e=>e.render(n)).join(""))}},Pi=class Bi extends we{get nodeName(){return super.nodeName}get nodeValue(){return super.nodeValue}get nodeType(){return Bi.DOCUMENT_TYPE_NODE}render(){return"<!DOCTYPE html>"}},iu=class zi extends Li{get nodeType(){return we.DOCUMENT_FRAGMENT_NODE}get nodeName(){return"#document-fragment"}render(e=qt){return this._childNodes.map(t=>t.render(e)||[]).join("")}get innerHTML(){return this._childNodes.map(e=>e.render(Xt)).join("")}createElement(e,t={}){return new ee(e,t)}createDocumentFragment(){return new zi}createTextNode(e){return new je(e)}},su=class extends iu{get nodeType(){return we.DOCUMENT_NODE}get nodeName(){return"#document"}get documentElement(){return this.firstChild}render(n=qt){let e=super.render(n);return this.docType&&(e=this.docType.render()+e),e}},$i=class extends su{constructor(n=!1){if(super(),this.docType=new Pi,!n){const e=new ee("html"),t=new ee("body"),u=new ee("head"),r=new ee("title");e.appendChild(u),u.appendChild(r),e.appendChild(t),this.appendChild(e)}}get body(){let n=this.querySelector("body");if(!n){let e=this.querySelector("html");e||(e=new ee("html"),this.appendChild(e)),n=new ee("body"),e.appendChild(e)}return n}get title(){return this.querySelector("title")?.textContent||""}set title(n){const e=this.querySelector("title");e&&(e.textContent=n)}get head(){let n=this.querySelector("head");if(!n){let e=this.querySelector("html");e||(e=new ee("html"),this.appendChild(e)),n=new ee("head"),e.insertBefore(e)}return n}};function Zl(){return new su}function ec(){return new $i}var _i=Zl();Kl({document:_i});var tc={},nc=tc.hasOwnProperty;function Fi(n,e){return nc.call(n,e)}var qi=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","command"];function Hi(n,e,t={},u){const r=!(typeof u=="string"&&u===""||Array.isArray(u)&&(u.length===0||u.length===1&&u[0]==="")||u==null),i=[];if(e=e.replace(/__/g,":"),e!=="noop"&&e!==""){e!=="cdata"?i.push(`<${e}`):i.push("<![CDATA[");for(let s in t)if(s&&Fi(t,s)){const o=t[s];if(s==="html")continue;s.toLowerCase()==="classname"&&(s="class"),s=s.replace(/__/g,":"),o===!0?i.push(` ${s}`):s==="style"&&typeof o=="object"?i.push(` ${s}="${Object.keys(o).filter(a=>o[a]!=null).map(a=>{let l=o[a];return l=typeof l=="number"?`${l}px`:l,`${a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${l}`}).join(";")}"`):o!==!1&&o!=null&&i.push(` ${s}="${Ln(o.toString())}"`)}if(e!=="cdata"){if(n&&!r)return i.push(" />"),i.join("");i.push(">")}if(!n&&qi.includes(e))return i.join("")}if(r){if(typeof u=="string")i.push(u);else if(u&&u.length>0){for(let s of u)if(s!=null&&s!==!1){Array.isArray(s)||(s=[s]);for(const o of s)o.startsWith("<")&&o.endsWith(">")||e==="script"||e==="style"?i.push(o):i.push(Ln(o.toString()))}}}return t.html&&i.push(t.html),e!=="noop"&&e!==""&&(e!=="cdata"?i.push(`</${e}>`):i.push("]]>")),i.join("")}function Xt(n,e,...t){const{tag:u,attrs:r,children:i}=Di(n,e,t);return Hi(!1,u,r,i)}var qt=Hi.bind(null,!1);Xt.firstLine="<!DOCTYPE html>";Xt.html=!0;var uc=/([^=\s]+)(\s*=\s*(("([^"]*)")|('([^']*)')|[^>\s]+))?/g,rc=/^<\/([^>\s]+)[^>]*>/m,ic=/^<([^>\s/]+)((\s+[^=>\s]+(\s*=\s*(("[^"]*")|('[^']*')|[^>\s]+))?)*)\s*(?:\/\s*)?>/m,sc=/\s*\/\s*>\s*$/m,oc=class{constructor(n={}){this.attrRe=uc,this.endTagRe=rc,this.startTagRe=ic,this.defaults={ignoreWhitespaceText:!1},n.scanner&&(this.scanner=n.scanner),this.options=Object.assign({},this.defaults,n)}parse(n){let e=!1,t,u,r;for(;n.length;){if(n.substring(0,4)==="<!--")t=n.indexOf("-->"),t!==-1?(this.scanner.comment(n.substring(4,t)),n=n.substring(t+3),e=!1):e=!0;else if(n.substring(0,2)==="</")u=this.endTagRe.exec(n),u?(n=RegExp.rightContext,e=!1,this.parseEndTag(RegExp.lastMatch,u[1])):e=!0;else if(n.charAt(0)==="<")if(u=this.startTagRe.exec(n),u){n=RegExp.rightContext,e=!1;const i=this.parseStartTag(RegExp.lastMatch,u[1],u);(i==="script"||i==="style")&&(t=n.search(new RegExp(`</${i}`,"i")),t!==-1?(this.scanner.characters(n.substring(0,t)),n=n.substring(t),e=!1):e=!0)}else e=!0;if(e){t=n.indexOf("<");let i=t;t===0&&(t=n.substring(1).indexOf("<"),i=i+1),t===-1?(r=n,n=""):(r=n.substring(0,i),n=n.substring(i)),(!this.options.ignoreWhitespaceText||!/^\s*$/.test(r))&&this.scanner.characters(r)}e=!0,u=null}}parseStartTag(n,e,t){const u=sc.test(n);let r=t[2];u&&(r=r.replace(/\s*\/\s*$/,""));const i=this.parseAttributes(e,r);return this.scanner.startElement(e,i,u,t[0]),e.toLocaleLowerCase()}parseEndTag(n,e){this.scanner.endElement(e)}parseAttributes(n,e){const t={};return e.replace(this.attrRe,(...u)=>{const[r,i,s,o,a,l,c,d]=u;t[i]=d??l??o??!0}),t}};function ac(n){if(typeof n!="string")throw console.error("parseHTML requires string, found",n),new Error("parseHTML requires string");const e=n.indexOf("<!")===0?new $i(!0):new iu,t=[e];return new oc({scanner:{startElement(r,i,s){if(r.toLowerCase()==="!doctype"){e.docType=new Pi;return}for(const l in i)if(Fi(i,l)){const c=i[l];typeof c=="string"&&(i[l]=Yu(c))}const a=t[t.length-1];if(a){const l=_i.createElement(r,i);a.appendChild(l),qi.includes(r.toLowerCase())||s||t.push(l)}},endElement(r){t.pop()},characters(r){r=Yu(r);const i=t[t.length-1];i?.lastChild?.nodeType===we.TEXT_NODE?i.lastChild._text+=r:i&&i.appendChild(new je(r))},comment(r){}}}).parse(n),e}ee.prototype.setInnerHTML=function(n){const e=ac(n);this._childNodes=e._childNodes,this._fixChildNodesParent()};function lc(n,e,t){return Ge.fromSchema(e).serializeFragment(n.content,{document:ec()}).render()}function cc(n,e){const t=rl(e),u=ge.fromJSON(t,n);return lc(u,t)}const dc=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,fc=H.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:n}){return["img",q(this.options.HTMLAttributes,n)]},addCommands(){return{setImage:n=>({commands:e})=>e.insertContent({type:this.name,attrs:n})}},addInputRules(){return[Oi({find:dc,type:this.type,getAttributes:n=>{const[,,e,t,u]=n;return{src:t,alt:e,title:u}}})]}}),hc=/^\s*>\s$/,pc=H.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",q(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[lt({find:hc,type:this.type})]}}),mc=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,bc=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,gc=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,yc=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,xc=ke.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",q(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ue({find:mc,type:this.type}),Ue({find:gc,type:this.type})]},addPasteRules(){return[Ke({find:bc,type:this.type}),Ke({find:yc,type:this.type})]}}),kc="listItem",ur="textStyle",rr=/^\s*([-+*])\s$/,wc=H.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",q(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(kc,this.editor.getAttributes(ur)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=lt({find:rr,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=lt({find:rr,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(ur),editor:this.editor})),[n]}}),Sc=/(^|[^`])`([^`]+)`(?!`)/,Ec=/(^|[^`])`([^`]+)`(?!`)/g,Cc=ke.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",q(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ue({find:Sc,type:this.type})]},addPasteRules(){return[Ke({find:Ec,type:this.type})]}}),Tc=/^```([a-z]+)?[\s\n]$/,Ac=/^~~~([a-z]+)?[\s\n]$/,Mc=H.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",q(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:u,empty:r}=t;if(!r||u.parent.type!==this.type)return!1;const i=u.parentOffset===u.parent.nodeSize-2,s=u.parent.textContent.endsWith(`

`);return!i||!s?!1:n.chain().command(({tr:o})=>(o.delete(u.pos-2,u.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:u}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const o=r.after();return o===void 0?!1:u.nodeAt(o)?n.commands.command(({tr:l})=>(l.setSelection(T.near(u.resolve(o))),!0)):n.commands.exitCode()}}},addInputRules(){return[Rn({find:Tc,type:this.type,getAttributes:n=>({language:n[1]})}),Rn({find:Ac,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new U({key:new le("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),u=e.clipboardData.getData("vscode-editor-data"),r=u?JSON.parse(u):void 0,i=r?.mode;if(!t||!i)return!1;const{tr:s,schema:o}=n.state,a=o.text(t.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:i},a)),s.selection.$from.parent.type!==this.type&&s.setSelection(E.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),n.dispatch(s),!0}}})]}}),Nc=H.create({name:"doc",topNode:!0,content:"block+"});function vc(n={}){return new U({view(e){return new Oc(e,n)}})}class Oc{constructor(e,t){var u;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(u=t.width)!==null&&u!==void 0?u:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let i=s=>{this[r](s)};return e.dom.addEventListener(r,i),{name:r,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,u;if(t){let o=e.nodeBefore,a=e.nodeAfter;if(o||a){let l=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0));if(l){let c=l.getBoundingClientRect(),d=o?c.bottom:c.top;o&&a&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),u={left:c.left,right:c.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!u){let o=this.editorView.coordsAtPos(this.cursorPos);u={left:o.left-this.width/2,right:o.left+this.width/2,top:o.top,bottom:o.bottom}}let r=this.editorView.dom.offsetParent;this.element||(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let i,s;if(!r||r==document.body&&getComputedStyle(r).position=="static")i=-pageXOffset,s=-pageYOffset;else{let o=r.getBoundingClientRect();i=o.left-r.scrollLeft,s=o.top-r.scrollTop}this.element.style.left=u.left-i+"px",this.element.style.top=u.top-s+"px",this.element.style.width=u.right-u.left+"px",this.element.style.height=u.bottom-u.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),u=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=u&&u.type.spec.disableDropCursor,i=typeof r=="function"?r(this.editorView,t,e):r;if(t&&!i){let s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=Dr(this.editorView.state.doc,s,this.editorView.dragging.slice);o!=null&&(s=o)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const Ic=W.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[vc(this.options)]}});class I extends T{constructor(e){super(e,e)}map(e,t){let u=e.resolve(t.map(this.head));return I.valid(u)?new I(u):T.near(u)}content(){return w.empty}eq(e){return e instanceof I&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new I(e.resolve(t.pos))}getBookmark(){return new ou(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!Rc(e)||!Dc(e))return!1;let u=t.type.spec.allowGapCursor;if(u!=null)return u;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,u=!1){e:for(;;){if(!u&&I.valid(e))return e;let r=e.pos,i=null;for(let s=e.depth;;s--){let o=e.node(s);if(t>0?e.indexAfter(s)<o.childCount:e.index(s)>0){i=o.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;r+=t;let a=e.doc.resolve(r);if(I.valid(a))return a}for(;;){let s=t>0?i.firstChild:i.lastChild;if(!s){if(i.isAtom&&!i.isText&&!S.isSelectable(i)){e=e.doc.resolve(r+i.nodeSize*t),u=!1;continue e}break}i=s,r+=t;let o=e.doc.resolve(r);if(I.valid(o))return o}return null}}}I.prototype.visible=!1;I.findFrom=I.findGapCursorFrom;T.jsonID("gapcursor",I);class ou{constructor(e){this.pos=e}map(e){return new ou(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return I.valid(t)?new I(t):T.near(t)}}function Rc(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),u=n.node(e);if(t==0){if(u.type.spec.isolating)return!0;continue}for(let r=u.child(t-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function Dc(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),u=n.node(e);if(t==u.childCount){if(u.type.spec.isolating)return!0;continue}for(let r=u.child(t);;r=r.firstChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function Lc(){return new U({props:{decorations:$c,createSelectionBetween(n,e,t){return e.pos==t.pos&&I.valid(t)?new I(t):null},handleClick:Bc,handleKeyDown:Pc,handleDOMEvents:{beforeinput:zc}}})}const Pc=oi({ArrowLeft:xt("horiz",-1),ArrowRight:xt("horiz",1),ArrowUp:xt("vert",-1),ArrowDown:xt("vert",1)});function xt(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(u,r,i){let s=u.selection,o=e>0?s.$to:s.$from,a=s.empty;if(s instanceof E){if(!i.endOfTextblock(t)||o.depth==0)return!1;a=!1,o=u.doc.resolve(e>0?o.after():o.before())}let l=I.findGapCursorFrom(o,e,a);return l?(r&&r(u.tr.setSelection(new I(l))),!0):!1}}function Bc(n,e,t){if(!n||!n.editable)return!1;let u=n.state.doc.resolve(e);if(!I.valid(u))return!1;let r=n.posAtCoords({left:t.clientX,top:t.clientY});return r&&r.inside>-1&&S.isSelectable(n.state.doc.nodeAt(r.inside))?!1:(n.dispatch(n.state.tr.setSelection(new I(u))),!0)}function zc(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof I))return!1;let{$from:t}=n.state.selection,u=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!u)return!1;let r=y.empty;for(let s=u.length-1;s>=0;s--)r=y.from(u[s].createAndFill(null,r));let i=n.state.tr.replace(t.pos,t.pos,new w(r,0,0));return i.setSelection(E.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function $c(n){if(!(n.selection instanceof I))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",P.create(n.doc,[oe.widget(n.selection.head,e,{key:"gapcursor"})])}const _c=W.create({name:"gapCursor",addProseMirrorPlugins(){return[Lc()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=C(x(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),Fc=H.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",q(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:u})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:r,storedMarks:i}=t;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=u.extensionManager,a=i||r.$to.parentOffset&&r.$from.marks();return e().insertContent({type:this.name}).command(({tr:l,dispatch:c})=>{if(c&&a&&s){const d=a.filter(h=>o.includes(h.type.name));l.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),qc=H.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,q(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>Rn({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Ht=200,z=function(){};z.prototype.append=function(e){return e.length?(e=z.from(e),!this.length&&e||e.length<Ht&&this.leafAppend(e)||this.length<Ht&&e.leafPrepend(this)||this.appendInner(e)):this};z.prototype.prepend=function(e){return e.length?z.from(e).append(this):this};z.prototype.appendInner=function(e){return new Hc(this,e)};z.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?z.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};z.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};z.prototype.forEach=function(e,t,u){t===void 0&&(t=0),u===void 0&&(u=this.length),t<=u?this.forEachInner(e,t,u,0):this.forEachInvertedInner(e,t,u,0)};z.prototype.map=function(e,t,u){t===void 0&&(t=0),u===void 0&&(u=this.length);var r=[];return this.forEach(function(i,s){return r.push(e(i,s))},t,u),r};z.from=function(e){return e instanceof z?e:e&&e.length?new Vi(e):z.empty};var Vi=function(n){function e(u){n.call(this),this.values=u}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(r,i){return r==0&&i==this.length?this:new e(this.values.slice(r,i))},e.prototype.getInner=function(r){return this.values[r]},e.prototype.forEachInner=function(r,i,s,o){for(var a=i;a<s;a++)if(r(this.values[a],o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){for(var a=i-1;a>=s;a--)if(r(this.values[a],o+a)===!1)return!1},e.prototype.leafAppend=function(r){if(this.length+r.length<=Ht)return new e(this.values.concat(r.flatten()))},e.prototype.leafPrepend=function(r){if(this.length+r.length<=Ht)return new e(r.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(z);z.empty=new Vi([]);var Hc=function(n){function e(t,u){n.call(this),this.left=t,this.right=u,this.length=t.length+u.length,this.depth=Math.max(t.depth,u.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(u){return u<this.left.length?this.left.get(u):this.right.get(u-this.left.length)},e.prototype.forEachInner=function(u,r,i,s){var o=this.left.length;if(r<o&&this.left.forEachInner(u,r,Math.min(i,o),s)===!1||i>o&&this.right.forEachInner(u,Math.max(r-o,0),Math.min(this.length,i)-o,s+o)===!1)return!1},e.prototype.forEachInvertedInner=function(u,r,i,s){var o=this.left.length;if(r>o&&this.right.forEachInvertedInner(u,r-o,Math.max(i,o)-o,s+o)===!1||i<o&&this.left.forEachInvertedInner(u,Math.min(r,o),i,s)===!1)return!1},e.prototype.sliceInner=function(u,r){if(u==0&&r==this.length)return this;var i=this.left.length;return r<=i?this.left.slice(u,r):u>=i?this.right.slice(u-i,r-i):this.left.slice(u,i).append(this.right.slice(0,r-i))},e.prototype.leafAppend=function(u){var r=this.right.leafAppend(u);if(r)return new e(this.left,r)},e.prototype.leafPrepend=function(u){var r=this.left.leafPrepend(u);if(r)return new e(r,this.right)},e.prototype.appendInner=function(u){return this.left.depth>=Math.max(this.right.depth,u.depth)+1?new e(this.left,new e(this.right,u)):new e(this,u)},e}(z);const Vc=500;class te{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let u=this.items.length;for(;;u--)if(this.items.get(u-1).selection){--u;break}let r,i;t&&(r=this.remapping(u,this.items.length),i=r.maps.length);let s=e.tr,o,a,l=[],c=[];return this.items.forEach((d,h)=>{if(!d.step){r||(r=this.remapping(u,h+1),i=r.maps.length),i--,c.push(d);return}if(r){c.push(new se(d.map));let f=d.step.map(r.slice(i)),p;f&&s.maybeStep(f).doc&&(p=s.mapping.maps[s.mapping.maps.length-1],l.push(new se(p,void 0,void 0,l.length+c.length))),i--,p&&r.appendMap(p,i)}else s.maybeStep(d.step);if(d.selection)return o=r?d.selection.map(r.slice(i)):d.selection,a=new te(this.items.slice(0,u).append(c.reverse().concat(l)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:s,selection:o}}addTransform(e,t,u,r){let i=[],s=this.eventCount,o=this.items,a=!r&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let d=e.steps[c].invert(e.docs[c]),h=new se(e.mapping.maps[c],d,t),f;(f=a&&a.merge(h))&&(h=f,c?i.pop():o=o.slice(0,o.length-1)),i.push(h),t&&(s++,t=void 0),r||(a=h)}let l=s-u.depth;return l>Wc&&(o=jc(o,l),s-=l),new te(o.append(i),s)}remapping(e,t){let u=new It;return this.items.forEach((r,i)=>{let s=r.mirrorOffset!=null&&i-r.mirrorOffset>=e?u.maps.length-r.mirrorOffset:void 0;u.appendMap(r.map,s)},e,t),u}addMaps(e){return this.eventCount==0?this:new te(this.items.append(e.map(t=>new se(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let u=[],r=Math.max(0,this.items.length-t),i=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(h=>{h.selection&&o--},r);let a=t;this.items.forEach(h=>{let f=i.getMirror(--a);if(f==null)return;s=Math.min(s,f);let p=i.maps[f];if(h.step){let m=e.steps[f].invert(e.docs[f]),b=h.selection&&h.selection.map(i.slice(a+1,f));b&&o++,u.push(new se(p,m,b))}else u.push(new se(p))},r);let l=[];for(let h=t;h<s;h++)l.push(new se(i.maps[h]));let c=this.items.slice(0,r).append(l).append(u),d=new te(c,o);return d.emptyItemCount()>Vc&&(d=d.compress(this.items.length-u.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),u=t.maps.length,r=[],i=0;return this.items.forEach((s,o)=>{if(o>=e)r.push(s),s.selection&&i++;else if(s.step){let a=s.step.map(t.slice(u)),l=a&&a.getMap();if(u--,l&&t.appendMap(l,u),a){let c=s.selection&&s.selection.map(t.slice(u));c&&i++;let d=new se(l.invert(),a,c),h,f=r.length-1;(h=r.length&&r[f].merge(d))?r[f]=h:r.push(d)}}else s.map&&u--},this.items.length,0),new te(z.from(r.reverse()),i)}}te.empty=new te(z.empty,0);function jc(n,e){let t;return n.forEach((u,r)=>{if(u.selection&&e--==0)return t=r,!1}),n.slice(t)}class se{constructor(e,t,u,r){this.map=e,this.step=t,this.selection=u,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new se(t.getMap().invert(),t,this.selection)}}}class he{constructor(e,t,u,r,i){this.done=e,this.undone=t,this.prevRanges=u,this.prevTime=r,this.prevComposition=i}}const Wc=20;function Jc(n,e,t,u){let r=t.getMeta(Be),i;if(r)return r.historyState;t.getMeta(Gc)&&(n=new he(n.done,n.undone,null,0,-1));let s=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(s&&s.getMeta(Be))return s.getMeta(Be).redo?new he(n.done.addTransform(t,void 0,u,Tt(e)),n.undone,ir(t.mapping.maps),n.prevTime,n.prevComposition):new he(n.done,n.undone.addTransform(t,void 0,u,Tt(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let o=t.getMeta("composition"),a=n.prevTime==0||!s&&n.prevComposition!=o&&(n.prevTime<(t.time||0)-u.newGroupDelay||!Uc(t,n.prevRanges)),l=s?bn(n.prevRanges,t.mapping):ir(t.mapping.maps);return new he(n.done.addTransform(t,a?e.selection.getBookmark():void 0,u,Tt(e)),te.empty,l,t.time,o??n.prevComposition)}else return(i=t.getMeta("rebased"))?new he(n.done.rebased(t,i),n.undone.rebased(t,i),bn(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new he(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),bn(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function Uc(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((u,r)=>{for(let i=0;i<e.length;i+=2)u<=e[i+1]&&r>=e[i]&&(t=!0)}),t}function ir(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((u,r,i,s)=>e.push(i,s));return e}function bn(n,e){if(!n)return null;let t=[];for(let u=0;u<n.length;u+=2){let r=e.map(n[u],1),i=e.map(n[u+1],-1);r<=i&&t.push(r,i)}return t}function Kc(n,e,t){let u=Tt(e),r=Be.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,u);if(!i)return null;let s=i.selection.resolve(i.transform.doc),o=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),r,u),a=new he(t?o:i.remaining,t?i.remaining:o,null,0,-1);return i.transform.setSelection(s).setMeta(Be,{redo:t,historyState:a})}let gn=!1,sr=null;function Tt(n){let e=n.plugins;if(sr!=e){gn=!1,sr=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){gn=!0;break}}return gn}const Be=new le("history"),Gc=new le("closeHistory");function Yc(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new U({key:Be,state:{init(){return new he(te.empty,te.empty,null,0,-1)},apply(e,t,u){return Jc(t,u,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let u=t.inputType,r=u=="historyUndo"?Wi:u=="historyRedo"?Ji:null;return r?(t.preventDefault(),r(e.state,e.dispatch)):!1}}}})}function ji(n,e){return(t,u)=>{let r=Be.getState(t);if(!r||(n?r.undone:r.done).eventCount==0)return!1;if(u){let i=Kc(r,t,n);i&&u(e?i.scrollIntoView():i)}return!0}}const Wi=ji(!1,!0),Ji=ji(!0,!0),Xc=W.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>Wi(n,e),redo:()=>({state:n,dispatch:e})=>Ji(n,e)}},addProseMirrorPlugins(){return[Yc(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Qc=H.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",q(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{selection:t}=e,{$from:u,$to:r}=t,i=n();return u.parentOffset===0?i.insertContentAt({from:Math.max(u.pos-1,0),to:r.pos},{type:this.name}):sl(t)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:s,dispatch:o})=>{var a;if(o){const{$to:l}=s.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(E.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(S.create(s.doc,l.pos)):s.setSelection(E.create(s.doc,l.pos));else{const d=(a=l.parent.type.contentMatch.defaultType)===null||a===void 0?void 0:a.create();d&&(s.insert(c,d),s.setSelection(E.create(s.doc,c+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Oi({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),Zc=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,e0=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,t0=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,n0=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,u0=ke.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",q(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ue({find:Zc,type:this.type}),Ue({find:t0,type:this.type})]},addPasteRules(){return[Ke({find:e0,type:this.type}),Ke({find:n0,type:this.type})]}}),r0=H.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",q(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),i0="listItem",or="textStyle",ar=/^(\d+)\.\s$/,s0=H.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",q(this.options.HTMLAttributes,t),0]:["ol",q(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(i0,this.editor.getAttributes(or)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=lt({find:ar,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=lt({find:ar,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(or)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),o0=H.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",q(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),a0=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,l0=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,c0=ke.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",q(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ue({find:a0,type:this.type})]},addPasteRules(){return[Ke({find:l0,type:this.type})]}}),d0=H.create({name:"text",group:"inline"}),f0=W.create({name:"starterKit",addExtensions(){var n,e,t,u,r,i,s,o,a,l,c,d,h,f,p,m,b,g;const k=[];return this.options.bold!==!1&&k.push(xc.configure((n=this.options)===null||n===void 0?void 0:n.bold)),this.options.blockquote!==!1&&k.push(pc.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&k.push(wc.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&k.push(Cc.configure((u=this.options)===null||u===void 0?void 0:u.code)),this.options.codeBlock!==!1&&k.push(Mc.configure((r=this.options)===null||r===void 0?void 0:r.codeBlock)),this.options.document!==!1&&k.push(Nc.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&k.push(Ic.configure((s=this.options)===null||s===void 0?void 0:s.dropcursor)),this.options.gapcursor!==!1&&k.push(_c.configure((o=this.options)===null||o===void 0?void 0:o.gapcursor)),this.options.hardBreak!==!1&&k.push(Fc.configure((a=this.options)===null||a===void 0?void 0:a.hardBreak)),this.options.heading!==!1&&k.push(qc.configure((l=this.options)===null||l===void 0?void 0:l.heading)),this.options.history!==!1&&k.push(Xc.configure((c=this.options)===null||c===void 0?void 0:c.history)),this.options.horizontalRule!==!1&&k.push(Qc.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&k.push(u0.configure((h=this.options)===null||h===void 0?void 0:h.italic)),this.options.listItem!==!1&&k.push(r0.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&k.push(s0.configure((p=this.options)===null||p===void 0?void 0:p.orderedList)),this.options.paragraph!==!1&&k.push(o0.configure((m=this.options)===null||m===void 0?void 0:m.paragraph)),this.options.strike!==!1&&k.push(c0.configure((b=this.options)===null||b===void 0?void 0:b.strike)),this.options.text!==!1&&k.push(d0.configure((g=this.options)===null||g===void 0?void 0:g.text)),k}}),k0=({data:n})=>[{title:Yi(n?.news.title)},{name:"description",content:n?.news.description}];function w0(){const{news:n}=Xi(),{locale:e}=Qi();function t(o){return String(o).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function u(o,a){return!a||!a.length?t(o):a.reduce((l,c)=>c.type==="bold"||c.type==="strong"?`<strong>${l}</strong>`:c.type==="italic"||c.type==="em"?`<em>${l}</em>`:c.type==="strike"||c.type==="s"?`<s>${l}</s>`:c.type==="link"?`<a href="${t(c.attrs?.href||"#")}">${l}</a>`:l,t(o))}function r(o){return o?o.type==="text"?u(o.text||"",o.marks):o.type==="hardBreak"?"<br/>":Array.isArray(o.content)?o.content.map(r).join(""):"":""}function i(o){if(!o)return"";switch(o.type){case"doc":return(o.content||[]).map(i).join("");case"paragraph":return`<p>${(o.content||[]).map(r).join("")}</p>`;case"heading":{const l=o.attrs?.level||1;return`<h${l}>${(o.content||[]).map(r).join("")}</h${l}>`}case"bulletList":return`<ul>${(o.content||[]).map(i).join("")}</ul>`;case"orderedList":return`<ol>${(o.content||[]).map(i).join("")}</ol>`;case"listItem":return`<li>${(o.content||[]).map(r).join("")}</li>`;case"horizontalRule":return"<hr/>";case"blockquote":return`<blockquote>${(o.content||[]).map(i).join("")}</blockquote>`;case"codeBlock":return`<pre><code>${t((o.content||[]).map(l=>l.text||"").join(`
`))}</code></pre>`;case"image":return`<figure><img src="${t(o.attrs?.src||"")}" alt="${t(o.attrs?.alt||"")}"/></figure>`;case"customVideo":{const l=o.attrs?.src||"";return`<div style="position:relative;padding-top:56.25%"><iframe src="${t(l)}" style="position:absolute;left:0;top:0;width:100%;height:100%;border:0;" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div>`}default:return Array.isArray(o.content)?o.content.map(i).join(""):""}}let s="";try{if(n.content){const o=JSON.parse(n.content),a=H.create({name:"customVideo",group:"block",atom:!0,addAttributes(){return{src:{default:null},textAlign:{default:null}}},parseHTML(){return[{tag:"div[data-custom-video]"}]},renderHTML({node:l}){const c=l.attrs.src||"";return["div",{style:"position:relative;padding-top:56.25%;"},["iframe",{src:c,style:"position:absolute;left:0;top:0;width:100%;height:100%;border:0;",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:"true"}]]}});try{s=cc(o,[f0,fc,a])}catch(l){console.error("generateHTML failed, falling back to simple renderer:",l);try{s=i(o)}catch(c){console.error("fallback render failed:",c),s=n.content??""}}}}catch(o){console.error("news content -> generateHTML error:",o),s=n.content??""}return Ki.useEffect(()=>{function o(a){a.preventDefault()}return document.addEventListener("contextmenu",o),()=>document.removeEventListener("contextmenu",o)},[]),ie.jsxs(ie.Fragment,{children:[ie.jsxs("section",{className:"h-dvh overflow-auto",children:[ie.jsxs("div",{className:"w-full h-full max-h-[65%] relative flex items-center justify-center bg-no-repeat bg-top bg-fixed",style:{backgroundImage:`url(${n.attachment_url})`},children:[ie.jsx("div",{className:"bg-gradient-to-t from-[#1b1b1b]/0 to-[#1b1b1b] absolute inset-0"}),ie.jsxs(au,{className:"relative",variant:"lg",style:e==="ko"?{fontFamily:'"VeKoTest-Spoqa", "SpoqaHanSansNeo", sans-serif'}:void 0,children:[ie.jsx("span",{className:"text-white font-extralight text-xs mb-5 xl:mb-7 inline-block",children:new Date(n.published_at).toLocaleDateString("vi-VN",{month:"2-digit",year:"numeric",day:"2-digit"})}),ie.jsx("h1",{className:"text-4xl xl:text-5xl font-black text-white","data-koreanable":!0,children:n.title})]})]}),ie.jsx(au,{className:"prose prose-invert prose-md py-7 sm:py-14 xl:py-20","data-koreanable":!0,variant:"lg",style:e==="ko"?{fontFamily:'"VeKoTest-Spoqa", "SpoqaHanSansNeo", sans-serif'}:void 0,dangerouslySetInnerHTML:{__html:s}})]}),ie.jsx(Gi,{})]})}export{w0 as default,k0 as meta};
